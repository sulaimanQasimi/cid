import{m as J,r as p,j as e,L as P,$ as D,a as Q}from"./app-BoRYl7ul.js";import{B}from"./button-t4nte1w6.js";import{C as x,a as u,b,c as f,d as j,e as W}from"./card-D2OxhE_x.js";import{I as _}from"./input-hl5R3Dlf.js";import{L as o}from"./label-Bq4QvQHM.js";import{T as N}from"./textarea-CNe_R6zk.js";import{S as v,a as w,b as y,c as C,d as m}from"./select-CrS_PFZv.js";import{A as Y}from"./app-layout-Dt0eGsm9.js";import{T as Z}from"./TreeViewStatSelector-tOI5Cmyq.js";import{u as ee}from"./translate-Ci5XD_xD.js";import{f as te}from"./index-CaunA62S.js";import{S as E,T as l}from"./triangle-alert-CAu2JsQY.js";import{C as V}from"./clock-C159unAr.js";import{A as re}from"./arrow-right-7pFFZZbt.js";import{F as S}from"./file-text-dEx5Ek9_.js";import{C as L}from"./calendar-BzdCMlGZ.js";import{U as se}from"./users-DUE_lbIG.js";import{B as ae}from"./book-text-BP5zwTI4.js";import{G as ie}from"./gavel-DJnenHlf.js";import{F as ne}from"./file-check-DxhOfE4w.js";import{B as oe}from"./building-2-CYM2zCZS.js";import{S as le}from"./save-Bao0lpNX.js";import"./utils-CAQgsxix.js";import"./index-BaIfncEH.js";import"./index-C7EozwEa.js";import"./index-grl2zDGr.js";import"./index-C_llV4y3.js";import"./createLucideIcon-0s2WbM7B.js";import"./index-D4JEb4Nb.js";import"./check-BQ8i0qzv.js";import"./x-BOP-VcZp.js";import"./index-BMYc3FXi.js";import"./avatar-DYzCEtzG.js";import"./tag-CA1YiYoc.js";import"./qr-code-Bmlv7TNf.js";import"./chart-column-VbbG3CS0.js";import"./map-pin-DgBMy3fb.js";import"./database-si5r_ZNU.js";function Pe({report:s,statItems:k,reportStats:z,statCategories:q}){const{t:r}=ee(),{data:d,setData:c,put:I,processing:F,errors:a}=J({report_number:s.report_number,report_date:s.report_date,security_level:s.security_level,details:s.details,action_taken:s.action_taken||"",recommendation:s.recommendation||"",report_status:s.report_status,source:s.source||""}),[T,A]=p.useState(()=>{const t={};return z.forEach(i=>{t[i.stat_category_item_id]={value:i.integer_value!==null?String(i.integer_value):i.string_value||"",notes:i.notes}}),t}),[de,ce]=p.useState(null),[h,M]=p.useState(null),R=[{title:r("incident_reports.page_title"),href:route("incident-reports.index")},{title:s.report_number,href:route("incident-reports.show",s.id)},{title:r("incident_reports.edit.breadcrumb"),href:route("incident-reports.edit",s.id)}];function U(t){t.preventDefault();const i=Object.entries(T).map(([n,{value:g,notes:X}])=>({stat_category_item_id:parseInt(n),value:g,notes:X}));I(route("incident-reports.update",s.id),{onSuccess:()=>{var n;i.length>0?Q.post(route("incident-reports.stats.batch-update",s.id),{stats:i},{headers:{"X-CSRF-TOKEN":((n=document.querySelector('meta[name="csrf-token"]'))==null?void 0:n.getAttribute("content"))||"","Content-Type":"application/json",Accept:"application/json"}}).then(()=>{window.location.href=route("incident-reports.show",s.id)}).catch(g=>{console.error("Error updating stats:",g)}):window.location.href=route("incident-reports.show",s.id)}})}const G=h?k.filter(t=>t.category.id===h):k,O=q.map(t=>({id:t.id,label:t.label,color:t.color}));function $(t,i){A(n=>({...n,[t]:{...n[t]||{notes:null},value:i}}))}function H(t,i){A(n=>({...n,[t]:{...n[t]||{value:""},notes:i||null}}))}const K=s.created_at?te(new Date(s.created_at),"MMM d, yyyy"):"N/A";return e.jsxs(Y,{breadcrumbs:R,children:[e.jsx(P,{title:r("incident_reports.edit.page_title",{number:s.report_number})}),e.jsxs("div",{className:"container px-0 py-6",children:[e.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-l from-teal-600 via-emerald-600 to-green-600 p-8 lg:p-12 text-white shadow-2xl mb-8 group",children:[e.jsx("div",{className:"absolute inset-0 bg-black/5"}),e.jsx("div",{className:"absolute top-0 left-0 w-80 h-80 bg-white/10 rounded-full -translate-y-40 -translate-x-40 blur-3xl group-hover:scale-110 transition-transform duration-700"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-64 h-64 bg-white/5 rounded-full translate-y-32 translate-x-32 blur-2xl group-hover:scale-110 transition-transform duration-700"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 w-32 h-32 bg-white/5 rounded-full -translate-x-16 -translate-y-16 blur-xl group-hover:scale-150 transition-transform duration-500"}),e.jsxs("div",{className:"relative z-10 flex flex-col lg:flex-row lg:justify-between lg:items-center gap-8",children:[e.jsxs("div",{className:"flex items-center gap-8",children:[e.jsx("div",{className:"p-6 bg-white/20 backdrop-blur-md rounded-3xl border border-white/30 shadow-2xl group-hover:scale-105 transition-transform duration-300",children:e.jsx(E,{className:"h-10 w-10 text-white"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"text-4xl lg:text-5xl font-bold text-white drop-shadow-2xl tracking-tight",children:r("incident_reports.edit.title")}),e.jsxs("p",{className:"text-white/90 flex items-center gap-3 text-xl font-medium",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-xl backdrop-blur-sm",children:e.jsx(V,{className:"h-6 w-6"})}),r("incident_reports.edit.created_on",{date:K})]})]})]}),e.jsx(D,{href:route("incident-reports.show",s.id),className:"bg-white/20 backdrop-blur-md border-white/30 text-white hover:bg-white/30 rounded-2xl shadow-2xl px-8 py-4 text-lg font-semibold transition-all duration-300 hover:scale-105 group/btn",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-1 bg-white/20 rounded-lg group-hover/btn:scale-110 transition-transform duration-300",children:e.jsx(re,{className:"h-5 w-5"})}),r("incident_reports.edit.back_button")]})})]})]}),e.jsx("form",{onSubmit:U,children:e.jsxs("div",{className:"grid gap-8",children:[e.jsxs(x,{className:"border-none shadow-xl overflow-hidden bg-gradient-to-bl from-white to-green-50/30",children:[e.jsxs(u,{className:"bg-gradient-to-l from-green-500 to-green-600 text-white border-b pb-4",children:[e.jsxs(b,{className:"flex items-center gap-3 text-lg",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(S,{className:"h-5 w-5"})}),r("incident_reports.form.info_title")]}),e.jsx(f,{className:"text-green-100",children:r("incident_reports.form.info_description")})]}),e.jsxs(j,{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid gap-6 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(o,{htmlFor:"report_number",className:"text-base font-medium flex items-center gap-2 text-green-700 text-right",dir:"rtl",children:[r("incident_reports.form.report_number"),e.jsx(S,{className:"h-4 w-4"})]}),e.jsx(_,{id:"report_number",value:d.report_number,onChange:t=>c("report_number",t.target.value),disabled:!0,className:"h-12 border-green-200 focus:border-green-500 focus:ring-green-500/20 bg-gradient-to-l from-green-50 to-white text-right"}),a.report_number&&e.jsxs("p",{className:"text-sm text-red-500 font-medium bg-red-50 p-2 rounded-lg border border-red-200 flex items-center gap-2 text-right",children:[e.jsx(l,{className:"h-4 w-4"}),a.report_number]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(o,{htmlFor:"report_date",className:"text-base font-medium flex items-center gap-2 text-green-700 text-right",dir:"rtl",children:[e.jsx("span",{className:"text-red-500",children:"*"}),r("incident_reports.form.report_date"),e.jsx(L,{className:"h-4 w-4"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(_,{id:"report_date",type:"date",value:d.report_date,onChange:t=>c("report_date",t.target.value),required:!0,className:"h-12 border-green-200 focus:border-green-500 focus:ring-green-500/20 bg-gradient-to-l from-green-50 to-white text-right"}),e.jsx(L,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-green-400 pointer-events-none"})]}),a.report_date&&e.jsxs("p",{className:"text-sm text-red-500 font-medium bg-red-50 p-2 rounded-lg border border-red-200 flex items-center gap-2 text-right",children:[e.jsx(l,{className:"h-4 w-4"}),a.report_date]})]})]}),e.jsxs("div",{className:"grid gap-6 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(o,{htmlFor:"security_level",className:"text-base font-medium flex items-center gap-2 text-green-700 text-right",dir:"rtl",children:[r("incident_reports.form.security_level"),e.jsx(E,{className:"h-4 w-4"})]}),e.jsxs(v,{value:d.security_level,onValueChange:t=>c("security_level",t),children:[e.jsx(w,{id:"security_level",className:"h-12 border-green-200 focus:border-green-500 focus:ring-green-500/20 bg-gradient-to-l from-green-50 to-white text-right",children:e.jsx(y,{placeholder:r("incident_reports.form.security_level_placeholder")})}),e.jsxs(C,{children:[e.jsx(m,{value:"normal",children:r("incident_reports.level.normal")}),e.jsx(m,{value:"restricted",children:r("incident_reports.level.restricted")}),e.jsx(m,{value:"classified",children:r("incident_reports.level.classified")})]})]}),a.security_level&&e.jsxs("p",{className:"text-sm text-red-500 font-medium bg-red-50 p-2 rounded-lg border border-red-200 flex items-center gap-2 text-right",children:[e.jsx(l,{className:"h-4 w-4"}),a.security_level]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(o,{htmlFor:"report_status",className:"text-base font-medium flex items-center gap-2 text-green-700 text-right",dir:"rtl",children:[r("incident_reports.form.status"),e.jsx(V,{className:"h-4 w-4"})]}),e.jsxs(v,{value:d.report_status,onValueChange:t=>c("report_status",t),children:[e.jsx(w,{id:"report_status",className:"h-12 border-green-200 focus:border-green-500 focus:ring-green-500/20 bg-gradient-to-l from-green-50 to-white text-right",children:e.jsx(y,{placeholder:r("incident_reports.form.status_placeholder")})}),e.jsxs(C,{children:[e.jsx(m,{value:"submitted",children:r("incident_reports.status.submitted")}),e.jsx(m,{value:"reviewed",children:r("incident_reports.status.reviewed")}),e.jsx(m,{value:"approved",children:r("incident_reports.status.approved")})]})]}),a.report_status&&e.jsxs("p",{className:"text-sm text-red-500 font-medium bg-red-50 p-2 rounded-lg border border-red-200 flex items-center gap-2 text-right",children:[e.jsx(l,{className:"h-4 w-4"}),a.report_status]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(o,{htmlFor:"source",className:"text-base font-medium flex items-center gap-2 text-green-700 text-right",dir:"rtl",children:[r("incident_reports.form.source_label"),e.jsx(se,{className:"h-4 w-4"})]}),e.jsx(_,{id:"source",value:d.source,onChange:t=>c("source",t.target.value),placeholder:r("incident_reports.form.source_placeholder"),className:"h-12 border-green-200 focus:border-green-500 focus:ring-green-500/20 bg-gradient-to-l from-green-50 to-white text-right"}),a.source&&e.jsxs("p",{className:"text-sm text-red-500 font-medium bg-red-50 p-2 rounded-lg border border-red-200 flex items-center gap-2 text-right",children:[e.jsx(l,{className:"h-4 w-4"}),a.source]})]})]})]}),e.jsxs(x,{className:"border-none shadow-xl overflow-hidden bg-gradient-to-bl from-white to-green-50/30",children:[e.jsxs(u,{className:"bg-gradient-to-l from-green-500 to-green-600 text-white border-b pb-4",children:[e.jsxs(b,{className:"flex items-center gap-3 text-lg",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(ae,{className:"h-5 w-5"})}),r("incident_reports.details.title")]}),e.jsx(f,{className:"text-green-100",children:r("incident_reports.details.edit_description")})]}),e.jsxs(j,{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(o,{htmlFor:"details",className:"text-base font-medium flex items-center gap-2 text-green-700 text-right",dir:"rtl",children:[e.jsx("span",{className:"text-red-500",children:"*"}),r("incident_reports.details.details_label"),e.jsx(S,{className:"h-4 w-4"})]}),e.jsx(N,{id:"details",rows:5,value:d.details,onChange:t=>c("details",t.target.value),placeholder:r("incident_reports.details.details_placeholder"),required:!0,className:"min-h-[120px] resize-none border-green-200 focus:border-green-500 focus:ring-green-500/20 bg-gradient-to-l from-green-50 to-white text-right"}),a.details&&e.jsxs("p",{className:"text-sm text-red-500 font-medium bg-red-50 p-2 rounded-lg border border-red-200 flex items-center gap-2 text-right",children:[e.jsx(l,{className:"h-4 w-4"}),a.details]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(o,{htmlFor:"action_taken",className:"text-base font-medium flex items-center gap-2 text-green-700 text-right",dir:"rtl",children:[r("incident_reports.details.action_taken_label"),e.jsx(ie,{className:"h-4 w-4"})]}),e.jsx(N,{id:"action_taken",rows:3,value:d.action_taken,onChange:t=>c("action_taken",t.target.value),placeholder:r("incident_reports.details.action_taken_placeholder"),className:"min-h-[80px] resize-none border-green-200 focus:border-green-500 focus:ring-green-500/20 bg-gradient-to-l from-green-50 to-white text-right"}),a.action_taken&&e.jsxs("p",{className:"text-sm text-red-500 font-medium bg-red-50 p-2 rounded-lg border border-red-200 flex items-center gap-2 text-right",children:[e.jsx(l,{className:"h-4 w-4"}),a.action_taken]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(o,{htmlFor:"recommendation",className:"text-base font-medium flex items-center gap-2 text-green-700 text-right",dir:"rtl",children:[r("incident_reports.details.recommendation_label"),e.jsx(ne,{className:"h-4 w-4"})]}),e.jsx(N,{id:"recommendation",rows:3,value:d.recommendation,onChange:t=>c("recommendation",t.target.value),placeholder:r("incident_reports.details.recommendation_placeholder"),className:"min-h-[80px] resize-none border-green-200 focus:border-green-500 focus:ring-green-500/20 bg-gradient-to-l from-green-50 to-white text-right"}),a.recommendation&&e.jsxs("p",{className:"text-sm text-red-500 font-medium bg-red-50 p-2 rounded-lg border border-red-200 flex items-center gap-2 text-right",children:[e.jsx(l,{className:"h-4 w-4"}),a.recommendation]})]})]})]}),e.jsxs(x,{className:"border-none shadow-xl overflow-hidden bg-gradient-to-bl from-white to-green-50/30",children:[e.jsxs(u,{className:"bg-gradient-to-l from-green-500 to-green-600 text-white border-b pb-4",children:[e.jsxs(b,{className:"flex items-center gap-3 text-lg",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(l,{className:"h-5 w-5"})}),r("incident_reports.stats.title")]}),e.jsx(f,{className:"text-green-100",children:r("incident_reports.stats.description")})]}),e.jsxs(j,{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(o,{htmlFor:"category-filter",className:"text-base font-medium flex items-center gap-2 text-green-700 text-right",dir:"rtl",children:[r("incident_reports.stats.filter_by_category"),e.jsx(oe,{className:"h-4 w-4"})]}),e.jsxs(v,{value:(h==null?void 0:h.toString())||"all",onValueChange:t=>M(t!=="all"?parseInt(t):null),children:[e.jsx(w,{id:"category-filter",className:"h-12 border-green-200 focus:border-green-500 focus:ring-green-500/20 bg-gradient-to-l from-green-50 to-white text-right",children:e.jsx(y,{placeholder:r("incidents.filters.all_categories")})}),e.jsxs(C,{children:[e.jsx(m,{value:"all",children:r("incidents.filters.all_categories")}),O.map(t=>e.jsx(m,{value:t.id.toString(),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-2 h-3 w-3 rounded-full",style:{backgroundColor:t.color}}),t.label]})},t.id))]})]})]}),e.jsx(Z,{items:G,statsData:T,onValueChange:$,onNotesChange:H})]})]}),e.jsx(x,{className:"border-none shadow-xl overflow-hidden bg-gradient-to-bl from-white to-green-50/30",children:e.jsxs(W,{className:"flex justify-between border-t px-6 py-5 bg-gradient-to-l from-green-50 to-green-100",children:[e.jsx(B,{variant:"outline",asChild:!0,type:"button",className:"rounded-full border-green-300 text-green-700 hover:bg-green-100 hover:border-green-400 shadow-lg",children:e.jsx(D,{href:route("incident-reports.show",s.id),children:r("common.cancel")})}),e.jsxs(B,{type:"submit",disabled:F,className:"rounded-full px-8 font-medium bg-gradient-to-l from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(le,{className:"mr-2 h-4 w-4"}),r(F?"incident_reports.actions.saving":"incident_reports.actions.save_changes")]})]})})]})})]})]})}export{Pe as default};
