import{j as e,r as n,m as O,L as V,t as r,S as q}from"./app-ClkBox42.js";import{u as M}from"./translate-BkG5lsBL.js";import{A as U}from"./app-layout-CW0bKekL.js";import{C as f,a as g,b as j,c as _,d as b}from"./card-CAe-xxiW.js";import{B as o}from"./button-D4jyYQ1Q.js";import{I as $}from"./input-CJ5-gOpr.js";import{L as v}from"./label-FP9VqPXL.js";import{B as G}from"./badge-BQRvAoLL.js";import{c as D,a as J}from"./utils-TGRqflit.js";import{S as K}from"./separator-BW5zv4CH.js";import{P as Q}from"./page-header-DKbabwVj.js";import{A as W,a as X,b as Y,c as Z,d as ee,e as se,f as te,g as ae}from"./alert-dialog-43faSfQ4.js";import{R as re}from"./refresh-cw-DsIN7Hkq.js";import{L as w}from"./loader-circle-JJEna1Fh.js";import{P as le}from"./plus-CsuFJYSH.js";import{D as ie}from"./database-DPqzEiYp.js";import{C as ce}from"./circle-check-big-DQdA9YXk.js";import{c as ne}from"./createLucideIcon-BTLmC541.js";import{T as oe}from"./trash-2-DNK5aWxK.js";import{C as de}from"./circle-alert-BJFB2H6F.js";import"./index-F8D-J14_.js";import"./tslib.es6-CmEaCU22.js";import"./index-l6ogYteW.js";import"./index-BArnEXsB.js";import"./index-DHwxsUht.js";import"./x-DmLGt7Xb.js";import"./index-PkKjS6kf.js";import"./avatar-Bbg9wF6n.js";import"./calendar-CbTlw5nf.js";import"./file-text-DzDNqiSK.js";import"./users-BvldaJhh.js";import"./tag-k7aO0S0T.js";import"./triangle-alert-Db_kNgQZ.js";import"./qr-code-Bg9gKvMq.js";import"./map-pin-B_TOKvLv.js";import"./shield-DmXAlHnm.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],pe=ne("Download",me),xe=J("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-background text-foreground",destructive:"text-destructive-foreground [&>svg]:text-current *:data-[slot=alert-description]:text-destructive-foreground/80"}},defaultVariants:{variant:"default"}});function ue({className:a,variant:l,...s}){return e.jsx("div",{"data-slot":"alert",role:"alert",className:D(xe({variant:l}),a),...s})}function he({className:a,...l}){return e.jsx("div",{"data-slot":"alert-description",className:D("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",a),...l})}function Ye({backups:a,backupPath:l}){const{t:s}=M(),[d,m]=n.useState(!1),[k,C]=n.useState(!1),[y,p]=n.useState(!1),[i,A]=n.useState(null),[x,u]=n.useState(!1),S=[{title:"Dashboard",href:"/dashboard"},{title:"System Administration",href:"#"},{title:s("backup.page_title"),href:route("backup.index")}],{data:I,setData:L,post:B,processing:N,reset:R}=O({name:""}),z=t=>{t.preventDefault(),m(!0),B(route("backup.create"),{onSuccess:()=>{r.success(s("backup.create_success")),R(),m(!1),window.location.reload()},onError:()=>{r.error(s("backup.create_error")),m(!1)}})},E=t=>{try{const h=route("backup.download",{filename:t}),c=document.createElement("a");c.href=h,c.download=t,document.body.appendChild(c),c.click(),document.body.removeChild(c),r.success(s("backup.download_started"))}catch(h){console.error("Download error:",h),r.error(s("backup.download_error"))}},F=t=>{A(t),p(!0)},T=()=>{i&&(u(!0),q.delete(route("backup.delete",{filename:i.filename}),{preserveScroll:!0,onSuccess:()=>{p(!1),u(!1),r.success(s("backup.delete_success")),window.location.reload()},onError:()=>{u(!1),r.error(s("backup.delete_error"))}}))},H=()=>{C(!0),window.location.reload()},P=t=>new Date(t).toLocaleString("fa-IR");return e.jsxs(U,{breadcrumbs:S,children:[e.jsx(V,{title:s("backup.page_title")}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[e.jsx(Q,{title:s("backup.page_title"),description:s("backup.page_description"),actions:e.jsx("div",{className:"flex space-x-2",children:e.jsxs(o,{onClick:H,disabled:k,variant:"outline",children:[e.jsx(re,{className:`h-4 w-4 mr-2 ${k?"animate-spin":""}`}),s("backup.refresh")]})})}),e.jsxs(f,{children:[e.jsxs(g,{children:[e.jsx(j,{children:s("backup.create_title")}),e.jsx(_,{children:s("backup.create_description")})]}),e.jsx(b,{children:e.jsx("form",{onSubmit:z,className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(v,{htmlFor:"name",children:s("backup.name_label")}),e.jsx($,{id:"name",type:"text",placeholder:s("backup.name_placeholder"),value:I.name,onChange:t=>L("name",t.target.value),disabled:N||d}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s("backup.name_helper")})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(o,{type:"submit",disabled:N||d,className:"w-full",children:d?e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"h-4 w-4 mr-2 animate-spin"}),s("backup.creating")]}):e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"h-4 w-4 mr-2"}),s("backup.create_button")]})})})]})})})]}),e.jsxs(f,{children:[e.jsxs(g,{children:[e.jsx(j,{children:s("backup.list_title")}),e.jsx(_,{children:s("backup.list_description")})]}),e.jsx(b,{children:e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsxs("table",{className:"w-full caption-bottom text-sm",children:[e.jsx("thead",{className:"[&_tr]:border-b",children:e.jsxs("tr",{className:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",children:[e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium",children:s("backup.filename")}),e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium",children:s("backup.size")}),e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium",children:s("backup.created_at")}),e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium",children:s("backup.actions")})]})}),e.jsx("tbody",{className:"[&_tr:last-child]:border-0",children:a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"h-12 px-4 text-center align-middle",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsx(ie,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:s("backup.no_backups")})]})})}):a.map(t=>e.jsxs("tr",{className:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",children:[e.jsx("td",{className:"p-4 align-middle",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ce,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"font-medium",children:t.filename})]})}),e.jsx("td",{className:"p-4 align-middle",children:e.jsx(G,{variant:"secondary",children:t.size})}),e.jsx("td",{className:"p-4 align-middle",children:P(t.created_at)}),e.jsx("td",{className:"p-4 align-middle",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(o,{variant:"ghost",size:"sm",onClick:()=>E(t.filename),children:[e.jsx(pe,{className:"h-4 w-4 mr-1"}),s("backup.download")]}),e.jsxs(o,{variant:"ghost",size:"sm",onClick:()=>F(t),className:"text-destructive hover:text-destructive",children:[e.jsx(oe,{className:"h-4 w-4 mr-1"}),s("backup.delete")]})]})})]},t.filename))})]})})})]}),e.jsxs(f,{children:[e.jsx(g,{children:e.jsx(j,{children:s("backup.info_title")})}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(v,{className:"text-sm font-medium",children:s("backup.storage_location")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:l})]}),e.jsxs("div",{children:[e.jsx(v,{className:"text-sm font-medium",children:s("backup.total_backups")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.length})]})]}),e.jsx(K,{}),e.jsxs(ue,{children:[e.jsx(de,{className:"h-4 w-4"}),e.jsx(he,{children:s("backup.admin_only_warning")})]})]})]})]}),e.jsx(W,{open:y,onOpenChange:p,children:e.jsxs(X,{children:[e.jsxs(Y,{children:[e.jsx(Z,{children:s("backup.delete_confirm_title")}),e.jsx(ee,{children:s("backup.delete_confirm_description",{filename:(i==null?void 0:i.filename)||""})})]}),e.jsxs(se,{children:[e.jsx(te,{disabled:x,children:s("common.cancel")}),e.jsx(ae,{onClick:T,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",disabled:x,children:x?e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"mr-2 h-4 w-4 animate-spin"}),s("backup.deleting")]}):s("backup.delete")})]})]})})]})}export{Ye as default};
