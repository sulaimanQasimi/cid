import{r as c,m as Y,j as e,L as Z,$ as f,S as D}from"./app-BNsatN7_.js";import{A as I}from"./app-layout-CqCvLOE2.js";import{B as n}from"./button-xaCB5kL1.js";import{H as ee}from"./header-DgJTZqOx.js";import{F as se}from"./FooterButtons-CAA088eG.js";import{C as L,a as B,b as F,d as A}from"./card-CkvGHacV.js";import{I as y}from"./input-DU_NGHUt.js";import{L as p}from"./label-CHXw2Fkr.js";import{T as te}from"./textarea-Byr1kxkM.js";import{u as ae}from"./translate-BdJfsgj3.js";import{u as re}from"./use-permissions-DNR9fBEd.js";import{a as j}from"./permission-guard-PqHJTh-0.js";import{B as R}from"./badge-az4GuneF.js";import{T as ie,a as le,b as P,c as T}from"./tabs-DyvknNxc.js";import{D as de,a as oe,b as ne,c as ce,d as me,e as xe}from"./dialog-CIexH6KA.js";import{A as ge}from"./arrow-left-BqitAYQI.js";import{P as pe}from"./pencil-COqpw0ep.js";import{S as he}from"./save-CRsRM6G2.js";import{F as h}from"./file-text-Dn7DyaFd.js";import{U as N}from"./users-LE8xqJ7M.js";import{X as _,S as ue}from"./x-k3G3sDaS.js";import{S as z}from"./search-GjdnsdZz.js";import{U as $}from"./user-BVeaZf2q.js";import{A as be}from"./arrow-right-CUHSgXv0.js";import{T as fe}from"./trash-9a2Jh5Vk.js";import{T as ye}from"./triangle-alert-Cjc3r4mc.js";import{D as H}from"./database-zsxreRCo.js";import{P as je}from"./plus-JtMfyaTo.js";import"./utils-Ciod7d3-.js";import"./index-DKmV0fQA.js";import"./createLucideIcon-BkGZLxLS.js";import"./index-CsTxcdAz.js";import"./index-qOvmePiK.js";import"./index-dm64hHwb.js";import"./index-CMyZrYEx.js";import"./avatar-BpSqd5FN.js";import"./tag-r21j16Ug.js";import"./qr-code-BynbUQuL.js";import"./chart-column-DUyV3-nW.js";import"./map-pin-B1jNXBgc.js";import"./building-DLkGN29y.js";function os({infoType:a,users:u}){var C,S,U;const{t}=ae();re();const[i,v]=c.useState(((C=a.accesses)==null?void 0:C.map(s=>s.user_id))||[]),[m,E]=c.useState(""),[O,x]=c.useState(!1),[d,k]=c.useState(null),[q,V]=c.useState([]),{data:g,setData:b,processing:X,errors:o}=Y({_method:"PUT",name:a.name,code:a.code||"",description:a.description||"",access_users:((S=a.accesses)==null?void 0:S.map(s=>s.user_id))||[],deleted_users:[]}),G=[{title:t("info.page_title"),href:route("info-types.index")},{title:t("info_types.page_title"),href:route("info-types.index")},{title:t("info_types.edit.page_title",{name:a.name}),href:"#"}],J=s=>{i.includes(s)||v(r=>[...r,s])},K=s=>{const r=u.find(l=>l.id===s);r&&(k({id:s,name:r.name}),x(!0))},M=()=>{if(d){const s=i.filter(r=>r!==d.id);v(s),V(r=>[...r,d.id]),x(!1),k(null)}},w=u.filter(s=>s.name.toLowerCase().includes(m.toLowerCase())||s.email.toLowerCase().includes(m.toLowerCase())),Q=s=>{s.preventDefault();const r={...g,access_users:i.map(l=>parseInt(l.toString())),deleted_users:q.map(l=>parseInt(l.toString()))};D.post(route("info-types.update",a.id),r,{onSuccess:()=>{}})},W=()=>{D.visit(route("info-types.index"))};return e.jsxs(I,{breadcrumbs:G,children:[e.jsx(Z,{title:t("info_types.edit.page_title",{name:a.name})}),e.jsxs("div",{className:"container px-0 py-6",children:[e.jsx(ee,{title:t("info_types.edit.page_title",{name:a.name}),description:t("info_types.edit.page_description"),icon:e.jsx(pe,{className:"h-6 w-6 text-white"}),model:"info_type",routeName:()=>route("info-types.index"),buttonText:t("info_types.edit.back_button"),theme:"purple",buttonSize:"lg",showBackButton:!0,backRouteName:()=>route("info-types.index"),backButtonText:t("info_types.edit.back_button"),showButton:!1,actionButtons:e.jsx(e.Fragment,{children:e.jsx(n,{asChild:!0,variant:"outline",size:"lg",className:"bg-white/20 backdrop-blur-md border-white/30 text-white hover:bg-white/30 shadow-2xl rounded-2xl px-6 py-3 text-lg font-semibold transition-all duration-300 hover:scale-105",children:e.jsxs(f,{href:route("info-types.index"),className:"flex items-center gap-3",children:[e.jsx(ge,{className:"h-5 w-5"}),t("info_types.edit.back_button")]})})})}),e.jsx(j,{model:"info_type",children:e.jsxs(L,{className:"shadow-2xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700  overflow-hidden",children:[e.jsx(B,{className:"bg-gradient-to-l from-purple-500 to-purple-600 text-white py-6",children:e.jsxs(F,{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-white/20 rounded-2xl backdrop-blur-sm shadow-lg",children:e.jsx(he,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:t("info_types.edit.form_title")}),e.jsx("div",{className:"text-purple-100 text-sm font-medium",children:t("info_types.edit.form_description")})]})]})}),e.jsxs("form",{onSubmit:Q,children:[e.jsx(A,{className:"p-8",children:e.jsxs(ie,{defaultValue:"basic",className:"w-full",children:[e.jsxs(le,{className:"grid w-full grid-cols-2 mb-8 bg-gray-100 dark:bg-gray-700 rounded-xl p-1",children:[e.jsxs(P,{value:"basic",className:"flex items-center gap-2 data-[state=active]:bg-white dark:data-[state=active]:bg-gray-800 data-[state=active]:text-purple-600 dark:data-[state=active]:text-gray-400 data-[state=active]:shadow-lg rounded-lg font-medium transition-all duration-300",children:[e.jsx(h,{className:"h-4 w-4"}),t("info_types.create.basic_info")]}),e.jsxs(P,{value:"access",className:"flex items-center gap-2 data-[state=active]:bg-white dark:data-[state=active]:bg-gray-800 data-[state=active]:text-purple-600 dark:data-[state=active]:text-gray-400 data-[state=active]:shadow-lg rounded-lg font-medium transition-all duration-300",children:[e.jsx(N,{className:"h-4 w-4"}),t("info_type.access.tab")]})]}),e.jsxs(T,{value:"basic",className:"space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs(p,{htmlFor:"name",className:"text-lg font-semibold text-gray-800 dark:text-gray-200 flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4"}),t("info_types.edit.name_label")," *"]}),e.jsxs("div",{className:"relative",children:[e.jsx(y,{id:"name",value:g.name,onChange:s=>b("name",s.target.value),required:!0,className:"h-12 text-lg border-gray-200 dark:border-gray-700 focus:border-purple-500 focus:ring-purple-500/20 bg-white dark:bg-gray-800 rounded-xl shadow-lg",placeholder:t("info_types.edit.name_placeholder")}),o.name&&e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-red-600",children:[e.jsx(_,{className:"h-4 w-4"}),e.jsx("p",{className:"text-sm font-medium",children:o.name})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(p,{htmlFor:"code",className:"text-lg font-semibold text-gray-800 dark:text-gray-200 flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4"}),t("info_types.edit.code_label")]}),e.jsxs("div",{className:"relative",children:[e.jsx(y,{id:"code",value:g.code,onChange:s=>b("code",s.target.value),className:"h-12 text-lg border-gray-200 dark:border-gray-700 focus:border-purple-500 focus:ring-purple-500/20 bg-white dark:bg-gray-800 rounded-xl shadow-lg",placeholder:t("info_types.edit.code_placeholder")}),o.code&&e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-red-600",children:[e.jsx(_,{className:"h-4 w-4"}),e.jsx("p",{className:"text-sm font-medium",children:o.code})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(p,{htmlFor:"description",className:"text-lg font-semibold text-gray-800 dark:text-gray-200 flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4"}),t("info_types.edit.description_label")]}),e.jsxs("div",{className:"relative",children:[e.jsx(te,{id:"description",value:g.description,onChange:s=>b("description",s.target.value),rows:4,className:"text-lg border-gray-200 dark:border-gray-700 focus:border-purple-500 focus:ring-purple-500/20 bg-white dark:bg-gray-800 rounded-xl shadow-lg resize-none",placeholder:t("info_types.edit.description_placeholder")}),o.description&&e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-red-600",children:[e.jsx(_,{className:"h-4 w-4"}),e.jsx("p",{className:"text-sm font-medium",children:o.description})]})]})]})]}),e.jsxs(T,{value:"access",className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200 mb-2",children:t("info_type.access.title")}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:t("info_type.access.description")})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(p,{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4"}),t("info_type.access.search_users")]}),e.jsxs("div",{className:"relative",children:[e.jsx(y,{value:m,onChange:s=>E(s.target.value),placeholder:t("info_type.access.search_users"),className:"h-12 text-lg border-gray-200 dark:border-gray-700 focus:border-purple-500 focus:ring-purple-500/20 bg-white dark:bg-gray-800 rounded-xl shadow-lg"}),e.jsx(z,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"})]})]}),m&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-800 dark:text-gray-200",children:t("info_type.access.select_users")}),e.jsxs("div",{className:"max-h-48 overflow-y-auto space-y-2 border border-gray-200 dark:border-gray-700 rounded-xl p-4 bg-white dark:bg-gray-800",children:[w.filter(s=>!i.includes(s.id)).map(s=>e.jsxs("div",{onClick:()=>J(s.id),className:"flex items-center justify-between p-3 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer transition-all duration-200 hover:scale-105 hover:shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 rounded-lg",children:e.jsx($,{className:"h-4 w-4 text-gray-600 dark:text-gray-300"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.email})]})]}),e.jsx(be,{className:"h-4 w-4 text-gray-500"})]},s.id)),w.filter(s=>!i.includes(s.id)).length===0&&e.jsx("p",{className:"text-center text-gray-600 dark:text-gray-400 py-4",children:t("info_type.access.no_users_found")})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-md font-semibold text-gray-800 dark:text-gray-200 flex items-center gap-2",children:[e.jsx(N,{className:"h-4 w-4"}),t("info_type.access.selected_users")]}),i.length>0?e.jsx("div",{className:"space-y-2",children:i.map(s=>{const r=u.find(l=>l.id===s);return r?e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border transition-all duration-200 ${s===a.created_by?"bg-gradient-to-r from-green-100 to-green-200 dark:from-green-800 dark:to-green-900 border-green-200 dark:border-green-700":"bg-gradient-to-r from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 border-purple-200 dark:border-purple-700"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${s===a.created_by?"bg-gradient-to-br from-green-200 to-green-300 dark:from-green-700 dark:to-green-800":"bg-gradient-to-br from-gray-200 to-gray-300 dark:from-gray-600 dark:to-gray-700"}`,children:e.jsx($,{className:`h-4 w-4 ${s===a.created_by?"text-green-700 dark:text-green-200":"text-gray-700 dark:text-gray-200"}`})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:r.name}),s===a.created_by&&e.jsx(R,{variant:"outline",className:"bg-green-100 text-green-800 border-green-300 px-2 py-0.5 text-xs font-medium",children:t("info_type.access.creator")})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:r.email})]})]}),s!==a.created_by&&e.jsx(n,{type:"button",variant:"outline",size:"sm",onClick:()=>K(s),className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:text-red-400 dark:hover:text-red-300 dark:hover:bg-red-900/20 border-red-200 dark:border-red-700",children:e.jsx(fe,{className:"h-3 w-3"})})]},s):null})}):e.jsxs("div",{className:"text-center py-8 text-gray-600 dark:text-gray-400",children:[e.jsx(N,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:t("info_type.access.no_users_selected")})]})]}),e.jsx("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-700",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ye,{className:"h-4 w-4 text-blue-600 dark:text-blue-400 mt-0.5"}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200 font-medium mb-1",children:t("info_type.access.creator_note")}),e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-300",children:t("info_type.access.permissions_note")})]})]})})]})]})}),e.jsx("div",{className:"px-8 py-6 bg-gray-50 dark:bg-gray-800",children:e.jsx(se,{onCancel:W,onSubmit:()=>{},processing:X,cancelText:t("info_types.edit.cancel_button"),submitText:t("info_types.edit.save_button"),savingText:t("info_types.edit.saving_button")})})]})]})}),e.jsxs(L,{className:"shadow-2xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-3xl overflow-hidden mt-8",children:[e.jsx(B,{className:"bg-gradient-to-l from-purple-500 to-purple-600 text-white py-6",children:e.jsxs(F,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-white/20 rounded-2xl backdrop-blur-sm shadow-lg",children:e.jsx(H,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:t("info_types.edit.stats_title")}),e.jsx("div",{className:"text-purple-100 text-sm font-medium",children:t("info_types.edit.stats_description")})]})]}),e.jsx(j,{model:"info_type",children:e.jsx(n,{asChild:!0,size:"lg",className:"bg-white/20 backdrop-blur-md border-white/30 text-white hover:bg-white/30 shadow-2xl rounded-2xl px-6 py-3 text-lg font-semibold transition-all duration-300 hover:scale-105",children:e.jsxs(f,{href:route("info-types.stats",a.id),className:"flex items-center gap-3",children:[e.jsx(ue,{className:"h-5 w-5"}),t("info_types.edit.manage_stats_button")]})})})]})}),e.jsx(A,{className:"p-8",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200",children:t("info_types.edit.current_stats")}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:t("info_types.edit.current_stats_description")})]}),e.jsxs(R,{variant:"secondary",className:"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 px-3 py-1",children:[((U=a.infoStats)==null?void 0:U.length)||0," ",t("info_types.edit.stats_count")]})]}),a.infoStats&&a.infoStats.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.infoStats.map(s=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-xl border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:s.stat_category_item.category.color}}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:s.stat_category_item.category.label})]}),e.jsx("h4",{className:"font-semibold text-gray-900 dark:text-gray-100 mb-1",children:s.stat_category_item.label}),e.jsx("p",{className:"text-lg font-bold text-green-600 mb-2",children:s.integer_value!==null?s.integer_value:s.string_value}),s.notes&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 italic",children:s.notes})]},s.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"p-4 bg-gray-100 dark:bg-gray-700 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(H,{className:"h-8 w-8 text-gray-400"})}),e.jsx("p",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 mb-2",children:t("info_types.edit.no_stats")}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:t("info_types.edit.no_stats_description")}),e.jsx(j,{model:"info_type",children:e.jsx(n,{asChild:!0,className:"bg-gradient-to-l from-purple-500 to-purple-600 text-white hover:from-purple-600 hover:to-purple-700 shadow-2xl rounded-2xl px-6 py-3 text-lg font-semibold transition-all duration-300 hover:scale-105",children:e.jsxs(f,{href:route("info-types.stats",a.id),className:"flex items-center gap-3",children:[e.jsx(je,{className:"h-5 w-5"}),t("info_types.edit.add_stats_button")]})})})]})]})})]})]}),e.jsx(de,{open:O,onOpenChange:x,children:e.jsxs(oe,{className:"max-w-md",children:[e.jsxs(ne,{children:[e.jsx(ce,{className:"text-xl",children:t("info_type.access.remove_user_confirm_title")}),e.jsx(me,{className:"mt-2",children:t("info_type.access.remove_user_confirm_message",{name:(d==null?void 0:d.name)||""})})]}),e.jsxs(xe,{className:"mt-6",children:[e.jsx(n,{variant:"outline",onClick:()=>x(!1),className:"shadow-sm",children:t("common.cancel")}),e.jsx(n,{onClick:M,className:"bg-red-600 hover:bg-red-700 text-white shadow-sm",children:t("info_type.access.remove_user_confirm_button")})]})]})})]})}export{os as default};
