import{m as O,r as N,j as e,L as P,$ as R}from"./app-BTwao5lV.js";import{B as h}from"./button-BOH7HFqw.js";import{C as u,a as x,b as _,c as j,d as g,e as $}from"./card-DRJdh0w-.js";import{I as f}from"./input-CK0Di3zu.js";import{L as a}from"./label-RIb0QiE0.js";import{T as v}from"./textarea-B9lY6Erv.js";import{S as k,a as F,b as w,c as T,d as m}from"./select-Bk40dX-I.js";import{P as z}from"./page-header-CiWVcSGv.js";import{A as G}from"./app-layout-D-kOwvDO.js";import{I as o}from"./input-error-BbcMxzvK.js";import{T as J}from"./TreeViewStatSelector-DU6ap54H.js";import{u as K}from"./translate-C098nKtj.js";import{A as M}from"./arrow-left-38NTZCSS.js";import"./index-D0iH_ebk.js";import"./index-DsicJb1w.js";import"./index-BV7cHKwF.js";import"./index-ty2sf-gJ.js";import"./createLucideIcon-AitLqfJD.js";import"./index-DHLSgzAE.js";import"./check-BUeXEhKd.js";import"./x-CIkUpJ08.js";import"./index-BnzPjD0j.js";import"./avatar-kZFuc_qc.js";import"./app-logo-BY3jIwIe.js";import"./app-logo-icon-Bb1wDBZt.js";import"./triangle-alert-Bu-1Ju2I.js";import"./file-text-CrLbhVnL.js";import"./users-D9US5lqV.js";import"./tag-DP4Rw8do.js";import"./qr-code-BXxt7XJU.js";const Q=[{title:"Dashboard",href:"/dashboard"},{title:"Incident Reports",href:route("incident-reports.index")},{title:"Create",href:route("incident-reports.create")}];function ke({securityLevels:U,statItems:b,statCategories:D}){const{t}=K(),{data:n,setData:s,post:I,processing:C,errors:l}=O({report_date:new Date().toISOString().split("T")[0],security_level:"normal",details:"",report_status:"submitted",report_number:"",action_taken:"",recommendation:"",source:""}),[y,S]=N.useState({}),[d,L]=N.useState(null);function V(r){r.preventDefault();const c=Object.entries(y).filter(([i,{value:p}])=>p.trim()!=="").map(([i,{value:p,notes:H}])=>({stat_category_item_id:parseInt(i),value:p,notes:H||void 0}));c.length>0&&s("stats",c),I(route("incident-reports.store"))}const A=D.map(r=>({id:r.id,label:r.label,color:r.color})),E=d?b.filter(r=>r.category.id===d):b;function q(r,c){S(i=>({...i,[r]:{...i[r]||{notes:null},value:c}}))}function B(r,c){S(i=>({...i,[r]:{...i[r]||{value:""},notes:c||null}}))}return e.jsxs(G,{breadcrumbs:Q,children:[e.jsx(P,{title:t("incident_reports.create.page_title")}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[e.jsx(z,{title:t("incident_reports.create.page_title"),description:t("incident_reports.create.page_description"),actions:e.jsxs(h,{variant:"outline",onClick:()=>window.history.back(),children:[e.jsx(M,{className:"mr-2 h-4 w-4"}),t("common.back")]})}),e.jsx("form",{onSubmit:V,children:e.jsxs("div",{className:"grid gap-4",children:[e.jsxs(u,{children:[e.jsxs(x,{children:[e.jsx(_,{children:t("incident_reports.form.info_title")}),e.jsx(j,{children:t("incident_reports.form.info_description")})]}),e.jsxs(g,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-3",children:[e.jsx(a,{htmlFor:"report_number",children:t("incident_reports.form.report_number_label")}),e.jsx(f,{id:"report_number",value:n.report_number,onChange:r=>s("report_number",r.target.value),placeholder:t("incident_reports.form.report_number_placeholder")}),e.jsx(o,{message:l.report_number})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx(a,{htmlFor:"report_date",children:t("incident_reports.form.report_date")}),e.jsx(f,{id:"report_date",type:"date",value:n.report_date,onChange:r=>s("report_date",r.target.value),required:!0}),e.jsx(o,{message:l.report_date})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx(a,{htmlFor:"security_level",children:t("incident_reports.form.security_level")}),e.jsxs(k,{value:n.security_level,onValueChange:r=>s("security_level",r),children:[e.jsx(F,{id:"security_level",children:e.jsx(w,{placeholder:t("incident_reports.form.security_level_placeholder")})}),e.jsxs(T,{children:[e.jsx(m,{value:"normal",children:t("incident_reports.level.normal")}),e.jsx(m,{value:"restricted",children:t("incident_reports.level.restricted")}),e.jsx(m,{value:"classified",children:t("incident_reports.level.classified")})]})]}),e.jsx(o,{message:l.security_level})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx(a,{htmlFor:"source",children:t("incident_reports.form.source_label")}),e.jsx(f,{id:"source",value:n.source,onChange:r=>s("source",r.target.value),placeholder:t("incident_reports.form.source_placeholder")}),e.jsx(o,{message:l.source})]})]})]}),e.jsxs(u,{children:[e.jsxs(x,{children:[e.jsx(_,{children:t("incident_reports.details.title")}),e.jsx(j,{children:t("incident_reports.details.description")})]}),e.jsxs(g,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-3",children:[e.jsx(a,{htmlFor:"details",children:t("incident_reports.details.details_label")}),e.jsx(v,{id:"details",rows:5,value:n.details,onChange:r=>s("details",r.target.value),placeholder:t("incident_reports.details.details_placeholder"),required:!0}),e.jsx(o,{message:l.details})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx(a,{htmlFor:"action_taken",children:t("incident_reports.details.action_taken_label")}),e.jsx(v,{id:"action_taken",rows:3,value:n.action_taken,onChange:r=>s("action_taken",r.target.value),placeholder:t("incident_reports.details.action_taken_placeholder")}),e.jsx(o,{message:l.action_taken})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx(a,{htmlFor:"recommendation",children:t("incident_reports.details.recommendation_label")}),e.jsx(v,{id:"recommendation",rows:3,value:n.recommendation,onChange:r=>s("recommendation",r.target.value),placeholder:t("incident_reports.details.recommendation_placeholder")}),e.jsx(o,{message:l.recommendation})]}),e.jsx("input",{type:"hidden",name:"report_status",value:"submitted"})]})]}),e.jsxs(u,{children:[e.jsxs(x,{children:[e.jsx(_,{children:t("incident_reports.stats.title")}),e.jsx(j,{children:t("incident_reports.stats.description")})]}),e.jsxs(g,{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(a,{htmlFor:"category-filter",children:t("incident_reports.stats.filter_by_category")}),e.jsxs(k,{value:(d==null?void 0:d.toString())||"all",onValueChange:r=>L(r!=="all"?parseInt(r):null),children:[e.jsx(F,{id:"category-filter",children:e.jsx(w,{placeholder:t("incidents.filters.all_categories")})}),e.jsxs(T,{children:[e.jsx(m,{value:"all",children:t("incidents.filters.all_categories")}),A.map(r=>e.jsx(m,{value:r.id.toString(),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-2 h-3 w-3 rounded-full",style:{backgroundColor:r.color}}),r.label]})},r.id))]})]})]}),e.jsx(J,{items:E,statsData:y,onValueChange:q,onNotesChange:B})]})]}),e.jsxs($,{className:"bg-background flex p-6 justify-end space-x-2",children:[e.jsx(h,{variant:"outline",asChild:!0,children:e.jsx(R,{href:route("incident-reports.index"),children:t("common.cancel")})}),e.jsx(h,{type:"submit",disabled:C,children:t(C?"incident_reports.actions.submitting":"incident_reports.actions.create")})]})]})})]})]})}export{ke as default};
