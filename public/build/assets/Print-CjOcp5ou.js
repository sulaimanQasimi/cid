import{r as p,j as e,L as h}from"./app-BoRYl7ul.js";import{B as n}from"./button-t4nte1w6.js";import{u as k}from"./translate-Ci5XD_xD.js";import{a as b,b as C}from"./date-BaJKjiu2.js";import{I as F,Q as T}from"./browser-ZcE4nPX7.js";import{L as D}from"./lock-CGlhDWAY.js";import{A as j}from"./arrow-left-unmuUYR6.js";import{F as l}from"./file-text-dEx5Ek9_.js";import{C as c}from"./calendar-BzdCMlGZ.js";import{C as g}from"./clock-C159unAr.js";import{S,T as f}from"./triangle-alert-CAu2JsQY.js";import{U as N}from"./user-Dlq7lnhd.js";import{U}from"./users-DUE_lbIG.js";import{B}from"./book-text-BP5zwTI4.js";import{G as L}from"./gavel-DJnenHlf.js";import{F as Q}from"./file-check-DxhOfE4w.js";import{T as y}from"./tag-CA1YiYoc.js";import{M as R}from"./map-pin-DgBMy3fb.js";import{B as A}from"./building-2-CYM2zCZS.js";import"./utils-CAQgsxix.js";import"./createLucideIcon-0s2WbM7B.js";function ie({report:t,incidents:i,barcodeData:z,isAdmin:_}){var o,x;const{t:s}=k(),[d,u]=p.useState("");p.useEffect(()=>{(async()=>{try{const a=t.report_number||t.id.toString(),v=await T.toDataURL(a,{width:120,margin:1,color:{dark:"#000000",light:"#FFFFFF"}});u(v)}catch(a){console.error("Error generating QR code:",a)}})()},[t.report_number,t.id]);const w=()=>{window.print()},m=()=>{window.history.back()};return _?e.jsxs("div",{className:"print:max-w-none print:p-0 print:m-0",style:{fontFamily:"Arial, sans-serif"},children:[e.jsx(h,{title:s("incident_reports.print.page_title",{number:t.report_number})}),e.jsx("style",{dangerouslySetInnerHTML:{__html:`
          @media print {
            @page {
              size: A4;
              margin: 1cm;
            }
            body {
              font-size: 12px;
              line-height: 1.4;
            }
            .print\\:text-xs {
              font-size: 10px !important;
            }
            .print\\:border-gray-800 {
              border-color: #1f2937 !important;
            }
            .print\\:border-gray-600 {
              border-color: #4b5563 !important;
            }
            .print\\:hidden {
              display: none !important;
            }
          }
        `}}),e.jsx("div",{className:"mb-6 print:hidden",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(n,{onClick:m,variant:"outline",size:"lg",className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4"}),s("incident_reports.print.back_button")]}),e.jsxs(n,{onClick:w,size:"lg",className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700",children:[e.jsx(l,{className:"h-4 w-4"}),s("incident_reports.print.print_button")]})]})}),e.jsxs("div",{className:"print:page-break-inside-avoid relative",children:[e.jsx("h1",{className:"text-2xl font-bold text-black text-center mb-2",children:s("incident_reports.print.title")}),e.jsx("h2",{className:"text-xl font-semibold text-black text-center pt-2 mb-4",children:s("incident_reports.print.subtitle")}),d&&e.jsx("div",{className:"absolute top-0 right-0 print:top-0 print:right-0",children:e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:d,alt:"QR Code",className:"w-24 h-24 print:w-20 print:h-20 border border-gray-300 print:border-gray-600"}),e.jsx("p",{className:"text-xs text-gray-600 print:text-gray-800 mt-1",children:t.report_number})]})})]}),e.jsxs("table",{className:"w-full mt-4 print:text-xs",style:{borderCollapse:"collapse"},children:[e.jsxs("tr",{className:"text-sm border-b border-gray-900 print:border-gray-800",children:[e.jsxs("th",{className:"text-left pr-2 font-semibold flex items-center gap-1",children:[e.jsx(l,{className:"h-3 w-3"}),s("incident_reports.show.report_number"),":"]}),e.jsx("td",{className:"pr-4",children:t.report_number}),e.jsxs("th",{className:"text-left pr-2 font-semibold flex items-center gap-1",children:[e.jsx(c,{className:"h-3 w-3"}),s("incident_reports.show.report_date_label"),":"]}),e.jsx("td",{className:"pr-4",children:b(t.report_date)})]}),e.jsxs("tr",{className:"text-sm border-b border-gray-900 print:border-gray-800",children:[e.jsxs("th",{className:"text-left pr-2 font-semibold flex items-center gap-1",children:[e.jsx(g,{className:"h-3 w-3"}),s("incident_reports.show.status"),":"]}),e.jsx("td",{className:"pr-4",children:s(`incident_reports.status.${t.report_status}`)}),e.jsxs("th",{className:"text-left pr-2 font-semibold flex items-center gap-1",children:[e.jsx(S,{className:"h-3 w-3"}),s("incident_reports.show.security_level"),":"]}),e.jsx("td",{className:"pr-4",children:s(`incident_reports.level.${t.security_level}`)})]}),e.jsxs("tr",{className:"text-sm border-b border-gray-900 print:border-gray-800",children:[e.jsxs("th",{className:"text-left pr-2 font-semibold flex items-center gap-1",children:[e.jsx(N,{className:"h-3 w-3"}),s("incident_reports.show.submitted_by"),":"]}),e.jsx("td",{className:"pr-4",children:((o=t.submitter)==null?void 0:o.name)||s("incidents.unknown")}),e.jsxs("th",{className:"text-left pr-2 font-semibold flex items-center gap-1",children:[e.jsx(N,{className:"h-3 w-3"}),s("incident_reports.show.approved_by"),":"]}),e.jsx("td",{className:"pr-4",children:((x=t.approver)==null?void 0:x.name)||s("incident_reports.print.pending_approval")})]}),t.source&&e.jsxs("tr",{className:"text-sm pt-2 py-2",children:[e.jsxs("th",{className:"text-left pr-2 font-semibold flex items-center gap-1",children:[e.jsx(U,{className:"h-3 w-3"}),s("incident_reports.show.source_label"),":"]}),e.jsx("td",{colSpan:3,children:t.source})]})]}),e.jsx("hr",{className:"my-4 border-gray-900 print:border-gray-800"}),e.jsxs("div",{className:"mt-4 print:page-break-inside-avoid",children:[e.jsxs("h3",{className:"text-lg font-semibold text-black mb-2 flex items-center gap-2",children:[e.jsx(B,{className:"h-4 w-4"}),s("incident_reports.details.title")]}),e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 print:bg-white print:border print:border-gray-300 rounded",children:[e.jsxs("h4",{className:"font-semibold text-black mb-2 flex items-center gap-2",children:[e.jsx(l,{className:"h-4 w-4"}),s("incident_reports.details.details_label"),":"]}),e.jsx("p",{className:"text-sm text-justify leading-relaxed",children:t.details})]}),t.action_taken&&e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 print:bg-white print:border print:border-gray-300 rounded",children:[e.jsxs("h4",{className:"font-semibold text-black mb-2 flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),s("incident_reports.details.action_taken_label"),":"]}),e.jsx("p",{className:"text-sm text-justify leading-relaxed",children:t.action_taken})]}),t.recommendation&&e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 print:bg-white print:border print:border-gray-300 rounded",children:[e.jsxs("h4",{className:"font-semibold text-black mb-2 flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4"}),s("incident_reports.details.recommendation_label"),":"]}),e.jsx("p",{className:"text-sm text-justify leading-relaxed",children:t.recommendation})]})]}),e.jsx("hr",{className:"my-4 border-gray-300 print:border-gray-600"}),e.jsxs("div",{className:"mt-4 print:page-break-inside-avoid",children:[e.jsxs("h3",{className:"text-lg font-semibold text-black mb-2 flex items-center gap-2",children:[e.jsx(f,{className:"h-4 w-4"}),s("incidents.page_title")," (",i.length,")"]}),i.length===0?e.jsxs("div",{className:"text-center py-4",children:[e.jsx(f,{className:"h-12 w-12 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600 text-sm",children:s("incidents.no_incidents")})]}):i.map((r,a)=>e.jsxs("div",{className:"mt-4 print:page-break-inside-avoid",children:[e.jsx("div",{className:"pt-4 mb-2",children:e.jsxs("h4",{className:"text-lg font-semibold text-black mb-2",children:[a+1,". ",r.title]})}),e.jsxs("table",{className:"w-full print:text-xs",style:{borderCollapse:"collapse"},children:[e.jsxs("tr",{className:"border-b border-gray-300 print:border-gray-600",children:[e.jsxs("th",{className:"text-left pr-2 font-semibold py-1 flex items-center gap-1",children:[e.jsx(c,{className:"h-3 w-3"}),s("incidents.incident_date"),":"]}),e.jsx("td",{className:"pr-4 py-1",children:b(r.incident_date)}),e.jsxs("th",{className:"text-left pr-2 font-semibold py-1 flex items-center gap-1",children:[e.jsx(y,{className:"h-3 w-3"}),s("incidents.severity"),":"]}),e.jsx("td",{className:"pr-4 py-1",children:r.severity}),e.jsxs("th",{className:"text-left pr-2 font-semibold py-1 flex items-center gap-1",children:[e.jsx(g,{className:"h-3 w-3"}),s("incidents.status"),":"]}),e.jsx("td",{className:"pr-4 py-1",children:s(`incidents.status.${r.status}`)})]}),e.jsxs("tr",{className:"border-b border-gray-300 print:border-gray-600",children:[r.location&&e.jsxs(e.Fragment,{children:[e.jsxs("th",{className:"text-left pr-2 font-semibold py-1 flex items-center gap-1",children:[e.jsx(R,{className:"h-3 w-3"}),s("incidents.location"),":"]}),e.jsx("td",{className:"pr-4 py-1",children:r.location})]}),r.district&&e.jsxs(e.Fragment,{children:[e.jsxs("th",{className:"text-left pr-2 font-semibold py-1 flex items-center gap-1",children:[e.jsx(A,{className:"h-3 w-3"}),s("incidents.district"),":"]}),e.jsx("td",{className:"pr-4 py-1",children:r.district.name})]}),r.category&&e.jsxs(e.Fragment,{children:[e.jsxs("th",{className:"text-left pr-2 font-semibold py-1 flex items-center gap-1",children:[e.jsx(y,{className:"h-3 w-3"}),s("incidents.category"),":"]}),e.jsx("td",{className:"pr-4 py-1",children:r.category.name})]})]})]}),e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 print:bg-white print:border print:border-gray-300 rounded",children:[e.jsxs("h4",{className:"font-semibold text-black mb-2 flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),s("incidents.description"),":"]}),e.jsx("p",{className:"text-sm text-justify leading-relaxed",children:r.description})]}),a<i.length-1&&e.jsx("hr",{className:"my-4 border-gray-300 print:border-gray-600"})]},r.id))]}),e.jsx("div",{className:"mt-8 pt-4 border-t border-gray-300 print:border-gray-600 print:mt-12",children:e.jsx("div",{className:"text-center text-sm text-gray-600 print:text-gray-800",children:e.jsxs("p",{className:"flex items-center justify-center gap-2",children:[e.jsx(c,{className:"h-4 w-4"}),s("incident_reports.print.generated_on"),": ",C(new Date().toISOString())]})})})]}):e.jsxs("div",{className:"print:max-w-none print:p-0 print:m-0",style:{fontFamily:"Arial, sans-serif"},children:[e.jsx(h,{title:s("incident_reports.print.access_denied")}),e.jsx("div",{className:"min-h-screen bg-white p-8 flex items-center justify-center",dir:"rtl",children:e.jsxs("div",{className:"border border-red-200 shadow-sm max-w-md",children:[e.jsx("div",{className:"bg-red-50 border-b border-red-200 p-4",children:e.jsxs("h1",{className:"flex items-center gap-3 text-lg text-red-900",children:[e.jsx(D,{className:"h-5 w-5"}),s("incident_reports.print.access_denied")]})}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-700 mb-4",children:s("incident_reports.print.admin_only")}),e.jsxs(n,{onClick:m,variant:"outline",className:"w-full",children:[e.jsx(j,{className:"h-4 w-4 mr-2"}),s("common.back")]})]})]})})]})}export{ie as default};
