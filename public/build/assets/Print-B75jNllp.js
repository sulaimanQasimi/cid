import{r as x,j as e,L as R}from"./app-Dpa8Mw3a.js";import{B as g}from"./button-BovskyHP.js";import{u as U}from"./translate-HZomKBkO.js";import{a as h}from"./date-BaJKjiu2.js";import{I as F,Q as O}from"./browser-tT-RUjng.js";import{A as Y}from"./arrow-left-D2iBQ-z9.js";import{S as H,X as q}from"./x-DZIFbQwF.js";import{P as X}from"./printer-Co3YfwOy.js";import{T as f}from"./tag-DEZBMSTU.js";import{C as m}from"./calendar-CkZifxsd.js";import{U as $}from"./user-CDrvO7Mw.js";import{B as y}from"./building-2-BCdq-5lp.js";import{C as G}from"./circle-check-big-Cc5g9fHK.js";import{C as J}from"./clock-CdNjlZu5.js";import{F as P}from"./file-check-CCrIY3Fc.js";import{F as K}from"./file-text-YbYT_577.js";import{P as D}from"./palette-BFlfIJuW.js";import{T as V}from"./type-DCFdhXNh.js";import{P as W}from"./panels-top-left-C1kTfvZz.js";import{T}from"./tablet-smartphone-C3HKnmt2.js";import{f as Z}from"./index-CaunA62S.js";import"./utils-DueTybL-.js";import"./createLucideIcon-cRJugfto.js";function we({infoType:l,infos:b,statCategories:ee}){var _;const{t:r}=U(),[j,M]=x.useState(""),[z,d]=x.useState(!1),[n,I]=x.useState({headerColor:"#1f2937",textColor:"#374151",accentColor:"#3b82f6",fontFamily:"Amiri, Traditional Arabic, Arial, sans-serif",fontSize:12,showLogo:!0,showFooter:!0,showDate:!0,pageSize:"a4",orientation:"portrait",margins:"normal",dateFormat:"gregorian",labels:{reportTitle:"د معلوماتو ډول راپور",name:"نوم:",code:"کوډ:",category:"کټه ګوري:",creator:"جوړونکی:",status:"حالت:",confirmedBy:"تاییدونکی:",confirmedAt:"د تایید نېټه:",department:"څانګه:",province:"ولایت:",district:"ولسوالی:",infoType:"د معلوماتو ډول:",description:"تفصیل:",createdAt:"د جوړیدو نېټه:",updatedAt:"د تازه کیدو نېټه:",generatedOn:"د تولید نېټه:"}}),[c,p]=x.useState("colors");x.useEffect(()=>{(async()=>{try{const a=l.name||l.id.toString(),i=await O.toDataURL(a,{width:120,margin:1,color:{dark:"#000000",light:"#FFFFFF"}});M(i)}catch(a){console.error("Error generating QR code:",a)}})();let s=document.getElementById("dynamic-print-styles");return s||(s=document.createElement("style"),s.id="dynamic-print-styles",document.head.appendChild(s)),N(s,n),setTimeout(()=>{window.print()},1e3),()=>{const a=document.getElementById("dynamic-print-styles");a&&a.remove()}},[]);const A=t=>{const s=Math.floor((t.getFullYear()-622)*.970224),a=Math.floor((t.getMonth()+1)*.970224),i=Math.floor(t.getDate()*.970224);return`${s}/${a.toString().padStart(2,"0")}/${i.toString().padStart(2,"0")}`},E=t=>{const s=t.getFullYear()-621,a=t.getMonth()+1,i=t.getDate();return`${s}/${a.toString().padStart(2,"0")}/${i.toString().padStart(2,"0")}`},u=t=>{if(!t)return"";try{const s=new Date(t);switch(n.dateFormat){case"hijri":return A(s);case"persian":return E(s);case"gregorian":default:return Z(s,"yyyy/MM/dd")}}catch{return""}},o=(t,s)=>{I(i=>({...i,[t]:s}));const a=document.getElementById("dynamic-print-styles");if(a){const i={...n,[t]:s};N(a,i)}},N=(t,s)=>{const a=`
      @page {
        size: ${s.pageSize} ${s.orientation};
        margin: ${B(s.margins)};
      }
      @media print {
        body {
          font-family: ${s.fontFamily};
          print-color-adjust: exact;
          -webkit-print-color-adjust: exact;
          background: none;
          font-size: ${s.fontSize}px;
          color: ${s.textColor};
        }

        /* Custom background colors for printing */
        .print-template .header-bg {
          -webkit-print-color-adjust: exact !important;
          print-color-adjust: exact !important;
          background-color: ${s.headerColor} !important;
          color: white !important;
        }

        /* CSS for primary and accent colors to work in print */
        .text-primary, h1, h2, h3, .font-bold.text-primary {
          color: ${s.accentColor} !important;
        }

        .border-primary, .border-primary\\/20 {
          border-color: ${s.accentColor} !important;
        }

        .bg-primary {
          background-color: ${s.accentColor} !important;
        }
      }
    `;t.innerHTML=a},B=(t=n.margins)=>{switch(t){case"narrow":return"0.5cm";case"wide":return"2cm";default:return"1cm"}},L=()=>{window.print()},Q=()=>{window.history.back()};return e.jsxs("div",{className:"print:max-w-none print:p-0 print:m-0",style:{fontFamily:"Arial, sans-serif"},children:[e.jsx(R,{title:r("info_types.print.title",{name:l.name||"Info Type"})}),e.jsx("style",{dangerouslySetInnerHTML:{__html:`
          @media print {
            @page {
              size: A4;
              margin: 1cm;
            }
            body {
              font-size: 12px;
              line-height: 1.4;
            }
            .print\\:text-xs {
              font-size: 10px !important;
            }
            .print\\:border-gray-800 {
              border-color: #1f2937 !important;
            }
            .print\\:border-gray-600 {
              border-color: #4b5563 !important;
            }
            .print\\:hidden {
              display: none !important;
            }
          }
        `}}),e.jsx("div",{className:"mb-6 print:hidden",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(g,{onClick:Q,variant:"outline",size:"lg",className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4"}),r("info_types.print.back_button")]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(g,{onClick:()=>d(!0),variant:"outline",size:"lg",className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4"}),r("info_types.print.settings_button")]}),e.jsxs(g,{onClick:L,size:"lg",className:"flex items-center gap-2 bg-purple-600 hover:bg-purple-700",children:[e.jsx(X,{className:"h-4 w-4"}),r("info_types.print.print_button")]})]})]})}),e.jsxs("div",{className:"print:page-break-inside-avoid relative",children:[e.jsx("h1",{className:"text-2xl font-bold text-black text-center mb-2",children:r("info_types.print.header_title")}),e.jsx("h2",{className:"text-xl font-semibold text-black text-center pt-2 mb-4",children:l.name||"Info Type"}),j&&e.jsx("div",{className:"absolute top-0 right-0 print:top-0 print:right-0",children:e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:j,alt:"QR Code",className:"w-24 h-24 print:w-20 print:h-20 border border-gray-300 print:border-gray-600"}),e.jsx("p",{className:"text-xs text-gray-600 print:text-gray-800 mt-1",children:l.name||l.id})]})})]}),e.jsxs("table",{className:"w-full mt-4 print:text-xs",style:{borderCollapse:"collapse"},children:[e.jsxs("tr",{className:"text-sm border-b border-gray-900 print:border-gray-800",children:[e.jsxs("th",{className:"text-left pr-2 font-semibold flex items-center gap-1",children:[e.jsx(f,{className:"h-3 w-3"}),r("info_types.print.name_label"),":"]}),e.jsx("td",{className:"pr-4",children:l.name||"Info Type"}),e.jsxs("th",{className:"text-left pr-2 font-semibold flex items-center gap-1",children:[e.jsx(m,{className:"h-3 w-3"}),r("info_types.print.created_at_label"),":"]}),e.jsx("td",{className:"pr-4",children:h(l.created_at)})]}),e.jsxs("tr",{className:"text-sm border-b border-gray-900 print:border-gray-800",children:[e.jsxs("th",{className:"text-left pr-2 font-semibold flex items-center gap-1",children:[e.jsx($,{className:"h-3 w-3"}),r("info_types.print.created_by_label"),":"]}),e.jsx("td",{className:"pr-4",children:((_=l.creator)==null?void 0:_.name)||"-"}),e.jsxs("th",{className:"text-left pr-2 font-semibold flex items-center gap-1",children:[e.jsx(m,{className:"h-3 w-3"}),r("info_types.print.updated_at_label"),":"]}),e.jsx("td",{className:"pr-4",children:h(l.updated_at)})]}),e.jsxs("tr",{className:"text-sm pt-2 py-2",children:[e.jsxs("th",{className:"text-left pr-2 font-semibold flex items-center gap-1",children:[e.jsx(F,{className:"h-3 w-3"}),r("info_types.print.description_label"),":"]}),e.jsx("td",{colSpan:3,children:l.description||r("info_types.print.no_description")})]})]}),e.jsx("hr",{className:"my-4 border-gray-900 print:border-gray-800"}),b.map((t,s)=>{var a,i,v,w,C,k,S;return e.jsxs("div",{className:"mt-4 print:page-break-inside-avoid",children:[e.jsx("div",{className:"pt-4 mb-2",children:e.jsxs("h3",{className:"text-lg font-semibold text-black mb-2",children:[s+1,". ",t.name||"Untitled"]})}),e.jsxs("table",{className:"w-full print:text-xs",style:{borderCollapse:"collapse"},children:[e.jsxs("tr",{className:"border-b border-gray-300 print:border-gray-600",children:[e.jsxs("th",{className:"text-left pr-2 font-semibold py-1 flex items-center gap-1",children:[e.jsx(f,{className:"h-3 w-3"}),r("info_types.print.code_label"),":"]}),e.jsx("td",{className:"pr-4 py-1",children:t.code||"-"}),e.jsxs("th",{className:"text-left pr-2 font-semibold py-1 flex items-center gap-1",children:[e.jsx(y,{className:"h-3 w-3"}),r("info_types.print.category_label"),":"]}),e.jsx("td",{className:"pr-4 py-1",children:((a=t.info_category)==null?void 0:a.name)||"-"}),e.jsxs("th",{className:"text-left pr-2 font-semibold py-1 flex items-center gap-1",children:[e.jsx($,{className:"h-3 w-3"}),r("info_types.print.creator_label"),":"]}),e.jsx("td",{className:"pr-4 py-1",children:((i=t.creator)==null?void 0:i.name)||"-"})]}),e.jsxs("tr",{className:"border-b border-gray-300 print:border-gray-600",children:[e.jsxs("th",{className:"text-left pr-2 font-semibold py-1 flex items-center gap-1",children:[t.confirmed?e.jsx(G,{className:"h-3 w-3 text-green-600"}):e.jsx(J,{className:"h-3 w-3 text-yellow-600"}),r("info_types.print.status_label"),":"]}),e.jsx("td",{className:"pr-4 py-1",children:t.confirmed?r("info_types.print.confirmed"):r("info_types.print.pending")}),e.jsxs("th",{className:"text-left pr-2 font-semibold py-1 flex items-center gap-1",children:[e.jsx(P,{className:"h-3 w-3"}),r("info_types.print.confirmed_by_label"),":"]}),e.jsx("td",{className:"pr-4 py-1",children:((v=t.confirmer)==null?void 0:v.name)||"-"}),e.jsxs("th",{className:"text-left pr-2 font-semibold py-1 flex items-center gap-1",children:[e.jsx(m,{className:"h-3 w-3"}),r("info_types.print.confirmed_at_label"),":"]}),e.jsx("td",{className:"pr-4 py-1",children:t.confirmed_at?h(t.confirmed_at):"-"})]}),e.jsxs("tr",{className:"border-b border-gray-300 print:border-gray-600",children:[e.jsxs("th",{className:"text-left pr-2 font-semibold py-1 flex items-center gap-1",children:[e.jsx(y,{className:"h-3 w-3"}),r("info_types.print.department_label"),":"]}),e.jsx("td",{className:"pr-4 py-1",children:((w=t.department)==null?void 0:w.name)||"-"}),e.jsxs("th",{className:"text-left pr-2 font-semibold py-1 flex items-center gap-1",children:[e.jsx(m,{className:"h-3 w-3"}),r("info_types.print.created_at_label"),":"]}),e.jsx("td",{className:"pr-4 py-1",children:h(t.created_at)}),e.jsxs("th",{className:"text-left pr-2 font-semibold py-1 flex items-center gap-1",children:[e.jsx(m,{className:"h-3 w-3"}),r("info_types.print.updated_at_label"),":"]}),e.jsx("td",{className:"pr-4 py-1",children:h(t.updated_at)})]}),(t.province||t.district)&&e.jsxs("tr",{className:"border-b border-gray-300 print:border-gray-600",children:[e.jsxs("th",{className:"text-left pr-2 font-semibold py-1 flex items-center gap-1",children:[e.jsx(y,{className:"h-3 w-3"}),r("info_types.print.province_label"),":"]}),e.jsx("td",{className:"pr-4 py-1",children:((C=t.province)==null?void 0:C.name)||"-"}),e.jsxs("th",{className:"text-left pr-2 font-semibold py-1 flex items-center gap-1",children:[e.jsx(y,{className:"h-3 w-3"}),r("info_types.print.district_label"),":"]}),e.jsx("td",{className:"pr-4 py-1",children:((k=t.district)==null?void 0:k.name)||"-"}),e.jsxs("th",{className:"text-left pr-2 font-semibold py-1 flex items-center gap-1",children:[e.jsx(P,{className:"h-3 w-3"}),r("info_types.print.info_type_label"),":"]}),e.jsx("td",{className:"pr-4 py-1",children:((S=t.info_type)==null?void 0:S.name)||"-"})]})]}),t.description&&e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 print:bg-white print:border print:border-gray-300 rounded",children:[e.jsxs("h4",{className:"font-semibold text-black mb-2 flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4"}),r("info_types.print.description_label"),":"]}),e.jsx("p",{className:"text-sm text-justify leading-relaxed",children:t.description})]}),s<b.length-1&&e.jsx("hr",{className:"my-4 border-gray-300 print:border-gray-600"})]},t.id)}),e.jsx("div",{className:"mt-8 pt-4 border-t border-gray-300 print:border-gray-600 print:mt-12",children:e.jsx("div",{className:"text-center text-sm text-gray-600 print:text-gray-800",children:e.jsxs("p",{className:"flex items-center justify-center gap-2",children:[e.jsx(m,{className:"h-4 w-4"}),r("info_types.print.generated_on"),": ",u(new Date().toISOString())]})})}),z&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[e.jsx(K,{className:"mr-2 h-5 w-5"}),r("info_types.print.settings.title")]}),e.jsx("button",{onClick:()=>d(!1),className:"text-gray-500 hover:text-gray-700 focus:outline-none",children:e.jsx(q,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex border-b",children:[e.jsx("button",{onClick:()=>p("colors"),className:`px-4 py-2 border-b-2 font-medium text-sm ${c==="colors"?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(D,{className:"mr-2 h-4 w-4"}),r("info_types.print.settings.tabs.colors")]})}),e.jsx("button",{onClick:()=>p("typography"),className:`px-4 py-2 border-b-2 font-medium text-sm ${c==="typography"?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(V,{className:"mr-2 h-4 w-4"}),r("info_types.print.settings.tabs.typography")]})}),e.jsx("button",{onClick:()=>p("layout"),className:`px-4 py-2 border-b-2 font-medium text-sm ${c==="layout"?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(W,{className:"mr-2 h-4 w-4"}),r("info_types.print.settings.tabs.layout")]})}),e.jsx("button",{onClick:()=>p("labels"),className:`px-4 py-2 border-b-2 font-medium text-sm ${c==="labels"?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(f,{className:"mr-2 h-4 w-4"}),r("info_types.print.settings.tabs.labels")]})}),e.jsx("button",{onClick:()=>p("date_format"),className:`px-4 py-2 border-b-2 font-medium text-sm ${c==="date_format"?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),r("info_types.print.settings.tabs.date_format")]})})]}),c==="colors"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(D,{className:"mr-2 h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-md font-medium",children:r("info_types.print.settings.colors.title")})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r("info_types.print.settings.colors.header")}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"color",id:"headerColorPicker",value:n.headerColor,onChange:t=>o("headerColor",t.target.value),className:"sr-only"}),e.jsx("label",{htmlFor:"headerColorPicker",className:"block h-10 w-10 rounded border border-gray-300 cursor-pointer",style:{backgroundColor:n.headerColor}})]}),e.jsx("input",{type:"text",value:n.headerColor,onChange:t=>o("headerColor",t.target.value),className:"flex-1 border border-gray-300 rounded px-3 py-2 text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r("info_types.print.settings.colors.text")}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"color",id:"textColorPicker",value:n.textColor,onChange:t=>o("textColor",t.target.value),className:"sr-only"}),e.jsx("label",{htmlFor:"textColorPicker",className:"block h-10 w-10 rounded border border-gray-300 cursor-pointer",style:{backgroundColor:n.textColor}})]}),e.jsx("input",{type:"text",value:n.textColor,onChange:t=>o("textColor",t.target.value),className:"flex-1 border border-gray-300 rounded px-3 py-2 text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r("info_types.print.settings.colors.accent")}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"color",id:"accentColorPicker",value:n.accentColor,onChange:t=>o("accentColor",t.target.value),className:"sr-only"}),e.jsx("label",{htmlFor:"accentColorPicker",className:"block h-10 w-10 rounded border border-gray-300 cursor-pointer",style:{backgroundColor:n.accentColor}})]}),e.jsx("input",{type:"text",value:n.accentColor,onChange:t=>o("accentColor",t.target.value),className:"flex-1 border border-gray-300 rounded px-3 py-2 text-sm"})]})]})]})]}),c==="date_format"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(T,{className:"mr-2 h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-md font-medium",children:r("info_types.print.settings.date_format.title")})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:r("info_types.print.settings.date_format.title")}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"dateFormat",value:"gregorian",checked:n.dateFormat==="gregorian",onChange:t=>o("dateFormat",t.target.value),className:"mr-2"}),e.jsx("span",{className:"text-sm",children:r("info_types.print.settings.date_format.gregorian")})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"dateFormat",value:"hijri",checked:n.dateFormat==="hijri",onChange:t=>o("dateFormat",t.target.value),className:"mr-2"}),e.jsx("span",{className:"text-sm",children:r("info_types.print.settings.date_format.hijri")})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"dateFormat",value:"persian",checked:n.dateFormat==="persian",onChange:t=>o("dateFormat",t.target.value),className:"mr-2"}),e.jsx("span",{className:"text-sm",children:r("info_types.print.settings.date_format.persian")})]})]})]}),e.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[e.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"نمونه تاریخ:"}),e.jsx("div",{className:"text-sm text-gray-600",children:u(new Date().toISOString())})]})]})]})]}),e.jsxs("div",{className:"border-t px-4 py-3 flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:r("common.cancel")}),e.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 bg-primary border border-transparent rounded-md text-sm font-medium text-white hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:r("common.save")}),e.jsx("button",{onClick:()=>{d(!1),setTimeout(()=>window.print(),300)},className:"px-4 py-2 bg-primary border border-transparent rounded-md text-sm font-medium text-white hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:r("info_types.print.settings.apply_and_print")})]})]})})]})}export{we as default};
