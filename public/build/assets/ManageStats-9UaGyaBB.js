import{m as k,r as h,j as t,L as C,$ as y}from"./app-BtTEgW9J.js";import{A as T}from"./app-layout-BdK-h-D1.js";import{B}from"./button-gGOf78zu.js";import{C as F,d as L}from"./card-C8nZDWzg.js";import{u as A}from"./translate-C5oEGxGi.js";import{u as D}from"./use-permissions-uvLuz9g4.js";import{a as V}from"./permission-guard-Bu9PMuen.js";import{S as E,a as z,b as H,c as I,d as u}from"./select-CLPmUaCW.js";import{T as O}from"./TreeViewStatSelector-Cnl5iP-k.js";import{L as R}from"./label-BHmMgvLW.js";import{H as $}from"./header-CPLTdMUA.js";import{F as M}from"./FooterButtons-expyM6NH.js";import{A as P}from"./arrow-left-pFLVeCQ7.js";import{a as U}from"./index-9rctAjoj.js";import{B as q}from"./building-2-nzYsTWQu.js";import{T as G}from"./triangle-alert-CKaQEQly.js";import"./utils-CVSqjLj9.js";import"./x-C__OvfAX.js";import"./createLucideIcon-6Q9HhWKD.js";import"./index-0JqcZo3z.js";import"./index-DIlSpoX_.js";import"./index-CJ4fmXDY.js";import"./index-C3y64J4O.js";import"./avatar-ZF52esRF.js";import"./file-text-ULtIO4cN.js";import"./users-DR2xDJqp.js";import"./tag-Dfw80CG5.js";import"./qr-code-CB4rj_fA.js";import"./map-pin-BctDd7fR.js";import"./database-CdRkFkt5.js";import"./shield-DATaa7Yn.js";import"./index-Xdj7HaT8.js";import"./check-DT-VX_SI.js";import"./input-D72mYtbS.js";import"./textarea-DQKq5XIL.js";import"./plus-ENJK3Rk6.js";import"./save-DvFN962T.js";import"./tslib.es6-CmEaCU22.js";function Dt({item:a,statItems:m,statCategories:_}){const{t:i}=A();D();const{data:J,setData:f,put:g,processing:x,errors:K}=k({stats:[]}),[o,c]=h.useState(()=>{var n;const e={};return(n=a.itemStats)==null||n.forEach(s=>{e[s.statCategoryItem.id]={value:s.string_value||"",notes:s.notes}}),e}),[r,b]=h.useState(null),j=[{title:i("national_insight_center_info.page_title"),href:route("national-insight-center-infos.index")},{title:a.title,href:route("national-insight-center-info-items.show",a.id)},{title:i("national_insight_center_info_item.stats.title"),href:"#"}],p=e=>{e&&e.preventDefault();const n=Object.entries(o).filter(([s,{value:l}])=>l.trim()!=="").map(([s,{value:l,notes:v}])=>({stat_category_item_id:parseInt(s),value:l,notes:v||void 0}));f("stats",n),g(route("national-insight-center-info-items.stats.update",a.id))},w=_.map(e=>({id:e.id,label:e.label,color:e.color})),d=r?m.filter(e=>e.category.id===r):m;function N(e,n){c(s=>({...s,[e]:{...s[e]||{notes:null},value:n}}))}function S(e,n){c(s=>({...s,[e]:{...s[e]||{value:""},notes:n||null}}))}return Object.keys(o).length,t.jsxs(T,{breadcrumbs:j,children:[t.jsx(C,{title:i("national_insight_center_info_item.stats.title",{name:a.title})}),t.jsxs("div",{className:"container px-0 py-6",children:[t.jsx($,{title:i("national_insight_center_info_item.stats.title",{name:a.title}),description:i("national_insight_center_info_item.stats.description"),icon:t.jsx(U,{className:"h-6 w-6 text-white"}),model:"national_insight_center_info_item",routeName:"national-insight-center-info-items.stats",buttonText:i("national_insight_center_info_item.stats.save_button"),theme:"purple",buttonSize:"lg",showBackButton:!0,backRouteName:"national-insight-center-info-items.show",backButtonText:i("national_insight_center_info_item.stats.back_button"),showButton:!1,actionButtons:t.jsx(t.Fragment,{children:t.jsx(B,{asChild:!0,variant:"outline",size:"lg",className:"bg-white/20 backdrop-blur-md border-white/30 text-white hover:bg-white/30 shadow-2xl rounded-2xl px-6 py-3 text-lg font-semibold transition-all duration-300 hover:scale-105",children:t.jsxs(y,{href:route("national-insight-center-info-items.show",a.id),className:"flex items-center gap-3",children:[t.jsx(P,{className:"h-5 w-5"}),i("national_insight_center_info_item.stats.back_button")]})})})}),t.jsx(V,{model:"national_insight_center_info_item",children:t.jsx("form",{onSubmit:p,children:t.jsxs("div",{className:"grid gap-8",children:[t.jsx(F,{className:"shadow-2xl bg-gradient-to-bl from-white dark:from-gray-800 to-purple-50/30 dark:to-purple-900/20 border-0 overflow-hidden",children:t.jsxs(L,{className:"p-8 space-y-6",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs(R,{htmlFor:"category-filter",className:"text-base font-medium flex items-center gap-2 text-purple-700 dark:text-purple-300 text-right",dir:"rtl",children:[i("national_insight_center_info_item.stats.filter_by_category"),t.jsx(q,{className:"h-4 w-4"})]}),t.jsxs(E,{value:(r==null?void 0:r.toString())||"all",onValueChange:e=>b(e!=="all"?parseInt(e):null),children:[t.jsx(z,{id:"category-filter",className:"h-12 border-purple-200 dark:border-purple-700 focus:border-purple-500 focus:ring-purple-500/20 bg-gradient-to-l from-purple-50 dark:from-purple-900/30 to-white dark:to-gray-800 text-right",children:t.jsx(H,{placeholder:i("incidents.filters.all_categories")})}),t.jsxs(I,{children:[t.jsx(u,{value:"all",children:i("incidents.filters.all_categories")}),w.map(e=>t.jsx(u,{value:e.id.toString(),children:t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"mr-2 h-3 w-3 rounded-full",style:{backgroundColor:e.color}}),e.label]})},e.id))]})]})]}),d.length>0?t.jsx(O,{items:d,statsData:o,onValueChange:N,onNotesChange:S}):t.jsxs("div",{className:"text-center py-8",children:[t.jsx("div",{className:"p-4 bg-purple-100 dark:bg-purple-800/30 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:t.jsx(G,{className:"h-8 w-8 text-purple-400 dark:text-purple-500"})}),t.jsx("p",{className:"text-lg font-semibold text-purple-800 dark:text-purple-200 mb-2",children:i("national_insight_center_info_item.stats.no_items")}),t.jsx("p",{className:"text-purple-600 dark:text-purple-400",children:i("national_insight_center_info_item.stats.no_items_description")})]})]})}),t.jsx(M,{onCancel:()=>window.history.back(),onSubmit:p,processing:x,cancelText:i("national_insight_center_info_item.stats.cancel_button"),submitText:i("national_insight_center_info_item.stats.save_button"),savingText:i("national_insight_center_info_item.stats.saving_button")})]})})})]})]})}export{Dt as default};
