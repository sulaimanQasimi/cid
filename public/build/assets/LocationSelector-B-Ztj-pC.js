import{r as m,j as n}from"./app-GSRKIW_T.js";import z from"./afghanistanLow-mnRKi4Rp.js";import{A as B}from"./AnimatedTheme-BUmUfnV6.js";import{R as G,C as k,B as M}from"./Circle-BcgwdeMg.js";import{M as D,g as _,a as N,b as R}from"./MapPolygonSeries-DiOqWnPu.js";import{R as F,c as o,C as K,o as j,a as v,p as S}from"./SerialChart-BtiA0Xmo.js";import{G as X,Z as Y}from"./ZoomControl-Ck8bfgKR.js";import{L as V}from"./LinearGradient-bRaY-7rK.js";const y={Badakhshan:{lat:36.7347,lng:70.8119},Badghis:{lat:35.1671,lng:63.7695},Baghlan:{lat:35.9462,lng:68.71},Balkh:{lat:36.7581,lng:67.1015},Bamyan:{lat:34.81,lng:67.8218},Daykundi:{lat:33.737,lng:66.0461},Farah:{lat:32.3747,lng:62.1413},Faryab:{lat:36.0799,lng:64.9036},Ghazni:{lat:33.5453,lng:68.4215},Ghor:{lat:34.0998,lng:65.2478},Helmand:{lat:31.5797,lng:64.37},Herat:{lat:34.353,lng:62.209},Jowzjan:{lat:36.8969,lng:65.9042},Kabul:{lat:34.5553,lng:69.2075},Kandahar:{lat:31.6133,lng:65.71},Kapisa:{lat:34.9809,lng:69.621},Khost:{lat:33.3395,lng:69.9348},Kunar:{lat:34.8461,lng:71.0973},Kunduz:{lat:36.729,lng:68.8685},Laghman:{lat:34.6898,lng:70.1456},Logar:{lat:34.0144,lng:69.1933},Nangarhar:{lat:34.1718,lng:70.6217},Nimruz:{lat:31.0255,lng:62.4553},Nuristan:{lat:35.3252,lng:70.9072},Paktia:{lat:33.7062,lng:69.3851},Paktika:{lat:32.2648,lng:68.5249},Panjshir:{lat:35.3125,lng:69.9372},Parwan:{lat:35.0095,lng:69.1424},Samangan:{lat:36.312,lng:67.9649},"Sar-e Pol":{lat:36.2151,lng:65.9328},Takhar:{lat:36.6701,lng:69.4787},Uruzgan:{lat:32.9275,lng:66.0345},Wardak:{lat:34.38,lng:68.2512},Zabul:{lat:32.273,lng:67.259}},W={lat:33.9391,lng:67.71},f=15037299,Z=15684432,H=13840175,E=12000284;function ot({value:p,onChange:w}){const i=m.useRef(null),h=m.useRef(null),[e,O]=m.useState(p||null),[g,L]=m.useState(!1),[C,x]=m.useState((p==null?void 0:p.province)||null);m.useEffect(()=>{if(i.current||!h.current)return;const c=setTimeout(()=>{try{const t=G.new(h.current);t.setThemes([B.new(t)]);const l=t.container.children.push(D.new(t,{panX:"rotateX",panY:"rotateY",projection:_(),paddingBottom:20,paddingTop:20,paddingLeft:20,paddingRight:20,maxZoomLevel:64,wheelY:"zoom",wheelX:"zoom"}));l.set("background",F.new(t,{fill:o(16706539),fillOpacity:1})),l.series.push(X.new(t,{step:2})).mapLines.template.setAll({stroke:o(14540253),strokeOpacity:.2});const u=l.series.push(N.new(t,{geoJSON:z,fill:o(f),stroke:o(16777215),valueField:"value"}));u.mapPolygons.template.set("fillGradient",V.new(t,{stops:[{color:o(f)},{color:o(f+2236962)}],rotation:90})),u.mapPolygons.template.setAll({tooltipText:"{name}",interactive:!0,fill:o(f),stroke:o(16777215),strokeWidth:1,shadowColor:o(0),shadowBlur:3,shadowOffsetX:1,shadowOffsetY:1,shadowOpacity:.1,cursorOverStyle:"pointer"}),u.mapPolygons.template.states.create("hover",{fill:o(Z),strokeWidth:2,shadowBlur:10,shadowOpacity:.2,scale:1.02,stateAnimationDuration:300}),u.mapPolygons.template.states.create("selected",{fill:o(H),strokeWidth:2,shadowBlur:10,shadowOpacity:.3,scale:1.03,stateAnimationDuration:400}),u.mapPolygons.template.events.on("click",function(a){const s=a.target,r=s.dataItem;if(r&&r.dataContext){const d=r.dataContext.name;u.mapPolygons.each(function(I){I.states.applyAnimate("default")}),s.states.applyAnimate("selected"),x(d);let b=W;d&&d in y&&(b=y[d]),A(b,d),s.animate({key:"scale",from:1.05,to:1.03,duration:400,loops:1})}});const P=l.series.push(R.new(t,{}));if(e&&(P.data.push({geometry:{type:"Point",coordinates:[e.lng,e.lat]}}),p)){for(const[a,s]of Object.entries(y))if(Math.abs(s.lat-p.lat)<.01&&Math.abs(s.lng-p.lng)<.01){x(a),u.mapPolygons.each(function(r){const d=r.dataItem;d&&d.dataContext&&d.dataContext.name===a&&r.states.applyAnimate("selected")});break}}P.bullets.push(function(){const a=k.new(t,{radius:8,tooltipText:"Selected Location",fill:o(E),stroke:o(16777215),strokeWidth:3,fillOpacity:.9}),s=k.new(t,{radius:0,fill:o(E),fillOpacity:.3}),r=K.new(t,{});return r.children.push(s),r.children.push(a),s.animate({key:"radius",from:5,to:15,duration:1500,loops:1/0,easing:j(v)}),s.animate({key:"fillOpacity",from:.5,to:0,duration:1500,loops:1/0,easing:j(v)}),a.set("shadowColor",o(0)),a.set("shadowBlur",8),a.set("shadowOffsetX",0),a.set("shadowOffsetY",2),a.set("shadowOpacity",.2),M.new(t,{sprite:r})}),l.set("zoomControl",Y.new(t,{x:S,y:0,centerX:S,centerY:0})),e?l.zoomToGeoPoint({longitude:e.lng,latitude:e.lat},4):l.zoomToGeoPoint({longitude:67.709953,latitude:33.93911},3),l.appear(1e3,100),i.current=t,L(!0),t.container.children.each(a=>{a.states&&(a.states.create("default",{}),a.states.apply("default"))}),setTimeout(()=>{t.resize()},200)}catch(t){console.error("Error initializing map:",t)}},100);return()=>{clearTimeout(c),i.current&&(i.current.dispose(),i.current=null)}},[]),m.useEffect(()=>{if(i.current&&g){const c=i.current.container.children.getIndex(0),t=c.series.values.find(l=>l instanceof R);t&&(e?(t.data.setAll([{geometry:{type:"Point",coordinates:[e.lng,e.lat]}}]),c.zoomToGeoPoint({longitude:e.lng,latitude:e.lat},4,!0,800)):(t.data.setAll([]),c.zoomToGeoPoint({longitude:67.709953,latitude:33.93911},3,!0,800)))}},[e,g]);const A=(c,t)=>{O(c),w(t?{...c,province:t}:null)},T=()=>{if(O(null),x(null),w(null),i.current&&g){const t=i.current.container.children.getIndex(0).series.values.find(l=>l instanceof N);t&&t.mapPolygons.each(function(l){l.states.applyAnimate("default")})}};return n.jsx("div",{className:"w-full",children:n.jsxs("div",{className:"flex flex-col gap-2",children:[n.jsx("div",{ref:h,className:"h-[400px] w-full rounded-md overflow-hidden",style:{border:"1px solid rgba(211, 47, 47, 0.3)",boxShadow:"0 4px 6px rgba(211, 47, 47, 0.1)"},children:!g&&n.jsx("div",{className:"flex items-center justify-center h-full w-full",style:{background:"#FEEBEB"},children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-red-600 mb-2"}),n.jsx("p",{className:"text-gray-700",children:"Loading map of Afghanistan..."})]})})}),n.jsxs("div",{className:"flex justify-between items-center bg-white p-2 rounded-md shadow-sm",children:[n.jsx("div",{className:"text-sm",children:e?n.jsxs("span",{className:"font-mono",children:[C?n.jsxs("span",{children:[n.jsx("span",{className:"text-blue-600 font-medium",children:C})," Province:"]}):"",n.jsxs("span",{className:"ml-1",children:["Lat: ",e.lat.toFixed(6),", Lng: ",e.lng.toFixed(6)]})]}):n.jsx("span",{className:"text-gray-500",children:"Click on a province to select location"})}),e&&n.jsx("button",{type:"button",onClick:T,className:"px-3 py-1 text-xs bg-red-50 text-red-500 rounded-md hover:bg-red-100 hover:text-red-700 transition-colors duration-200",children:"Clear Selection"})]})]})})}export{ot as L};
