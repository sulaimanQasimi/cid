import{r as y,U as z,j as e,L as O}from"./app-DmDo5wY0.js";import{B as f}from"./button-jP4wdIm_.js";import{u as Y}from"./translate-CZarN8Xl.js";import{a as E}from"./date-BaJKjiu2.js";import{m as H}from"./index-DKp1EUC0.js";import{A as I}from"./arrow-left-CVm_XHso.js";import{S as L,X as B}from"./x-DM2uWUfX.js";import{F as w}from"./file-text-CFIJyUxo.js";import{T as k}from"./tag-Cgf7madg.js";import{T as S}from"./tablet-smartphone-CR10UDp6.js";import{f as U}from"./index-CaunA62S.js";import"./utils-PjlJSuiK.js";import"./createLucideIcon-B3WK61Vj.js";function ae({sub_items:j=[],statSums:u=[],dateFrom:m,dateTo:x}){const{t:a}=Y(),[F,l]=y.useState(!1),[g,N]=y.useState("labels"),[s,T]=y.useState({governmentName:"امارت اسلامی افغانستان",ministryName:"وزارت دفاع",reportTitle:"گزارش مرکز ملی بصیرت",dateFormat:"persian"}),p=z.useMemo(()=>u.reduce((t,r)=>{const n=r.category_name||"بدون دسته‌بندی";return t[n]||(t[n]=[]),t[n].push(r),t},{}),[u]),C=()=>{window.print()},M=()=>{window.history.back()},i=(t,r)=>{T(n=>({...n,[t]:r}))},D=t=>{var r,n,_;try{const d=new Intl.DateTimeFormat("en-US-u-ca-islamic",{year:"numeric",month:"2-digit",day:"2-digit"}).formatToParts(t),h=((r=d.find(c=>c.type==="year"))==null?void 0:r.value)||"",b=((n=d.find(c=>c.type==="month"))==null?void 0:n.value)||"",P=((_=d.find(c=>c.type==="day"))==null?void 0:_.value)||"";return`${h}/${b.padStart(2,"0")}/${P.padStart(2,"0")}`}catch(v){console.error("Error converting to Hijri:",v);const d=Math.floor((t.getFullYear()-622)*.970224),h=Math.floor((t.getMonth()+1)*.970224),b=Math.floor(t.getDate()*.970224);return`${d}/${h.toString().padStart(2,"0")}/${b.toString().padStart(2,"0")}`}},$=t=>E(t.toISOString()),A=t=>{if(!t)return null;try{if(t.includes("/")){const n=H(t,"jYYYY/jMM/jDD");if(n.isValid())return n.toDate()}const r=new Date(t);return isNaN(r.getTime())?null:r}catch(r){return console.error("Error parsing date:",r),null}},o=t=>{if(!t)return"-";try{const r=A(t);if(!r)return t;switch(s.dateFormat){case"hijri":return D(r);case"persian":return $(r);case"gregorian":default:return U(r,"yyyy/MM/dd")}}catch(r){return console.error("Error formatting date:",r),t}};return e.jsxs("div",{className:"print:m-0 print:max-w-none print:p-0",style:{fontFamily:"Amiri, serif"},children:[e.jsx(O,{title:a("national_insight_center_info.print_dates.page_title")||"گزارش مرکز ملی بصیرت - بر اساس تاریخ"}),e.jsx("style",{dangerouslySetInnerHTML:{__html:`
                    @import url('https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap');
                    
                    @media print {
                        @page {
                            size: A4 landscape;
                            margin: 2.5cm;
                        }
                        body {
                            font-size: 11px;
                            line-height: 1.5;
                            font-family: 'Amiri', serif !important;
                        }
                        * {
                            font-family: 'Amiri', serif !important;
                        }
                        .print\\:text-xs {
                            font-size: 9px !important;
                        }
                        .print\\:border-gray-800 {
                            border-color: #1f2937 !important;
                        }
                        .print\\:border-gray-600 {
                            border-color: #4b5563 !important;
                        }
                        .print\\:hidden {
                            display: none !important;
                        }
                        table {
                            page-break-inside: auto;
                        }
                        tr {
                            page-break-inside: avoid;
                            page-break-after: auto;
                        }
                    }
                `}}),e.jsx("div",{className:"mb-6 print:hidden",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(f,{onClick:M,variant:"outline",size:"lg",className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4"}),a("national_insight_center_info.print.back_button")||"بازگشت"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(f,{onClick:()=>l(!0),variant:"outline",size:"lg",className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-4 w-4"}),a("national_insight_center_info.print_dates.settings_button")||"تنظیمات چاپ"]}),e.jsxs(f,{onClick:C,size:"lg",className:"flex items-center gap-2 bg-purple-600 hover:bg-purple-700",children:[e.jsx(w,{className:"h-4 w-4"}),a("national_insight_center_info.print.print_button")||"چاپ"]})]})]})}),e.jsxs("div",{className:"print:page-break-inside-avoid relative mx-auto max-w-7xl px-4",children:[e.jsxs("div",{className:"mb-10 border-b-2 border-gray-300 pb-6 text-center print:border-gray-800",children:[e.jsxs("div",{className:"relative mb-4 flex items-center justify-between",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:"/images/logos/logo 1.png",alt:"logo",className:"h-20 w-20 object-contain print:h-16 print:w-16"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"mb-1 text-3xl font-bold text-gray-900 print:text-2xl",children:s.governmentName}),e.jsx("h2",{className:"mb-1 text-2xl font-semibold text-gray-800 print:text-xl",children:s.ministryName}),e.jsx("h3",{className:"text-xl font-medium text-gray-700 print:text-lg",children:s.reportTitle})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:"/images/logos/logo 2.png",alt:"logo",className:"h-20 w-20 object-contain print:h-16 print:w-16"})})]}),e.jsx("div",{className:"mt-4 rounded-lg bg-gray-100 px-4 py-2 text-base font-medium text-gray-800 print:bg-gray-200 print:text-sm",children:m&&x?e.jsxs(e.Fragment,{children:["گزارش بر اساس از تاریخ ",o(m)," تا ",o(x)]}):m?e.jsxs(e.Fragment,{children:["گزارش بر اساس از تاریخ ",o(m)]}):x?e.jsxs(e.Fragment,{children:["گزارش بر اساس تا تاریخ ",o(x)]}):e.jsx(e.Fragment,{children:"گزارش کامل"})})]}),Object.keys(p).length>0&&e.jsx("div",{className:"mb-8 flex justify-start",children:e.jsx("div",{className:"overflow-hidden rounded-lg border border-gray-300 print:border-gray-800",children:e.jsxs("table",{className:"w-fit border-collapse bg-white",children:[e.jsx("thead",{children:e.jsx("tr",{className:"bg-gradient-to-b from-gray-700 to-gray-800 text-white print:bg-gray-900",children:Object.entries(p).map(([t,r])=>e.jsx("th",{colSpan:r.length,className:"border border-gray-400 px-4 py-3 text-center text-sm font-bold print:border-gray-800",children:t},t))})}),e.jsxs("tbody",{children:[e.jsx("tr",{className:"bg-white print:bg-white",children:Object.values(p).flat().map((t,r)=>e.jsx("td",{className:"h-22 rotate-90 border border-gray-300 px-4 py-2 text-center text-sm text-gray-900 print:border-gray-800",children:t.item_name},r))}),e.jsx("tr",{className:"bg-gray-50 print:bg-gray-100",children:Object.values(p).flat().map((t,r)=>e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center text-sm font-medium text-gray-900 print:border-gray-800",children:t.total_integer_value??0},r))})]})]})})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"mb-4 text-xl font-bold text-gray-900 print:text-lg",children:"جزئیات موارد"}),e.jsx("div",{className:"overflow-hidden rounded-lg border border-gray-300 print:border-gray-800",children:e.jsxs("table",{className:"min-w-full border-collapse bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gradient-to-b from-gray-700 to-gray-800 text-white print:bg-gray-900",children:[e.jsx("th",{className:"border border-gray-400 px-4 py-3 text-center text-sm font-bold print:border-gray-800",children:"اداره"}),e.jsx("th",{className:"border border-gray-400 px-4 py-3 text-center text-sm font-bold print:border-gray-800",children:"ولایت"}),e.jsx("th",{className:"border border-gray-400 px-4 py-3 text-center text-sm font-bold print:border-gray-800",children:"ولسوالی"}),e.jsx("th",{className:"w-1/3 border border-gray-400 px-4 py-3 text-center text-sm font-bold print:border-gray-800",children:"توضیحات"}),e.jsx("th",{className:"border border-gray-400 px-4 py-3 text-center text-sm font-bold print:border-gray-800",children:"تاریخ"})]})}),e.jsx("tbody",{children:j.length>0?j.map((t,r)=>e.jsxs("tr",{className:`transition-colors ${r%2===0?"bg-white print:bg-white":"bg-gray-50 print:bg-gray-100"} hover:bg-gray-100 print:hover:bg-inherit`,children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center text-sm text-gray-900 print:border-gray-800",children:t.department_name||"-"}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center text-sm text-gray-900 print:border-gray-800",children:t.province_name||"-"}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center text-sm text-gray-900 print:border-gray-800",children:t.district_name||"-"}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-justify text-sm leading-relaxed text-gray-900 break-words whitespace-normal print:border-gray-800",children:t.description||"-"}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center text-sm font-medium text-gray-900 print:border-gray-800",children:o(t.date)})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"border border-gray-300 px-4 py-8 text-center text-sm text-gray-500 print:border-gray-800",children:"هیچ موردی یافت نشد"})})})]})})]})]}),F&&e.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center",children:[e.jsx(w,{className:"mr-2 h-5 w-5"}),a("national_insight_center_info.print_dates.settings_title")||"تنظیمات چاپ"]}),e.jsx("button",{onClick:()=>l(!1),className:"text-gray-500 hover:text-gray-700 focus:outline-none",children:e.jsx(B,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex border-b",children:[e.jsx("button",{onClick:()=>N("labels"),className:`px-4 py-2 border-b-2 font-medium text-sm ${g==="labels"?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"mr-2 h-4 w-4"}),a("national_insight_center_info.print_dates.settings.tabs.labels")||"عنوان‌ها"]})}),e.jsx("button",{onClick:()=>N("date_format"),className:`px-4 py-2 border-b-2 font-medium text-sm ${g==="date_format"?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),a("national_insight_center_info.print_dates.settings.tabs.date_format")||"فرمت تاریخ"]})})]}),g==="labels"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"mr-2 h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-md font-medium",children:a("national_insight_center_info.print_dates.settings_labels_title")||"عنوان‌ها"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:a("national_insight_center_info.print_dates.settings_government_name")||"نام دولت:"}),e.jsx("input",{type:"text",value:s.governmentName,onChange:t=>i("governmentName",t.target.value),className:"w-full border border-gray-300 rounded px-3 py-2 text-sm",placeholder:"امارت اسلامی افغانستان"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:a("national_insight_center_info.print_dates.settings_ministry_name")||"نام وزارت:"}),e.jsx("input",{type:"text",value:s.ministryName,onChange:t=>i("ministryName",t.target.value),className:"w-full border border-gray-300 rounded px-3 py-2 text-sm",placeholder:"وزارت دفاع"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:a("national_insight_center_info.print_dates.settings_report_title")||"عنوان گزارش:"}),e.jsx("input",{type:"text",value:s.reportTitle,onChange:t=>i("reportTitle",t.target.value),className:"w-full border border-gray-300 rounded px-3 py-2 text-sm",placeholder:"گزارش مرکز ملی بصیرت"})]})]})]}),g==="date_format"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(S,{className:"mr-2 h-5 w-5 text-primary"}),e.jsx("h3",{className:"text-md font-medium",children:a("national_insight_center_info.print_dates.settings.date_format.title")||"فرمت تاریخ"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a("national_insight_center_info.print_dates.settings.date_format.title")||"فرمت تاریخ"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"dateFormat",value:"gregorian",checked:s.dateFormat==="gregorian",onChange:t=>i("dateFormat",t.target.value),className:"mr-2"}),e.jsx("span",{className:"text-sm",children:a("national_insight_center_info.print_dates.settings.date_format.gregorian")||"میلادی (Gregorian)"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"dateFormat",value:"hijri",checked:s.dateFormat==="hijri",onChange:t=>i("dateFormat",t.target.value),className:"mr-2"}),e.jsx("span",{className:"text-sm",children:a("national_insight_center_info.print_dates.settings.date_format.hijri")||"هجری (Hijri)"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",name:"dateFormat",value:"persian",checked:s.dateFormat==="persian",onChange:t=>i("dateFormat",t.target.value),className:"mr-2"}),e.jsx("span",{className:"text-sm",children:a("national_insight_center_info.print_dates.settings.date_format.persian")||"شمسی (Persian)"})]})]})]}),e.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[e.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:a("national_insight_center_info.print_dates.settings.date_format.preview")||"نمونه تاریخ:"}),e.jsx("div",{className:"text-sm text-gray-600",children:o(new Date().toISOString())})]})]})]}),e.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[e.jsx("h3",{className:"text-md font-medium mb-3",children:a("national_insight_center_info.print_dates.settings_preview")||"پیش‌نمایش"}),e.jsx("div",{className:"border rounded overflow-hidden bg-white p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"mb-1 text-2xl font-bold text-gray-900",children:s.governmentName}),e.jsx("h2",{className:"mb-1 text-xl font-semibold text-gray-800",children:s.ministryName}),e.jsx("h3",{className:"text-lg font-medium text-gray-700",children:s.reportTitle})]})})]})]}),e.jsxs("div",{className:"border-t px-4 py-3 flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>l(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:a("common.cancel")||"لغو"}),e.jsx("button",{onClick:()=>{l(!1)},className:"px-4 py-2 bg-primary border border-transparent rounded-md text-sm font-medium text-white hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:a("common.save")||"ذخیره"}),e.jsx("button",{onClick:()=>{l(!1),setTimeout(()=>window.print(),300)},className:"px-4 py-2 bg-purple-600 border border-transparent rounded-md text-sm font-medium text-white hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500",children:a("national_insight_center_info.print_dates.apply_and_print")||"ذخیره و چاپ"})]})]})})]})}export{ae as default};
