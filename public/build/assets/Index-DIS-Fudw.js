import{j as e,r as n,m as P,L as O,t as r,S as V}from"./app-CbeKh3sQ.js";import{u as q}from"./translate-DDGPHNjD.js";import{A as U,C as $}from"./app-layout-CfjUymSY.js";import{C as f,a as g,b as j,c as _,d as b}from"./card-DRnQwPQj.js";import{B as o}from"./button-vsEdbmui.js";import{I as G}from"./input-Bw-0_52B.js";import{L as v}from"./label-BNLuQA3w.js";import{B as J}from"./badge-BRzQMVqy.js";import{c as D,a as K}from"./utils-Bb4HXjj7.js";import{S as Q}from"./separator-C-E5qP-M.js";import{P as W}from"./page-header-CQA4Lrne.js";import{A as X,a as Y,b as Z,c as ee,d as se,e as te,f as ae,g as re}from"./alert-dialog-D_qAOQO4.js";import{c as le}from"./createLucideIcon-C8XIMENg.js";import{L as w}from"./loader-circle-DtH0mzsu.js";import{P as ie}from"./plus-L_b-Iqd7.js";import{D as ce}from"./database-BoNrNW8a.js";import{C as ne}from"./circle-check-big-CUbO8V9Z.js";import{D as oe}from"./download-BmpO791M.js";import{T as de}from"./trash-2-CgS5wtvV.js";import"./index-BLwe4XBe.js";import"./index-DFtoJXdd.js";import"./index-oxwXHx3t.js";import"./index-D6KZUy1Z.js";import"./x-CQQzauN7.js";import"./index-DDyZSmUm.js";import"./avatar-BtcH7zJL.js";import"./eye-DEj99WMU.js";import"./file-text-C1z44-YN.js";import"./users-C__KGsfH.js";import"./tag-e31-1F12.js";import"./triangle-alert-D2IIfKaK.js";import"./qr-code-B2awKxBM.js";import"./chart-column-ZTAypupu.js";import"./map-pin-CQeslq4k.js";import"./building-1My10aAi.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],pe=le("RefreshCw",me),xe=K("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-background text-foreground",destructive:"text-destructive-foreground [&>svg]:text-current *:data-[slot=alert-description]:text-destructive-foreground/80"}},defaultVariants:{variant:"default"}});function ue({className:a,variant:l,...s}){return e.jsx("div",{"data-slot":"alert",role:"alert",className:D(xe({variant:l}),a),...s})}function he({className:a,...l}){return e.jsx("div",{"data-slot":"alert-description",className:D("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",a),...l})}function Xe({backups:a,backupPath:l}){const{t:s}=q(),[d,m]=n.useState(!1),[k,C]=n.useState(!1),[y,p]=n.useState(!1),[i,A]=n.useState(null),[x,u]=n.useState(!1),S=[{title:"Dashboard",href:"/dashboard"},{title:"System Administration",href:"#"},{title:s("backup.page_title"),href:route("backup.index")}],{data:L,setData:I,post:B,processing:N,reset:R}=P({name:""}),z=t=>{t.preventDefault(),m(!0),B(route("backup.create"),{onSuccess:()=>{r.success(s("backup.create_success")),R(),m(!1),window.location.reload()},onError:()=>{r.error(s("backup.create_error")),m(!1)}})},E=t=>{try{const h=route("backup.download",{filename:t}),c=document.createElement("a");c.href=h,c.download=t,document.body.appendChild(c),c.click(),document.body.removeChild(c),r.success(s("backup.download_started"))}catch(h){console.error("Download error:",h),r.error(s("backup.download_error"))}},F=t=>{A(t),p(!0)},T=()=>{i&&(u(!0),V.delete(route("backup.delete",{filename:i.filename}),{preserveScroll:!0,onSuccess:()=>{p(!1),u(!1),r.success(s("backup.delete_success")),window.location.reload()},onError:()=>{u(!1),r.error(s("backup.delete_error"))}}))},H=()=>{C(!0),window.location.reload()},M=t=>new Date(t).toLocaleString("fa-IR");return e.jsxs(U,{breadcrumbs:S,children:[e.jsx(O,{title:s("backup.page_title")}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[e.jsx(W,{title:s("backup.page_title"),description:s("backup.page_description"),actions:e.jsx("div",{className:"flex space-x-2",children:e.jsxs(o,{onClick:H,disabled:k,variant:"outline",children:[e.jsx(pe,{className:`h-4 w-4 mr-2 ${k?"animate-spin":""}`}),s("backup.refresh")]})})}),e.jsxs(f,{children:[e.jsxs(g,{children:[e.jsx(j,{children:s("backup.create_title")}),e.jsx(_,{children:s("backup.create_description")})]}),e.jsx(b,{children:e.jsx("form",{onSubmit:z,className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(v,{htmlFor:"name",children:s("backup.name_label")}),e.jsx(G,{id:"name",type:"text",placeholder:s("backup.name_placeholder"),value:L.name,onChange:t=>I("name",t.target.value),disabled:N||d}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s("backup.name_helper")})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(o,{type:"submit",disabled:N||d,className:"w-full",children:d?e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"h-4 w-4 mr-2 animate-spin"}),s("backup.creating")]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),s("backup.create_button")]})})})]})})})]}),e.jsxs(f,{children:[e.jsxs(g,{children:[e.jsx(j,{children:s("backup.list_title")}),e.jsx(_,{children:s("backup.list_description")})]}),e.jsx(b,{children:e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsxs("table",{className:"w-full caption-bottom text-sm",children:[e.jsx("thead",{className:"[&_tr]:border-b",children:e.jsxs("tr",{className:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",children:[e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium",children:s("backup.filename")}),e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium",children:s("backup.size")}),e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium",children:s("backup.created_at")}),e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium",children:s("backup.actions")})]})}),e.jsx("tbody",{className:"[&_tr:last-child]:border-0",children:a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"h-12 px-4 text-center align-middle",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8",children:[e.jsx(ce,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:s("backup.no_backups")})]})})}):a.map(t=>e.jsxs("tr",{className:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",children:[e.jsx("td",{className:"p-4 align-middle",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ne,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{className:"font-medium",children:t.filename})]})}),e.jsx("td",{className:"p-4 align-middle",children:e.jsx(J,{variant:"secondary",children:t.size})}),e.jsx("td",{className:"p-4 align-middle",children:M(t.created_at)}),e.jsx("td",{className:"p-4 align-middle",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(o,{variant:"ghost",size:"sm",onClick:()=>E(t.filename),children:[e.jsx(oe,{className:"h-4 w-4 mr-1"}),s("backup.download")]}),e.jsxs(o,{variant:"ghost",size:"sm",onClick:()=>F(t),className:"text-destructive hover:text-destructive",children:[e.jsx(de,{className:"h-4 w-4 mr-1"}),s("backup.delete")]})]})})]},t.filename))})]})})})]}),e.jsxs(f,{children:[e.jsx(g,{children:e.jsx(j,{children:s("backup.info_title")})}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(v,{className:"text-sm font-medium",children:s("backup.storage_location")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:l})]}),e.jsxs("div",{children:[e.jsx(v,{className:"text-sm font-medium",children:s("backup.total_backups")}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.length})]})]}),e.jsx(Q,{}),e.jsxs(ue,{children:[e.jsx($,{className:"h-4 w-4"}),e.jsx(he,{children:s("backup.admin_only_warning")})]})]})]})]}),e.jsx(X,{open:y,onOpenChange:p,children:e.jsxs(Y,{children:[e.jsxs(Z,{children:[e.jsx(ee,{children:s("backup.delete_confirm_title")}),e.jsx(se,{children:s("backup.delete_confirm_description",{filename:(i==null?void 0:i.filename)||""})})]}),e.jsxs(te,{children:[e.jsx(ae,{disabled:x,children:s("common.cancel")}),e.jsx(re,{onClick:T,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",disabled:x,children:x?e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"mr-2 h-4 w-4 animate-spin"}),s("backup.deleting")]}):s("backup.delete")})]})]})})]})}export{Xe as default};
