import{r as V,j as e,L as $,$ as c}from"./app-i9gygtI7.js";import{B as d}from"./button-DA8WHqQ5.js";import{C as m,a as h,b as x,c as p,d as j}from"./card-NUH92OWN.js";import{B as n}from"./badge-CGb-l8vH.js";import{P as H}from"./page-header-FZ74MmJ8.js";import{P as O}from"./pagination-CJDq_C4x.js";import{A as E}from"./app-layout-COHwvIY4.js";import{T as I,a as z,b as k,c as f,d as R,e as _}from"./table-C-ClZ2FP.js";import{T as U,a as q,b as g,c as v}from"./tabs-BSYtR09-.js";import{L as F}from"./label-ByOtflD3.js";import{S as G,a as J,b as K,c as Q,d as P}from"./select-yjOttDTn.js";import{u as W}from"./translate-wL0aa-sI.js";import{f as o}from"./index-CaunA62S.js";import{A as X}from"./arrow-left-262aYfzE.js";import{S as T}from"./square-pen-urOw-TU4.js";import{c as B}from"./createLucideIcon-CCdCu9x0.js";import{C as Y}from"./clock-BB8X0p25.js";import{S as Z,T as ee}from"./triangle-alert-TrSvGMVO.js";import{U as S}from"./user-B6cCFwZE.js";import"./utils-Cqzwlyr3.js";import"./chevron-left-CAL4Kwwx.js";import"./index-BYxWpEkI.js";import"./index-DvqLlsqE.js";import"./index-CeLN-tmV.js";import"./index-CVa0K7PG.js";import"./x-C8tQnPGz.js";import"./index-BVlwhF2s.js";import"./avatar-sdpJXCM7.js";import"./app-logo-Zw_iVi_A.js";import"./app-logo-icon-CAGB5ViX.js";import"./eye-CM8Mcy_6.js";import"./file-text-DN0_y2i8.js";import"./users-CRlr-5yi.js";import"./tag-BP1vVV3I.js";import"./qr-code-5CTkCvG_.js";import"./globe-DI9HJTz2.js";import"./index-DOgva_i9.js";import"./check-BTVcMUtY.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M7 16h8",key:"srdodz"}],["path",{d:"M7 11h12",key:"127s9w"}],["path",{d:"M7 6h3",key:"w9rmul"}]],te=B("ChartBar",se);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],re=B("CirclePlus",ie);function Ue({report:i,incidents:u,reportStats:b,statCategories:N}){var w,C;const{t:s}=W(),L=[{title:s("sidebar.intelligence_dashboard"),href:"/dashboard"},{title:s("sidebar.incident_reports"),href:route("incident-reports.index")},{title:i.report_number,href:route("incident-reports.show",i.id)}],[y,D]=V.useState(null),a={};b.forEach(t=>{const r=t.stat_category_item.category.label;t.stat_category_item.category.id,a[r]||(a[r]=[]),a[r].push(t)});const M=y?Object.entries(a).filter(([t,r])=>r.some(l=>l.stat_category_item.category.id===y)):Object.entries(a);function A(t){return t.integer_value!==null?t.integer_value.toString():t.string_value||""}return e.jsxs(E,{breadcrumbs:L,children:[e.jsx($,{title:s("incident_reports.show.page_title",{number:i.report_number})}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[e.jsx(H,{title:s("incident_reports.show.page_header_title",{number:i.report_number}),description:o(new Date(i.report_date),"PPP"),actions:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(d,{variant:"outline",onClick:()=>window.history.back(),children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),s("common.back")]}),e.jsx(d,{asChild:!0,children:e.jsxs(c,{href:route("incident-reports.edit",i.id),children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),s("incident_reports.actions.edit_report")]})})]})}),e.jsxs(U,{defaultValue:"details",className:"w-full",children:[e.jsxs(q,{className:"grid w-full grid-cols-3",children:[e.jsx(g,{value:"details",children:s("incident_reports.tabs.details")}),e.jsx(g,{value:"incidents",children:s("incidents.page_title")}),e.jsxs(g,{value:"stats",className:"flex items-center",children:[e.jsx(te,{className:"mr-2 h-4 w-4"}),s("incident_reports.stats.title")]})]}),e.jsxs(v,{value:"details",className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(m,{className:"md:col-span-2",children:[e.jsxs(h,{children:[e.jsx(x,{children:s("incident_reports.details.title")}),e.jsx(p,{children:s("incident_reports.details.long_description")})]}),e.jsxs(j,{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 border-b pb-4",children:[e.jsxs(n,{variant:"outline",className:"flex items-center",children:[e.jsx(Y,{className:"mr-1 h-3 w-3"}),s("incident_reports.show.report_date_label"),": ",o(new Date(i.report_date),"PPP")]}),e.jsx(n,{className:"flex items-center",variant:i.report_status==="approved"?"outline":i.report_status==="reviewed"?"secondary":"default",children:s(`incident_reports.status.${i.report_status}`)}),e.jsxs(n,{variant:i.security_level==="classified"||i.security_level==="restricted"?"destructive":"default",className:"flex items-center",children:[e.jsx(Z,{className:"mr-1 h-3 w-3"}),s(`incident_reports.level.${i.security_level}`)]}),i.source&&e.jsxs(n,{variant:"outline",className:"flex items-center",children:[s("incident_reports.show.source_label"),": ",i.source]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:s("incident_reports.details.title")}),e.jsx("div",{className:"whitespace-pre-wrap mt-2 text-muted-foreground",children:i.details})]}),i.action_taken&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:s("incident_reports.details.actions_taken_title")}),e.jsx("div",{className:"whitespace-pre-wrap mt-2 text-muted-foreground",children:i.action_taken})]}),i.recommendation&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:s("incident_reports.details.recommendations_title")}),e.jsx("div",{className:"whitespace-pre-wrap mt-2 text-muted-foreground",children:i.recommendation})]})]})]}),e.jsxs(m,{children:[e.jsx(h,{children:e.jsx(x,{children:s("incident_reports.form.info_title")})}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:s("incident_reports.show.submitted_by")}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(S,{className:"h-4 w-4 mr-2 text-muted-foreground"}),((w=i.submitter)==null?void 0:w.name)||s("incidents.unknown")]})]}),i.approver&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:s("incident_reports.show.approved_by")}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(S,{className:"h-4 w-4 mr-2 text-muted-foreground"}),(C=i.approver)==null?void 0:C.name]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:s("incident_reports.show.created_at")}),e.jsx("div",{className:"mt-1",children:o(new Date(i.created_at),"PPP p")})]}),i.updated_at!==i.created_at&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:s("incident_reports.show.last_updated")}),e.jsx("div",{className:"mt-1",children:o(new Date(i.updated_at),"PPP p")})]})]})]})]}),e.jsx(v,{value:"incidents",children:e.jsxs(m,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(x,{children:s("incidents.page_title")}),e.jsx(p,{children:s("incident_reports.incidents.card_description")})]}),e.jsx(d,{asChild:!0,children:e.jsxs(c,{href:route("incident-reports.incidents",i.id),children:[e.jsx(ee,{className:"mr-2 h-4 w-4"}),s("incident_reports.incidents.view_all")]})})]}),e.jsxs(j,{children:[e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsxs("table",{className:"w-full caption-bottom text-sm",children:[e.jsx("thead",{className:"[&_tr]:border-b",children:e.jsxs("tr",{className:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",children:[e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium",children:s("incidents.table.title")}),e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium",children:s("incidents.table.date")}),e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium",children:s("incidents.table.category")}),e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium",children:s("incidents.table.severity")}),e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium",children:s("common.actions")})]})}),e.jsx("tbody",{className:"[&_tr:last-child]:border-0",children:u.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"h-12 px-4 text-center align-middle",children:s("incidents.no_incidents")})}):u.data.map(t=>e.jsxs("tr",{className:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",children:[e.jsx("td",{className:"p-4 align-middle",children:t.title}),e.jsx("td",{className:"p-4 align-middle",children:o(new Date(t.incident_date),"PP")}),e.jsx("td",{className:"p-4 align-middle",children:t.category?e.jsx(n,{style:{backgroundColor:t.category.color,color:"#fff"},children:t.category.name}):s("incidents.none")}),e.jsx("td",{className:"p-4 align-middle",children:e.jsx(n,{variant:t.severity==="high"?"destructive":t.severity==="medium"?"warning":"default",children:t.severity})}),e.jsx("td",{className:"p-4 align-middle",children:e.jsx(d,{variant:"ghost",size:"sm",asChild:!0,children:e.jsx(c,{href:route("incidents.show",t.id),children:s("incident_reports.view")})})})]},t.id))})]})}),e.jsx("div",{className:"mt-4",children:e.jsx(O,{links:u.links})})]})]})}),e.jsx(v,{value:"stats",children:e.jsxs(m,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(x,{children:s("incident_reports.stats.title")}),e.jsx(p,{children:s("incident_reports.stats.description")})]}),e.jsx(d,{asChild:!0,children:e.jsxs(c,{href:route("incident-reports.edit",i.id),children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),s("incident_reports.stats.edit")]})})]}),e.jsx(j,{children:Object.keys(a).length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx("p",{className:"text-muted-foreground",children:s("incident_reports.stats.empty")}),e.jsx(d,{variant:"outline",asChild:!0,className:"mt-4",children:e.jsxs(c,{href:route("incident-reports.edit",i.id),children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),s("incident_reports.stats.add_data")]})})]}):e.jsxs("div",{className:"space-y-6",children:[N.length>1&&b.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx(F,{htmlFor:"category-filter",children:s("incident_reports.stats.filter_by_category")}),e.jsxs(G,{onValueChange:t=>D(t==="all"?null:parseInt(t)),defaultValue:"all",children:[e.jsx(J,{id:"category-filter",children:e.jsx(K,{placeholder:s("incident_reports.stats.select_category")})}),e.jsxs(Q,{children:[e.jsx(P,{value:"all",children:s("incidents.filters.all_categories")}),N.filter(t=>Object.entries(a).some(([r])=>a[r][0].stat_category_item.category.id===t.id)).map(t=>e.jsx(P,{value:t.id.toString(),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-3 w-3 rounded-full mr-2",style:{backgroundColor:t.color}}),t.label]})},t.id))]})]})]}),M.map(([t,r])=>e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-medium",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-3 w-3 rounded-full mr-2",style:{backgroundColor:r[0].stat_category_item.category.color}}),t]})}),e.jsxs(I,{children:[e.jsx(z,{children:e.jsxs(k,{children:[e.jsx(f,{children:s("incident_reports.stats.table.item")}),e.jsx(f,{children:s("incident_reports.stats.table.value")}),e.jsx(f,{children:s("incident_reports.stats.table.notes")})]})}),e.jsx(R,{children:r.map(l=>e.jsxs(k,{children:[e.jsx(_,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"h-3 w-3 rounded-full",style:{backgroundColor:l.stat_category_item.color||l.stat_category_item.category.color}}),e.jsx("span",{children:l.stat_category_item.label})]})}),e.jsx(_,{children:A(l)}),e.jsx(_,{children:l.notes||"-"})]},l.id))})]})]},t))]})})]})})]})]})]})}export{Ue as default};
