import{r as n,S as D,j as e,L as P,$ as u}from"./app-3e9ZfCZj.js";import{B as x}from"./button-tOsBMVu3.js";import{B as N}from"./badge-Dcgw1Reo.js";import{C as k,a as F,b as B,c as V,d as E}from"./card-CPvNgHsq.js";import{P as T}from"./pagination-3tBS2Lwo.js";import{P as $}from"./page-header-ClrMVESu.js";import{A as z,b as H}from"./app-layout-7lRn1_rF.js";import{I as U}from"./input-Di9skOMK.js";import{S as b,a as S,b as _,c as y,d as t}from"./select-D3n8Qi7N.js";import{L as w}from"./label-CIrlRX49.js";import{u as M}from"./use-debounce-D5h_EPWc.js";import{P as Z}from"./plus-BnjQq30w.js";import{S as O}from"./search-B8iEtacX.js";import{X}from"./x-DTbSmVa3.js";import{f as q}from"./index-CaunA62S.js";import{S as G}from"./triangle-alert-CB08x4VC.js";import{F as J}from"./file-text-W_Iskmvy.js";import{A as L}from"./arrow-up-down-Bq6a0tgT.js";import"./chevron-left-CeniLpCK.js";import"./createLucideIcon-BtOnYZj6.js";import"./index-CkvEONY9.js";import"./index-CSgRh3VG.js";import"./index-BiOWnkU5.js";import"./index-C3obqkZ2.js";import"./index-BbGum64W.js";import"./avatar-CnrxwdK1.js";import"./app-logo-pu7XLt_2.js";import"./app-logo-icon-CH0F37vC.js";import"./users-D8IR1cY7.js";import"./tag-Cbang5gX.js";import"./qr-code-CqMqn-r0.js";import"./index-Dsn3sjeQ.js";import"./check-QjJiGsK8.js";const K=[{title:"Dashboard",href:"/dashboard"},{title:"Incident Reports",href:route("incident-reports.index")}];function Re({reports:p,filters:r={}}){const[j,C]=n.useState(r.search||""),[a,A]=n.useState(r.status||"all"),[d,I]=n.useState(r.security_level||"all"),[i,f]=n.useState(r.sort_field||"created_at"),[l,h]=n.useState(r.sort_direction||"desc"),v=M(j,500);n.useEffect(()=>{try{if(v!==r.search||a!==r.status||d!==r.security_level||i!==r.sort_field||l!==r.sort_direction){const s={search:v,status:a==="all"?"":a,security_level:d==="all"?"":d,sort_field:i,sort_direction:l},c=route("incident-reports.index"),g={preserveState:!0,replace:!0};setTimeout(()=>{D.get(c,s,g)},0)}}catch(s){console.error("Error applying filters:",s)}},[v,a,d,i,l,r]);const o=s=>{i===s?h(l==="asc"?"desc":"asc"):(f(s),h("asc"))},m=s=>i!==s?null:l==="asc"?e.jsx(L,{className:"ml-1 h-4 w-4 inline"}):e.jsx(L,{className:"ml-1 h-4 w-4 inline rotate-180"}),R=()=>{C(""),A("all"),I("all"),f("created_at"),h("desc")};return e.jsxs(z,{breadcrumbs:K,children:[e.jsx(P,{title:"Incident Reports"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[e.jsx($,{title:"Incident Reports",description:"Security reports and analysis documents",actions:e.jsx(x,{asChild:!0,children:e.jsxs(u,{href:route("incident-reports.create"),children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"New Report"]})})}),e.jsxs(k,{children:[e.jsx(F,{children:e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx(B,{children:"All Incident Reports"}),e.jsx(V,{children:"A list of all incident reports in the system."})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"relative w-full md:w-auto",children:[e.jsx(O,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(U,{placeholder:"Search reports...",className:"pl-8 pr-4",value:j,onChange:s=>C(s.target.value)})]}),(j||a||d||i!=="report_date"||l!=="desc")&&e.jsxs(x,{variant:"ghost",size:"sm",onClick:R,children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),"Clear"]})]})]})}),e.jsxs(E,{children:[e.jsxs("div",{className:"mb-4 grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx(w,{htmlFor:"status-filter",children:"Status"}),e.jsxs(b,{value:a,onValueChange:A,children:[e.jsx(S,{id:"status-filter",children:e.jsx(_,{placeholder:"All Statuses"})}),e.jsxs(y,{children:[e.jsx(t,{value:"all",children:"All Statuses"}),e.jsx(t,{value:"pending",children:"Pending"}),e.jsx(t,{value:"reviewed",children:"Reviewed"}),e.jsx(t,{value:"approved",children:"Approved"}),e.jsx(t,{value:"rejected",children:"Rejected"})]})]})]}),e.jsxs("div",{children:[e.jsx(w,{htmlFor:"security-level-filter",children:"Security Level"}),e.jsxs(b,{value:d,onValueChange:I,children:[e.jsx(S,{id:"security-level-filter",children:e.jsx(_,{placeholder:"All Security Levels"})}),e.jsxs(y,{children:[e.jsx(t,{value:"all",children:"All Security Levels"}),e.jsx(t,{value:"low",children:"Low"}),e.jsx(t,{value:"medium",children:"Medium"}),e.jsx(t,{value:"high",children:"High"}),e.jsx(t,{value:"critical",children:"Critical"})]})]})]}),e.jsxs("div",{children:[e.jsx(w,{htmlFor:"sort-by",children:"Sort By"}),e.jsxs(b,{value:`${i}:${l}`,onValueChange:s=>{const[c,g]=s.split(":");f(c),h(g)},children:[e.jsx(S,{id:"sort-by",children:e.jsx(_,{placeholder:"Sort by"})}),e.jsxs(y,{children:[e.jsx(t,{value:"report_date:desc",children:"Date (Newest first)"}),e.jsx(t,{value:"report_date:asc",children:"Date (Oldest first)"}),e.jsx(t,{value:"report_number:asc",children:"Report Number (A-Z)"}),e.jsx(t,{value:"report_number:desc",children:"Report Number (Z-A)"}),e.jsx(t,{value:"incidents_count:desc",children:"Incidents (Most first)"}),e.jsx(t,{value:"incidents_count:asc",children:"Incidents (Least first)"})]})]})]})]}),e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsxs("table",{className:"w-full caption-bottom text-sm",children:[e.jsx("thead",{className:"[&_tr]:border-b",children:e.jsxs("tr",{className:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",children:[e.jsxs("th",{className:"h-12 px-4 text-left align-middle font-medium cursor-pointer",onClick:()=>o("report_number"),children:["Report Number ",m("report_number")]}),e.jsxs("th",{className:"h-12 px-4 text-left align-middle font-medium cursor-pointer",onClick:()=>o("report_date"),children:["Date ",m("report_date")]}),e.jsxs("th",{className:"h-12 px-4 text-left align-middle font-medium cursor-pointer",onClick:()=>o("incidents_count"),children:["Incidents ",m("incidents_count")]}),e.jsxs("th",{className:"h-12 px-4 text-left align-middle font-medium cursor-pointer",onClick:()=>o("security_level"),children:["Security Level ",m("security_level")]}),e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium",children:"Submitted By"}),e.jsxs("th",{className:"h-12 px-4 text-left align-middle font-medium cursor-pointer",onClick:()=>o("report_status"),children:["Status ",m("report_status")]}),e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium",children:"Actions"})]})}),e.jsx("tbody",{className:"[&_tr:last-child]:border-0",children:p.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"h-12 px-4 text-center align-middle",children:"No reports found"})}):p.data.map(s=>{var c;return e.jsxs("tr",{className:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",children:[e.jsx("td",{className:"p-4 align-middle",children:e.jsx(u,{href:route("incident-reports.show",s.id),className:"font-medium text-primary hover:underline",children:s.report_number})}),e.jsx("td",{className:"p-4 align-middle",children:q(new Date(s.report_date),"PPP")}),e.jsx("td",{className:"p-4 align-middle",children:e.jsxs(N,{variant:"outline",children:[s.incidents_count," incident",s.incidents_count!==1?"s":""]})}),e.jsx("td",{className:"p-4 align-middle",children:e.jsxs(N,{variant:s.security_level==="classified"||s.security_level==="restricted"?"destructive":"default",children:[e.jsx(G,{className:"mr-1 h-3 w-3"}),s.security_level]})}),e.jsx("td",{className:"p-4 align-middle",children:((c=s.submitter)==null?void 0:c.name)||"Unknown"}),e.jsx("td",{className:"p-4 align-middle",children:e.jsx(N,{variant:s.report_status==="approved"?"outline":s.report_status==="reviewed"?"secondary":"default",children:s.report_status})}),e.jsx("td",{className:"p-4 align-middle",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(x,{variant:"ghost",size:"sm",asChild:!0,children:e.jsxs(u,{href:route("incident-reports.show",s.id),children:[e.jsx(J,{className:"h-4 w-4 mr-1"}),"View"]})}),e.jsx(x,{variant:"ghost",size:"sm",asChild:!0,children:e.jsxs(u,{href:route("incident-reports.incidents",s.id),children:[e.jsx(H,{className:"h-4 w-4 mr-1"}),"Incidents"]})})]})})]},s.id)})})]})}),e.jsx("div",{className:"mt-6",children:e.jsx(T,{links:p.links})})]})]})]})]})}export{Re as default};
