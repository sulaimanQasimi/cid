import{e as Z,s as Ue,w as li,x as ui,r as Rn,T as hi,y as ci,u as Qe,d as fi,f as vt,n as gi,z as pi}from"./Theme-BmHcCuAX.js";import{a2 as Ln,o as Ke,a as tn,a3 as de,a4 as di,J as mi,a5 as On,a6 as yi,a7 as Yt,a8 as vi,m as _i,R as Pi,e as wi,O as en,f as nn,a9 as bi,G as Nn,aa as Si}from"./SerialChart-MSWVa1Ci.js";import{g as Di,e as xi}from"./app-CbeKh3sQ.js";class _t extends Ln{constructor(){super(...arguments),Object.defineProperty(this,"_types",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_geometries",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_geoJSONparsed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_excluded",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_notIncluded",{enumerable:!0,configurable:!0,writable:!0,value:[]})}_afterNew(){this.fields.push("geometry","geometryType"),this._setRawDefault("geometryField","geometry"),this._setRawDefault("geometryTypeField","geometryType"),this._setRawDefault("idField","id"),this.on("geoJSON",t=>{let i=this._prevSettings.geoJSON;i&&i!=t&&this.data.clear()}),super._afterNew()}_handleDirties(){const t=this.get("geoJSON");let i=this._prevSettings.geoJSON;i&&i!=t&&(this._prevSettings.geoJSON=void 0,this._geoJSONparsed=!1),this._geoJSONparsed||(this._parseGeoJSON(),this._geoJSONparsed=!0)}_prepareChildren(){if(super._prepareChildren(),this._valuesDirty&&this._handleDirties(),this.get("geoJSON")&&(this.isDirty("geoJSON")||this.isDirty("include")||this.isDirty("exclude"))){this._handleDirties();const t=this.chart,i=this.get("exclude");i&&(t&&(t._centerLocation=null),Z(i,o=>{const r=this.getDataItemById(o);r&&this._excludeDataItem(r)}),Z(this._excluded,o=>{const r=o.get("id");r&&i.indexOf(r)==-1&&this._unexcludeDataItem(o)})),(!i||i.length==0)&&(Z(this._excluded,o=>{this._unexcludeDataItem(o)}),this._excluded=[]);const e=this.get("include");e&&(t&&(t._centerLocation=null),Z(this.dataItems,o=>{const r=o.get("id");r&&e.indexOf(r)==-1?this._notIncludeDataItem(o):this._unNotIncludeDataItem(o)})),e||(Z(this._notIncluded,o=>{this._unNotIncludeDataItem(o)}),this._notIncluded=[])}}_excludeDataItem(t){this._removeGeometry(t.get("geometry")),Ue(this._excluded,t)}_unexcludeDataItem(t){this._addGeometry(t.get("geometry"),this)}_notIncludeDataItem(t){this._removeGeometry(t.get("geometry")),Ue(this._notIncluded,t)}_unNotIncludeDataItem(t){this._addGeometry(t.get("geometry"),this)}checkInclude(t,i,e){if(i){if(i.length==0)return!1;if(i.indexOf(t)==-1)return!1}return!(e&&e.length>0&&e.indexOf(t)!=-1)}_parseGeoJSON(){const t=this.get("geoJSON");if(t){let i;t.type=="FeatureCollection"?i=t.features:t.type=="Feature"?i=[t]:["Point","LineString","Polygon","MultiPoint","MultiLineString","MultiPolygon"].indexOf(t.type)!=-1?i=[{geometry:t}]:console.log("nothing found in geoJSON");const e=this.get("geodataNames");if(i){const r=this.get("idField","id");for(let s=0,a=i.length;s<a;s++){let u=i[s],h=u.geometry;if(h){let l=h.type,c=u[r];if(e&&e[c]&&(u.properties.name=e[c]),this._types.indexOf(l)!=-1){let f;c!=null&&(f=li(this.dataItems,p=>p.get("id")==c));let g;f&&(g=f.dataContext),f?g.geometry||(g.geometry=h,g.geometryType=l,f.set("geometry",h),f.set("geometryType",l),this.processDataItem(f)):(g={geometry:h,geometryType:l,madeFromGeoData:!0},g[r]=c,this.data.push(g)),ui(u.properties,g)}}}}const o="geodataprocessed";this.events.isEnabled(o)&&this.events.dispatch(o,{type:o,target:this})}}_placeBulletsContainer(t){this.children.moveValue(this.bulletsContainer)}_removeBulletsContainer(){}projection(){const t=this.chart;if(t)return t.get("projection")}geoPath(){const t=this.chart;if(t)return t.getPrivate("geoPath")}_addGeometry(t,i){if(t&&i.get("affectsBounds",!0)){this._geometries.push(t);const e=this.chart;e&&e.markDirtyGeometries()}}_removeGeometry(t){if(t){Rn(this._geometries,t);const i=this.chart;i&&i.markDirtyGeometries()}}_dispose(){super._dispose();const t=this.chart;t&&t.series.removeValue(this)}_onDataClear(){super._onDataClear(),this._geoJSONparsed=!1,this._markDirtyKey("exclude")}}Object.defineProperty(_t,"className",{enumerable:!0,configurable:!0,writable:!0,value:"MapSeries"});Object.defineProperty(_t,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Ln.classNames.concat([_t.className])});class q{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const i=this._partials;let e=0;for(let o=0;o<this._n&&o<32;o++){const r=i[o],s=t+r,a=Math.abs(t)<Math.abs(r)?t-(s-r):r-(s-t);a&&(i[e++]=a),t=s}return i[e]=t,this._n=e+1,this}valueOf(){const t=this._partials;let i=this._n,e,o,r,s=0;if(i>0){for(s=t[--i];i>0&&(e=s,o=t[--i],s=e+o,r=o-(s-e),!r););i>0&&(r<0&&t[i-1]<0||r>0&&t[i-1]>0)&&(o=r*2,e=s+o,o==e-s&&(s=e))}return s}}function*Ci(n){for(const t of n)yield*t}function zn(n){return Array.from(Ci(n))}var j=1e-6,on=1e-12,L=Math.PI,Q=L/2,Ht=L/4,H=L*2,Y=180/L,C=L/180,I=Math.abs,jn=Math.atan,pt=Math.atan2,O=Math.cos,$o=Math.ceil,Ei=Math.exp,we=Math.hypot,Mi=Math.log,M=Math.sin,Ri=Math.sign||function(n){return n>0?1:n<0?-1:0},dt=Math.sqrt,Li=Math.tan;function Oi(n){return n>1?0:n<-1?L:Math.acos(n)}function Pt(n){return n>1?Q:n<-1?-Q:Math.asin(n)}function Yo(n){return(n=M(n/2))*n}function A(){}function Vt(n,t){n&&sn.hasOwnProperty(n.type)&&sn[n.type](n,t)}var rn={Feature:function(n,t){Vt(n.geometry,t)},FeatureCollection:function(n,t){for(var i=n.features,e=-1,o=i.length;++e<o;)Vt(i[e].geometry,t)}},sn={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var i=n.coordinates,e=-1,o=i.length;++e<o;)n=i[e],t.point(n[0],n[1],n[2])},LineString:function(n,t){be(n.coordinates,t,0)},MultiLineString:function(n,t){for(var i=n.coordinates,e=-1,o=i.length;++e<o;)be(i[e],t,0)},Polygon:function(n,t){an(n.coordinates,t)},MultiPolygon:function(n,t){for(var i=n.coordinates,e=-1,o=i.length;++e<o;)an(i[e],t)},GeometryCollection:function(n,t){for(var i=n.geometries,e=-1,o=i.length;++e<o;)Vt(i[e],t)}};function be(n,t,i){var e=-1,o=n.length-i,r;for(t.lineStart();++e<o;)r=n[e],t.point(r[0],r[1],r[2]);t.lineEnd()}function an(n,t){var i=-1,e=n.length;for(t.polygonStart();++i<e;)be(n[i],t,1);t.polygonEnd()}function ht(n,t){n&&rn.hasOwnProperty(n.type)?rn[n.type](n,t):Vt(n,t)}var Ut=new q,Qt=new q,Tn,In,Se,De,xe,st={point:A,lineStart:A,lineEnd:A,polygonStart:function(){Ut=new q,st.lineStart=Ni,st.lineEnd=zi},polygonEnd:function(){var n=+Ut;Qt.add(n<0?H+n:n),this.lineStart=this.lineEnd=this.point=A},sphere:function(){Qt.add(H)}};function Ni(){st.point=ji}function zi(){Gn(Tn,In)}function ji(n,t){st.point=Gn,Tn=n,In=t,n*=C,t*=C,Se=n,De=O(t=t/2+Ht),xe=M(t)}function Gn(n,t){n*=C,t*=C,t=t/2+Ht;var i=n-Se,e=i>=0?1:-1,o=e*i,r=O(t),s=M(t),a=xe*s,u=De*r+a*O(o),h=a*e*M(o);Ut.add(pt(h,u)),Se=n,De=r,xe=s}function Bn(n){return Qt=new q,ht(n,st),Qt*2}function Kt(n){return[pt(n[1],n[0]),Pt(n[2])]}function wt(n){var t=n[0],i=n[1],e=O(i);return[e*O(t),e*M(t),M(i)]}function Xt(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function Et(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function me(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function kt(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function te(n){var t=dt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}var G,U,B,tt,yt,$n,Yn,Ct,Tt,gt,ft,ut={point:Ce,lineStart:ln,lineEnd:un,polygonStart:function(){ut.point=kn,ut.lineStart=Ti,ut.lineEnd=Ii,Tt=new q,st.polygonStart()},polygonEnd:function(){st.polygonEnd(),ut.point=Ce,ut.lineStart=ln,ut.lineEnd=un,Ut<0?(G=-(B=180),U=-(tt=90)):Tt>j?tt=90:Tt<-1e-6&&(U=-90),ft[0]=G,ft[1]=B},sphere:function(){G=-(B=180),U=-(tt=90)}};function Ce(n,t){gt.push(ft=[G=n,B=n]),t<U&&(U=t),t>tt&&(tt=t)}function Xn(n,t){var i=wt([n*C,t*C]);if(Ct){var e=Et(Ct,i),o=[e[1],-e[0],0],r=Et(o,e);te(r),r=Kt(r);var s=n-yt,a=s>0?1:-1,u=r[0]*Y*a,h,l=I(s)>180;l^(a*yt<u&&u<a*n)?(h=r[1]*Y,h>tt&&(tt=h)):(u=(u+360)%360-180,l^(a*yt<u&&u<a*n)?(h=-r[1]*Y,h<U&&(U=h)):(t<U&&(U=t),t>tt&&(tt=t))),l?n<yt?K(G,n)>K(G,B)&&(B=n):K(n,B)>K(G,B)&&(G=n):B>=G?(n<G&&(G=n),n>B&&(B=n)):n>yt?K(G,n)>K(G,B)&&(B=n):K(n,B)>K(G,B)&&(G=n)}else gt.push(ft=[G=n,B=n]);t<U&&(U=t),t>tt&&(tt=t),Ct=i,yt=n}function ln(){ut.point=Xn}function un(){ft[0]=G,ft[1]=B,ut.point=Ce,Ct=null}function kn(n,t){if(Ct){var i=n-yt;Tt.add(I(i)>180?i+(i>0?360:-360):i)}else $n=n,Yn=t;st.point(n,t),Xn(n,t)}function Ti(){st.lineStart()}function Ii(){kn($n,Yn),st.lineEnd(),I(Tt)>j&&(G=-(B=180)),ft[0]=G,ft[1]=B,Ct=null}function K(n,t){return(t-=n)<0?t+360:t}function Gi(n,t){return n[0]-t[0]}function hn(n,t){return n[0]<=n[1]?n[0]<=t&&t<=n[1]:t<n[0]||n[1]<t}function Bi(n){var t,i,e,o,r,s,a;if(tt=B=-(G=U=1/0),gt=[],ht(n,ut),i=gt.length){for(gt.sort(Gi),t=1,e=gt[0],r=[e];t<i;++t)o=gt[t],hn(e,o[0])||hn(e,o[1])?(K(e[0],o[1])>K(e[0],e[1])&&(e[1]=o[1]),K(o[0],e[1])>K(e[0],e[1])&&(e[0]=o[0])):r.push(e=o);for(s=-1/0,i=r.length-1,t=0,e=r[i];t<=i;e=o,++t)o=r[t],(a=K(e[1],o[0]))>s&&(s=a,G=o[0],B=e[1])}return gt=ft=null,G===1/0||U===1/0?[[NaN,NaN],[NaN,NaN]]:[[G,U],[B,tt]]}var Lt,ee,ne,ie,oe,re,se,ae,Ee,Me,Re,Zn,An,F,W,J,it={sphere:A,point:Fe,lineStart:cn,lineEnd:fn,polygonStart:function(){it.lineStart=Xi,it.lineEnd=ki},polygonEnd:function(){it.lineStart=cn,it.lineEnd=fn}};function Fe(n,t){n*=C,t*=C;var i=O(t);Bt(i*O(n),i*M(n),M(t))}function Bt(n,t,i){++Lt,ne+=(n-ne)/Lt,ie+=(t-ie)/Lt,oe+=(i-oe)/Lt}function cn(){it.point=$i}function $i(n,t){n*=C,t*=C;var i=O(t);F=i*O(n),W=i*M(n),J=M(t),it.point=Yi,Bt(F,W,J)}function Yi(n,t){n*=C,t*=C;var i=O(t),e=i*O(n),o=i*M(n),r=M(t),s=pt(dt((s=W*r-J*o)*s+(s=J*e-F*r)*s+(s=F*o-W*e)*s),F*e+W*o+J*r);ee+=s,re+=s*(F+(F=e)),se+=s*(W+(W=o)),ae+=s*(J+(J=r)),Bt(F,W,J)}function fn(){it.point=Fe}function Xi(){it.point=Zi}function ki(){Fn(Zn,An),it.point=Fe}function Zi(n,t){Zn=n,An=t,n*=C,t*=C,it.point=Fn;var i=O(t);F=i*O(n),W=i*M(n),J=M(t),Bt(F,W,J)}function Fn(n,t){n*=C,t*=C;var i=O(t),e=i*O(n),o=i*M(n),r=M(t),s=W*r-J*o,a=J*e-F*r,u=F*o-W*e,h=we(s,a,u),l=Pt(h),c=h&&-l/h;Ee.add(c*s),Me.add(c*a),Re.add(c*u),ee+=l,re+=l*(F+(F=e)),se+=l*(W+(W=o)),ae+=l*(J+(J=r)),Bt(F,W,J)}function Ai(n){Lt=ee=ne=ie=oe=re=se=ae=0,Ee=new q,Me=new q,Re=new q,ht(n,it);var t=+Ee,i=+Me,e=+Re,o=we(t,i,e);return o<on&&(t=re,i=se,e=ae,ee<j&&(t=ne,i=ie,e=oe),o=we(t,i,e),o<on)?[NaN,NaN]:[pt(i,t)*Y,Pt(e/o)*Y]}function Dt(n){return function(){return n}}function Le(n,t){function i(e,o){return e=n(e,o),t(e[0],e[1])}return n.invert&&t.invert&&(i.invert=function(e,o){return e=t.invert(e,o),e&&n.invert(e[0],e[1])}),i}function Oe(n,t){return I(n)>L&&(n-=Math.round(n/H)*H),[n,t]}Oe.invert=Oe;function We(n,t,i){return(n%=H)?t||i?Le(pn(n),dn(t,i)):pn(n):t||i?dn(t,i):Oe}function gn(n){return function(t,i){return t+=n,I(t)>L&&(t-=Math.round(t/H)*H),[t,i]}}function pn(n){var t=gn(n);return t.invert=gn(-n),t}function dn(n,t){var i=O(n),e=M(n),o=O(t),r=M(t);function s(a,u){var h=O(u),l=O(a)*h,c=M(a)*h,f=M(u),g=f*i+l*e;return[pt(c*o-g*r,l*i-f*e),Pt(g*o+c*r)]}return s.invert=function(a,u){var h=O(u),l=O(a)*h,c=M(a)*h,f=M(u),g=f*o-c*r;return[pt(c*o+f*r,l*i+g*e),Pt(g*i-l*e)]},s}function Fi(n){n=We(n[0]*C,n[1]*C,n.length>2?n[2]*C:0);function t(i){return i=n(i[0]*C,i[1]*C),i[0]*=Y,i[1]*=Y,i}return t.invert=function(i){return i=n.invert(i[0]*C,i[1]*C),i[0]*=Y,i[1]*=Y,i},t}function Wn(n,t,i,e,o,r){if(i){var s=O(t),a=M(t),u=e*i;o==null?(o=t+e*H,r=t-u/2):(o=mn(s,o),r=mn(s,r),(e>0?o<r:o>r)&&(o+=e*H));for(var h,l=o;e>0?l>r:l<r;l-=u)h=Kt([s,-a*O(l),-a*M(l)]),n.point(h[0],h[1])}}function mn(n,t){t=wt(t),t[0]-=n,te(t);var i=Oi(-t[1]);return((-t[2]<0?-i:i)+H-j)%H}function Wi(){var n=Dt([0,0]),t=Dt(90),i=Dt(2),e,o,r={point:s};function s(u,h){e.push(u=o(u,h)),u[0]*=Y,u[1]*=Y}function a(){var u=n.apply(this,arguments),h=t.apply(this,arguments)*C,l=i.apply(this,arguments)*C;return e=[],o=We(-u[0]*C,-u[1]*C,0).invert,Wn(r,h,l,1),u={type:"Polygon",coordinates:[e]},e=o=null,u}return a.center=function(u){return arguments.length?(n=typeof u=="function"?u:Dt([+u[0],+u[1]]),a):n},a.radius=function(u){return arguments.length?(t=typeof u=="function"?u:Dt(+u),a):t},a.precision=function(u){return arguments.length?(i=typeof u=="function"?u:Dt(+u),a):i},a}function Jn(){var n=[],t;return{point:function(i,e,o){t.push([i,e,o])},lineStart:function(){n.push(t=[])},lineEnd:A,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var i=n;return n=[],t=null,i}}}function Jt(n,t){return I(n[0]-t[0])<j&&I(n[1]-t[1])<j}function Zt(n,t,i,e){this.x=n,this.z=t,this.o=i,this.e=e,this.v=!1,this.n=this.p=null}function qn(n,t,i,e,o){var r=[],s=[],a,u;if(n.forEach(function(p){if(!((d=p.length-1)<=0)){var d,y=p[0],v=p[d],P;if(Jt(y,v)){if(!y[2]&&!v[2]){for(o.lineStart(),a=0;a<d;++a)o.point((y=p[a])[0],y[1]);o.lineEnd();return}v[0]+=2*j}r.push(P=new Zt(y,p,null,!0)),s.push(P.o=new Zt(y,null,P,!1)),r.push(P=new Zt(v,p,null,!1)),s.push(P.o=new Zt(v,null,P,!0))}}),!!r.length){for(s.sort(t),yn(r),yn(s),a=0,u=s.length;a<u;++a)s[a].e=i=!i;for(var h=r[0],l,c;;){for(var f=h,g=!0;f.v;)if((f=f.n)===h)return;l=f.z,o.lineStart();do{if(f.v=f.o.v=!0,f.e){if(g)for(a=0,u=l.length;a<u;++a)o.point((c=l[a])[0],c[1]);else e(f.x,f.n.x,1,o);f=f.n}else{if(g)for(l=f.p.z,a=l.length-1;a>=0;--a)o.point((c=l[a])[0],c[1]);else e(f.x,f.p.x,-1,o);f=f.p}f=f.o,l=f.z,g=!g}while(!f.v);o.lineEnd()}}}function yn(n){if(t=n.length){for(var t,i=0,e=n[0],o;++i<t;)e.n=o=n[i],o.p=e,e=o;e.n=o=n[0],o.p=e}}function ye(n){return I(n[0])<=L?n[0]:Ri(n[0])*((I(n[0])+L)%H-L)}function Ji(n,t){var i=ye(t),e=t[1],o=M(e),r=[M(i),-O(i),0],s=0,a=0,u=new q;o===1?e=Q+j:o===-1&&(e=-Q-j);for(var h=0,l=n.length;h<l;++h)if(f=(c=n[h]).length)for(var c,f,g=c[f-1],p=ye(g),d=g[1]/2+Ht,y=M(d),v=O(d),P=0;P<f;++P,p=w,y=D,v=N,g=_){var _=c[P],w=ye(_),S=_[1]/2+Ht,D=M(S),N=O(S),x=w-p,R=x>=0?1:-1,z=R*x,b=z>L,k=y*D;if(u.add(pt(k*R*M(z),v*N+k*O(z))),s+=b?x+R*H:x,b^p>=i^w>=i){var $=Et(wt(g),wt(_));te($);var T=Et(r,$);te(T);var m=(b^x>=0?-1:1)*Pt(T[2]);(e>m||e===m&&($[0]||$[1]))&&(a+=b^x>=0?1:-1)}}return(s<-1e-6||s<j&&u<-1e-12)^a&1}function Hn(n,t,i,e){return function(o){var r=t(o),s=Jn(),a=t(s),u=!1,h,l,c,f={point:g,lineStart:d,lineEnd:y,polygonStart:function(){f.point=v,f.lineStart=P,f.lineEnd=_,l=[],h=[]},polygonEnd:function(){f.point=g,f.lineStart=d,f.lineEnd=y,l=zn(l);var w=Ji(h,e);l.length?(u||(o.polygonStart(),u=!0),qn(l,Hi,w,i,o)):w&&(u||(o.polygonStart(),u=!0),o.lineStart(),i(null,null,1,o),o.lineEnd()),u&&(o.polygonEnd(),u=!1),l=h=null},sphere:function(){o.polygonStart(),o.lineStart(),i(null,null,1,o),o.lineEnd(),o.polygonEnd()}};function g(w,S){n(w,S)&&o.point(w,S)}function p(w,S){r.point(w,S)}function d(){f.point=p,r.lineStart()}function y(){f.point=g,r.lineEnd()}function v(w,S){c.push([w,S]),a.point(w,S)}function P(){a.lineStart(),c=[]}function _(){v(c[0][0],c[0][1]),a.lineEnd();var w=a.clean(),S=s.result(),D,N=S.length,x,R,z;if(c.pop(),h.push(c),c=null,!!N){if(w&1){if(R=S[0],(x=R.length-1)>0){for(u||(o.polygonStart(),u=!0),o.lineStart(),D=0;D<x;++D)o.point((z=R[D])[0],z[1]);o.lineEnd()}return}N>1&&w&2&&S.push(S.pop().concat(S.shift())),l.push(S.filter(qi))}}return f}}function qi(n){return n.length>1}function Hi(n,t){return((n=n.x)[0]<0?n[1]-Q-j:Q-n[1])-((t=t.x)[0]<0?t[1]-Q-j:Q-t[1])}const vn=Hn(function(){return!0},Vi,Qi,[-L,-Q]);function Vi(n){var t=NaN,i=NaN,e=NaN,o;return{lineStart:function(){n.lineStart(),o=1},point:function(r,s){var a=r>0?L:-L,u=I(r-t);I(u-L)<j?(n.point(t,i=(i+s)/2>0?Q:-Q),n.point(e,i),n.lineEnd(),n.lineStart(),n.point(a,i),n.point(r,i),o=0):e!==a&&u>=L&&(I(t-e)<j&&(t-=e*j),I(r-a)<j&&(r-=a*j),i=Ui(t,i,r,s),n.point(e,i),n.lineEnd(),n.lineStart(),n.point(a,i),o=0),n.point(t=r,i=s),e=a},lineEnd:function(){n.lineEnd(),t=i=NaN},clean:function(){return 2-o}}}function Ui(n,t,i,e){var o,r,s=M(n-i);return I(s)>j?jn((M(t)*(r=O(e))*M(i)-M(e)*(o=O(t))*M(n))/(o*r*s)):(t+e)/2}function Qi(n,t,i,e){var o;if(n==null)o=i*Q,e.point(-L,o),e.point(0,o),e.point(L,o),e.point(L,0),e.point(L,-o),e.point(0,-o),e.point(-L,-o),e.point(-L,0),e.point(-L,o);else if(I(n[0]-t[0])>j){var r=n[0]<t[0]?L:-L;o=i*r/2,e.point(-r,o),e.point(0,o),e.point(r,o)}else e.point(t[0],t[1])}function Ki(n){var t=O(n),i=2*C,e=t>0,o=I(t)>j;function r(l,c,f,g){Wn(g,n,i,f,l,c)}function s(l,c){return O(l)*O(c)>t}function a(l){var c,f,g,p,d;return{lineStart:function(){p=g=!1,d=1},point:function(y,v){var P=[y,v],_,w=s(y,v),S=e?w?0:h(y,v):w?h(y+(y<0?L:-L),v):0;if(!c&&(p=g=w)&&l.lineStart(),w!==g&&(_=u(c,P),(!_||Jt(c,_)||Jt(P,_))&&(P[2]=1)),w!==g)d=0,w?(l.lineStart(),_=u(P,c),l.point(_[0],_[1])):(_=u(c,P),l.point(_[0],_[1],2),l.lineEnd()),c=_;else if(o&&c&&e^w){var D;!(S&f)&&(D=u(P,c,!0))&&(d=0,e?(l.lineStart(),l.point(D[0][0],D[0][1]),l.point(D[1][0],D[1][1]),l.lineEnd()):(l.point(D[1][0],D[1][1]),l.lineEnd(),l.lineStart(),l.point(D[0][0],D[0][1],3)))}w&&(!c||!Jt(c,P))&&l.point(P[0],P[1]),c=P,g=w,f=S},lineEnd:function(){g&&l.lineEnd(),c=null},clean:function(){return d|(p&&g)<<1}}}function u(l,c,f){var g=wt(l),p=wt(c),d=[1,0,0],y=Et(g,p),v=Xt(y,y),P=y[0],_=v-P*P;if(!_)return!f&&l;var w=t*v/_,S=-t*P/_,D=Et(d,y),N=kt(d,w),x=kt(y,S);me(N,x);var R=D,z=Xt(N,R),b=Xt(R,R),k=z*z-b*(Xt(N,N)-1);if(!(k<0)){var $=dt(k),T=kt(R,(-z-$)/b);if(me(T,N),T=Kt(T),!f)return T;var m=l[0],E=c[0],X=l[1],V=c[1],et;E<m&&(et=m,m=E,E=et);var Rt=E-m,at=I(Rt-L)<j,mt=at||Rt<j;if(!at&&V<X&&(et=X,X=V,V=et),mt?at?X+V>0^T[1]<(I(T[0]-m)<j?X:V):X<=T[1]&&T[1]<=V:Rt>L^(m<=T[0]&&T[0]<=E)){var lt=kt(R,(-z+$)/b);return me(lt,N),[T,Kt(lt)]}}}function h(l,c){var f=e?n:L-n,g=0;return l<-f?g|=1:l>f&&(g|=2),c<-f?g|=4:c>f&&(g|=8),g}return Hn(s,a,r,e?[0,-n]:[-L,n-L])}function to(n,t,i,e,o,r){var s=n[0],a=n[1],u=t[0],h=t[1],l=0,c=1,f=u-s,g=h-a,p;if(p=i-s,!(!f&&p>0)){if(p/=f,f<0){if(p<l)return;p<c&&(c=p)}else if(f>0){if(p>c)return;p>l&&(l=p)}if(p=o-s,!(!f&&p<0)){if(p/=f,f<0){if(p>c)return;p>l&&(l=p)}else if(f>0){if(p<l)return;p<c&&(c=p)}if(p=e-a,!(!g&&p>0)){if(p/=g,g<0){if(p<l)return;p<c&&(c=p)}else if(g>0){if(p>c)return;p>l&&(l=p)}if(p=r-a,!(!g&&p<0)){if(p/=g,g<0){if(p>c)return;p>l&&(l=p)}else if(g>0){if(p<l)return;p<c&&(c=p)}return l>0&&(n[0]=s+l*f,n[1]=a+l*g),c<1&&(t[0]=s+c*f,t[1]=a+c*g),!0}}}}}var At=1e9,Ft=-1e9;function eo(n,t,i,e){function o(h,l){return n<=h&&h<=i&&t<=l&&l<=e}function r(h,l,c,f){var g=0,p=0;if(h==null||(g=s(h,c))!==(p=s(l,c))||u(h,l)<0^c>0)do f.point(g===0||g===3?n:i,g>1?e:t);while((g=(g+c+4)%4)!==p);else f.point(l[0],l[1])}function s(h,l){return I(h[0]-n)<j?l>0?0:3:I(h[0]-i)<j?l>0?2:1:I(h[1]-t)<j?l>0?1:0:l>0?3:2}function a(h,l){return u(h.x,l.x)}function u(h,l){var c=s(h,1),f=s(l,1);return c!==f?c-f:c===0?l[1]-h[1]:c===1?h[0]-l[0]:c===2?h[1]-l[1]:l[0]-h[0]}return function(h){var l=h,c=Jn(),f,g,p,d,y,v,P,_,w,S,D,N={point:x,lineStart:k,lineEnd:$,polygonStart:z,polygonEnd:b};function x(m,E){o(m,E)&&l.point(m,E)}function R(){for(var m=0,E=0,X=g.length;E<X;++E)for(var V=g[E],et=1,Rt=V.length,at=V[0],mt,lt,$t=at[0],St=at[1];et<Rt;++et)mt=$t,lt=St,at=V[et],$t=at[0],St=at[1],lt<=e?St>e&&($t-mt)*(e-lt)>(St-lt)*(n-mt)&&++m:St<=e&&($t-mt)*(e-lt)<(St-lt)*(n-mt)&&--m;return m}function z(){l=c,f=[],g=[],D=!0}function b(){var m=R(),E=D&&m,X=(f=zn(f)).length;(E||X)&&(h.polygonStart(),E&&(h.lineStart(),r(null,null,1,h),h.lineEnd()),X&&qn(f,a,m,r,h),h.polygonEnd()),l=h,f=g=p=null}function k(){N.point=T,g&&g.push(p=[]),S=!0,w=!1,P=_=NaN}function $(){f&&(T(d,y),v&&w&&c.rejoin(),f.push(c.result())),N.point=x,w&&l.lineEnd()}function T(m,E){var X=o(m,E);if(g&&p.push([m,E]),S)d=m,y=E,v=X,S=!1,X&&(l.lineStart(),l.point(m,E));else if(X&&w)l.point(m,E);else{var V=[P=Math.max(Ft,Math.min(At,P)),_=Math.max(Ft,Math.min(At,_))],et=[m=Math.max(Ft,Math.min(At,m)),E=Math.max(Ft,Math.min(At,E))];to(V,et,n,t,i,e)?(w||(l.lineStart(),l.point(V[0],V[1])),l.point(et[0],et[1]),X||l.lineEnd(),D=!1):X&&(l.lineStart(),l.point(m,E),D=!1)}P=m,_=E,w=X}return N}}const Ne=n=>n;var ve=new q,ze=new q,Vn,Un,je,Te,ct={point:A,lineStart:A,lineEnd:A,polygonStart:function(){ct.lineStart=no,ct.lineEnd=oo},polygonEnd:function(){ct.lineStart=ct.lineEnd=ct.point=A,ve.add(I(ze)),ze=new q},result:function(){var n=ve/2;return ve=new q,n}};function no(){ct.point=io}function io(n,t){ct.point=Qn,Vn=je=n,Un=Te=t}function Qn(n,t){ze.add(Te*n-je*t),je=n,Te=t}function oo(){Qn(Vn,Un)}var Mt=1/0,le=Mt,It=-Mt,ue=It,he={point:ro,lineStart:A,lineEnd:A,polygonStart:A,polygonEnd:A,result:function(){var n=[[Mt,le],[It,ue]];return It=ue=-(le=Mt=1/0),n}};function ro(n,t){n<Mt&&(Mt=n),n>It&&(It=n),t<le&&(le=t),t>ue&&(ue=t)}var Ie=0,Ge=0,Ot=0,ce=0,fe=0,xt=0,Be=0,$e=0,Nt=0,Kn,ti,ot,rt,nt={point:bt,lineStart:_n,lineEnd:Pn,polygonStart:function(){nt.lineStart=lo,nt.lineEnd=uo},polygonEnd:function(){nt.point=bt,nt.lineStart=_n,nt.lineEnd=Pn},result:function(){var n=Nt?[Be/Nt,$e/Nt]:xt?[ce/xt,fe/xt]:Ot?[Ie/Ot,Ge/Ot]:[NaN,NaN];return Ie=Ge=Ot=ce=fe=xt=Be=$e=Nt=0,n}};function bt(n,t){Ie+=n,Ge+=t,++Ot}function _n(){nt.point=so}function so(n,t){nt.point=ao,bt(ot=n,rt=t)}function ao(n,t){var i=n-ot,e=t-rt,o=dt(i*i+e*e);ce+=o*(ot+n)/2,fe+=o*(rt+t)/2,xt+=o,bt(ot=n,rt=t)}function Pn(){nt.point=bt}function lo(){nt.point=ho}function uo(){ei(Kn,ti)}function ho(n,t){nt.point=ei,bt(Kn=ot=n,ti=rt=t)}function ei(n,t){var i=n-ot,e=t-rt,o=dt(i*i+e*e);ce+=o*(ot+n)/2,fe+=o*(rt+t)/2,xt+=o,o=rt*n-ot*t,Be+=o*(ot+n),$e+=o*(rt+t),Nt+=o*3,bt(ot=n,rt=t)}function ni(n){this._context=n}ni.prototype={_radius:4.5,pointRadius:function(n){return this._radius=n,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(n,t){switch(this._point){case 0:{this._context.moveTo(n,t),this._point=1;break}case 1:{this._context.lineTo(n,t);break}default:{this._context.moveTo(n+this._radius,t),this._context.arc(n,t,this._radius,0,H);break}}},result:A};var Ye=new q,_e,ii,oi,zt,jt,Gt={point:A,lineStart:function(){Gt.point=co},lineEnd:function(){_e&&ri(ii,oi),Gt.point=A},polygonStart:function(){_e=!0},polygonEnd:function(){_e=null},result:function(){var n=+Ye;return Ye=new q,n}};function co(n,t){Gt.point=ri,ii=zt=n,oi=jt=t}function ri(n,t){zt-=n,jt-=t,Ye.add(dt(zt*zt+jt*jt)),zt=n,jt=t}let wn,ge,bn,Sn;class Dn{constructor(t){this._append=t==null?si:fo(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,i){switch(this._point){case 0:{this._append`M${t},${i}`,this._point=1;break}case 1:{this._append`L${t},${i}`;break}default:{if(this._append`M${t},${i}`,this._radius!==bn||this._append!==ge){const e=this._radius,o=this._;this._="",this._append`m0,${e}a${e},${e} 0 1,1 0,${-2*e}a${e},${e} 0 1,1 0,${2*e}z`,bn=e,ge=this._append,Sn=this._,this._=o}this._+=Sn;break}}}result(){const t=this._;return this._="",t.length?t:null}}function si(n){let t=1;this._+=n[0];for(const i=n.length;t<i;++t)this._+=arguments[t]+n[t]}function fo(n){const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);if(t>15)return si;if(t!==wn){const i=10**t;wn=t,ge=function(o){let r=1;this._+=o[0];for(const s=o.length;r<s;++r)this._+=Math.round(arguments[r]*i)/i+o[r]}}return ge}function go(n,t){let i=3,e=4.5,o,r;function s(a){return a&&(typeof e=="function"&&r.pointRadius(+e.apply(this,arguments)),ht(a,o(r))),r.result()}return s.area=function(a){return ht(a,o(ct)),ct.result()},s.measure=function(a){return ht(a,o(Gt)),Gt.result()},s.bounds=function(a){return ht(a,o(he)),he.result()},s.centroid=function(a){return ht(a,o(nt)),nt.result()},s.projection=function(a){return arguments.length?(o=a==null?(n=null,Ne):(n=a).stream,s):n},s.context=function(a){return arguments.length?(r=a==null?(t=null,new Dn(i)):new ni(t=a),typeof e!="function"&&r.pointRadius(e),s):t},s.pointRadius=function(a){return arguments.length?(e=typeof a=="function"?a:(r.pointRadius(+a),+a),s):e},s.digits=function(a){if(!arguments.length)return i;if(a==null)i=null;else{const u=Math.floor(a);if(!(u>=0))throw new RangeError(`invalid digits: ${a}`);i=u}return t===null&&(r=new Dn(i)),s},s.projection(n).digits(i).context(t)}function Je(n){return function(t){var i=new Xe;for(var e in n)i[e]=n[e];return i.stream=t,i}}function Xe(){}Xe.prototype={constructor:Xe,point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function qe(n,t,i){var e=n.clipExtent&&n.clipExtent();return n.scale(150).translate([0,0]),e!=null&&n.clipExtent(null),ht(i,n.stream(he)),t(he.result()),e!=null&&n.clipExtent(e),n}function ai(n,t,i){return qe(n,function(e){var o=t[1][0]-t[0][0],r=t[1][1]-t[0][1],s=Math.min(o/(e[1][0]-e[0][0]),r/(e[1][1]-e[0][1])),a=+t[0][0]+(o-s*(e[1][0]+e[0][0]))/2,u=+t[0][1]+(r-s*(e[1][1]+e[0][1]))/2;n.scale(150*s).translate([a,u])},i)}function po(n,t,i){return ai(n,[[0,0],t],i)}function mo(n,t,i){return qe(n,function(e){var o=+t,r=o/(e[1][0]-e[0][0]),s=(o-r*(e[1][0]+e[0][0]))/2,a=-r*e[0][1];n.scale(150*r).translate([s,a])},i)}function yo(n,t,i){return qe(n,function(e){var o=+t,r=o/(e[1][1]-e[0][1]),s=-r*e[0][0],a=(o-r*(e[1][1]+e[0][1]))/2;n.scale(150*r).translate([s,a])},i)}var xn=16,vo=O(30*C);function Cn(n,t){return+t?Po(n,t):_o(n)}function _o(n){return Je({point:function(t,i){t=n(t,i),this.stream.point(t[0],t[1])}})}function Po(n,t){function i(e,o,r,s,a,u,h,l,c,f,g,p,d,y){var v=h-e,P=l-o,_=v*v+P*P;if(_>4*t&&d--){var w=s+f,S=a+g,D=u+p,N=dt(w*w+S*S+D*D),x=Pt(D/=N),R=I(I(D)-1)<j||I(r-c)<j?(r+c)/2:pt(S,w),z=n(R,x),b=z[0],k=z[1],$=b-e,T=k-o,m=P*$-v*T;(m*m/_>t||I((v*$+P*T)/_-.5)>.3||s*f+a*g+u*p<vo)&&(i(e,o,r,s,a,u,b,k,R,w/=N,S/=N,D,d,y),y.point(b,k),i(b,k,R,w,S,D,h,l,c,f,g,p,d,y))}}return function(e){var o,r,s,a,u,h,l,c,f,g,p,d,y={point:v,lineStart:P,lineEnd:w,polygonStart:function(){e.polygonStart(),y.lineStart=S},polygonEnd:function(){e.polygonEnd(),y.lineStart=P}};function v(x,R){x=n(x,R),e.point(x[0],x[1])}function P(){c=NaN,y.point=_,e.lineStart()}function _(x,R){var z=wt([x,R]),b=n(x,R);i(c,f,l,g,p,d,c=b[0],f=b[1],l=x,g=z[0],p=z[1],d=z[2],xn,e),e.point(c,f)}function w(){y.point=v,e.lineEnd()}function S(){P(),y.point=D,y.lineEnd=N}function D(x,R){_(o=x,R),r=c,s=f,a=g,u=p,h=d,y.point=_}function N(){i(c,f,l,g,p,d,r,s,o,a,u,h,xn,e),y.lineEnd=w,w()}return y}}var wo=Je({point:function(n,t){this.stream.point(n*C,t*C)}});function bo(n){return Je({point:function(t,i){var e=n(t,i);return this.stream.point(e[0],e[1])}})}function So(n,t,i,e,o){function r(s,a){return s*=e,a*=o,[t+n*s,i-n*a]}return r.invert=function(s,a){return[(s-t)/n*e,(i-a)/n*o]},r}function En(n,t,i,e,o,r){if(!r)return So(n,t,i,e,o);var s=O(r),a=M(r),u=s*n,h=a*n,l=s/n,c=a/n,f=(a*i-s*t)/n,g=(a*t+s*i)/n;function p(d,y){return d*=e,y*=o,[u*d-h*y+t,i-h*d-u*y]}return p.invert=function(d,y){return[e*(l*d-c*y+f),o*(g-c*d-l*y)]},p}function Do(n){return xo(function(){return n})()}function xo(n){var t,i=150,e=480,o=250,r=0,s=0,a=0,u=0,h=0,l,c=0,f=1,g=1,p=null,d=vn,y=null,v,P,_,w=Ne,S=.5,D,N,x,R,z;function b(m){return x(m[0]*C,m[1]*C)}function k(m){return m=x.invert(m[0],m[1]),m&&[m[0]*Y,m[1]*Y]}b.stream=function(m){return R&&z===m?R:R=wo(bo(l)(d(D(w(z=m)))))},b.preclip=function(m){return arguments.length?(d=m,p=void 0,T()):d},b.postclip=function(m){return arguments.length?(w=m,y=v=P=_=null,T()):w},b.clipAngle=function(m){return arguments.length?(d=+m?Ki(p=m*C):(p=null,vn),T()):p*Y},b.clipExtent=function(m){return arguments.length?(w=m==null?(y=v=P=_=null,Ne):eo(y=+m[0][0],v=+m[0][1],P=+m[1][0],_=+m[1][1]),T()):y==null?null:[[y,v],[P,_]]},b.scale=function(m){return arguments.length?(i=+m,$()):i},b.translate=function(m){return arguments.length?(e=+m[0],o=+m[1],$()):[e,o]},b.center=function(m){return arguments.length?(r=m[0]%360*C,s=m[1]%360*C,$()):[r*Y,s*Y]},b.rotate=function(m){return arguments.length?(a=m[0]%360*C,u=m[1]%360*C,h=m.length>2?m[2]%360*C:0,$()):[a*Y,u*Y,h*Y]},b.angle=function(m){return arguments.length?(c=m%360*C,$()):c*Y},b.reflectX=function(m){return arguments.length?(f=m?-1:1,$()):f<0},b.reflectY=function(m){return arguments.length?(g=m?-1:1,$()):g<0},b.precision=function(m){return arguments.length?(D=Cn(N,S=m*m),T()):dt(S)},b.fitExtent=function(m,E){return ai(b,m,E)},b.fitSize=function(m,E){return po(b,m,E)},b.fitWidth=function(m,E){return mo(b,m,E)},b.fitHeight=function(m,E){return yo(b,m,E)};function $(){var m=En(i,0,0,f,g,c).apply(null,t(r,s)),E=En(i,e-m[0],o-m[1],f,g,c);return l=We(a,u,h),N=Le(t,E),x=Le(l,N),D=Cn(N,S),T()}function T(){return R=z=null,b}return function(){return t=n.apply(this,arguments),b.invert=t.invert&&k,$()}}function He(n,t){return[n,Mi(Li((Q+t)/2))]}He.invert=function(n,t){return[n,2*jn(Ei(t))-Q]};function Co(){return Eo(He).scale(961/H)}function Eo(n){var t=Do(n),i=t.center,e=t.scale,o=t.translate,r=t.clipExtent,s=null,a,u,h;t.scale=function(c){return arguments.length?(e(c),l()):e()},t.translate=function(c){return arguments.length?(o(c),l()):o()},t.center=function(c){return arguments.length?(i(c),l()):i()},t.clipExtent=function(c){return arguments.length?(c==null?s=a=u=h=null:(s=+c[0][0],a=+c[0][1],u=+c[1][0],h=+c[1][1]),l()):s==null?null:[[s,a],[u,h]]};function l(){var c=L*e(),f=t(Fi(t.rotate()).invert([0,0]));return r(s==null?[[f[0]-c,f[1]-c],[f[0]+c,f[1]+c]]:n===He?[[Math.max(f[0]-c,s),a],[Math.min(f[0]+c,u),h]]:[[s,Math.max(f[1]-c,a)],[u,Math.min(f[1]+c,h)]])}return l()}class Mo extends hi{setupDefaultRules(){super.setupDefaultRules();const t=this._root.interfaceColors,i=this.rule.bind(this);i("MapChart").setAll({projection:Co(),panX:"translateX",panY:"translateY",pinchZoom:!0,zoomStep:2,zoomLevel:1,rotationX:0,rotationY:0,rotationZ:0,maxZoomLevel:32,minZoomLevel:1,wheelY:"zoom",wheelX:"none",animationEasing:Ke(tn),wheelEasing:Ke(tn),wheelDuration:0,wheelSensitivity:1,maxPanOut:.4,centerMapOnZoomOut:!0});{const e=i("MapLine");e.setAll({precision:.5,role:"figure"}),de(e,"stroke",t,"grid")}i("MapPolygonSeries").setAll({affectsBounds:!0}),i("MapPointSeries").setAll({affectsBounds:!1,clipFront:!1,clipBack:!0,autoScale:!1}),i("ClusteredPointSeries").setAll({minDistance:20,scatterDistance:3,scatterRadius:8,stopClusterZoom:.95}),i("MapLineSeries").setAll({affectsBounds:!1});{const e=i("MapPolygon");e.setAll({precision:.5,isMeasured:!1,role:"figure",fillOpacity:1,position:"absolute",strokeWidth:.2,strokeOpacity:1}),de(e,"fill",t,"primaryButton"),de(e,"stroke",t,"background")}i("Button",["zoomtools","home"]).setAll({visible:!1}),i("GraticuleSeries").setAll({step:10})}}function Xo(n,t){return Wi().center([n.longitude,n.latitude]).radius(t)()}function Ve(n){const t=Ai(n);return{longitude:t[0],latitude:t[1]}}function ko(n){return Bn(n)}function qt(n){const t=Bi(n);if(t){const i={left:t[0][0],right:t[1][0],top:t[1][1],bottom:t[0][1]};return i.right<i.left&&(i.right=180,i.left=-180),i}return{left:0,right:0,top:0,bottom:0}}function Zo(n,t,i,e){let o=[];e<=-180&&(e=-179.9999),i<=-90&&(i=-89.9999),n>=90&&(n=89.9999),t>=180&&(t=179.9999);let r=Math.min(90,(t-e)/Math.ceil((t-e)/90)),s=(n-i)/Math.ceil((n-i)/90);for(let a=e;a<t;a=a+r){let u=[];o.push([u]),a+r>t&&(r=t-a);for(let h=a;h<=a+r;h=h+5)u.push([h,n]);for(let h=n;h>=i;h=h-s)u.push([a+r,h]);for(let h=a+r;h>=a;h=h-5)u.push([h,i]);for(let h=i;h<=n;h=h+s)u.push([a,h])}return{type:"MultiPolygon",coordinates:o}}function Ao(n){let t=Pe(n.longitude),i=Math.asin(Math.sin(n.latitude*di))*mi,e=Pe(n.latitude);return Math.abs(e)>90&&(t=Pe(t+180)),n.longitude=t,n.latitude=i,n}function Pe(n){return n=n%360,n>180&&(n-=360),n<-180&&(n+=360),n}class ke extends On{constructor(){super(...arguments),Object.defineProperty(this,"_downTranslateX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_downTranslateY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_downRotationX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_downRotationY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_downRotationZ",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_pLat",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_pLon",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_movePoints",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_downZoomLevel",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_doubleDownDistance",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_dirtyGeometries",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_geometryColection",{enumerable:!0,configurable:!0,writable:!0,value:{type:"GeometryCollection",geometries:[]}}),Object.defineProperty(this,"_centerLocation",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"_za",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_rxa",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_rya",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_txa",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tya",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_mapBounds",{enumerable:!0,configurable:!0,writable:!0,value:[[0,0],[0,0]]}),Object.defineProperty(this,"_geoCentroid",{enumerable:!0,configurable:!0,writable:!0,value:{longitude:0,latitude:0}}),Object.defineProperty(this,"_geoBounds",{enumerable:!0,configurable:!0,writable:!0,value:{left:0,right:0,top:0,bottom:0}}),Object.defineProperty(this,"_prevGeoBounds",{enumerable:!0,configurable:!0,writable:!0,value:{left:0,right:0,top:0,bottom:0}}),Object.defineProperty(this,"_dispatchBounds",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_wheelDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_pw",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_ph",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_mapFitted",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_centerX",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_centerY",{enumerable:!0,configurable:!0,writable:!0,value:0})}_makeGeoPath(){const t=this.get("projection"),i=go();i.projection(t),this.setPrivateRaw("geoPath",i)}geoPoint(){return this.invert(this.seriesContainer.toGlobal({x:this.width()/2,y:this.height()/2}))}geoCentroid(){return this._geoCentroid}geoBounds(){return this._geoBounds}_handleSetWheel(){const t=this.get("wheelX"),i=this.get("wheelY"),e=this.chartContainer;t!="none"||i!="none"?(this._wheelDp&&this._wheelDp.dispose(),this._wheelDp=e.events.on("wheel",o=>{const r=this.get("wheelEasing"),s=this.get("wheelSensitivity",1),a=this.get("wheelDuration",0),u=o.originalEvent;let h=!1;if(yi(u,this))h=!0;else return;const l=e._display.toLocal(o.point);if(i=="zoom"){if(this.get("zoomLevel")==this.get("minZoomLevel",1)&&u.deltaY>0)return;this._handleWheelZoom(u.deltaY,l)}else i=="rotateY"?this._handleWheelRotateY(u.deltaY/5*s,a,r):i=="rotateX"&&this._handleWheelRotateX(u.deltaY/5*s,a,r);t=="zoom"?this._handleWheelZoom(u.deltaX,l):t=="rotateY"?this._handleWheelRotateY(u.deltaX/5*s,a,r):t=="rotateX"&&this._handleWheelRotateX(u.deltaX/5*s,a,r),h&&u.preventDefault()}),this._disposers.push(this._wheelDp)):this._wheelDp&&this._wheelDp.dispose()}_prepareChildren(){super._prepareChildren();const t=this.get("projection"),i=this.innerWidth(),e=this.innerHeight(),o=this._geometryColection.geometries;if(this.isDirty("projection")){this._makeGeoPath(),this.markDirtyProjection(),this._fitMap(),t.scale(this.getPrivate("mapScale")*this.get("zoomLevel",1)),t.rotate&&t.rotate([this.get("rotationX",0),this.get("rotationY",0),this.get("rotationZ",0)]);let r=this._prevSettings.projection;if(r&&r!=t){let s=i/2,a=e/2;if(r.invert){let u=r.invert([s,a]);if(u){let h=t(u);if(h){let l=t.translate(),c=s-(h[0]-l[0]),f=a-(h[1]-l[1]);t.translate([c,f]),this.setRaw("translateX",c),this.setRaw("translateY",f)}}}}}if((this.isDirty("wheelX")||this.isDirty("wheelY"))&&this._handleSetWheel(),this._dirtyGeometries&&(this._geometryColection.geometries=[],this.series.each(r=>{ci(this._geometryColection.geometries,r._geometries)}),this._fitMap()),o.length!=0&&(i!=this._pw||e!=this._ph||this._dirtyGeometries)&&i>0&&e>0){let r=i/2,s=e/2;t.fitSize([i,e],this._geometryColection);const a=t.scale();if(this.setPrivateRaw("mapScale",a),t.scale(a*this.get("zoomLevel",1)),this._centerLocation){let h=t(this._centerLocation);if(h){let l=t.translate(),c=r-(h[0]-l[0]),f=s-(h[1]-l[1]);t.translate([c,f]),this.setRaw("translateX",c),this.setRaw("translateY",f),this._centerX=l[0],this._centerY=l[1]}}this.markDirtyProjection();const u=this.getPrivate("geoPath");this._mapBounds=u.bounds(this._geometryColection)}if(this._pw=i,this._ph=e,this.isDirty("zoomControl")){const r=this._prevSettings.zoomControl,s=this.get("zoomControl");s!==r&&(this._disposeProperty("zoomControl"),r&&r.dispose(),s&&(s.setPrivate("chart",this),this.children.push(s)),this.setRaw("zoomControl",s))}if(this.isDirty("zoomLevel")){t.scale(this.getPrivate("mapScale")*this.get("zoomLevel",1)),this.markDirtyProjection(),this.series.each(s=>{s.isType("MapPointSeries")&&s.get("autoScale")&&Z(s.dataItems,a=>{const u=a.bullets;u&&Z(u,h=>{const l=h.get("sprite");l&&l.set("scale",this.get("zoomLevel"))})})});const r=this.get("zoomControl");if(r){const s=this.get("zoomLevel",1);s==this.get("minZoomLevel",1)?this.root.events.once("frameended",()=>{r.minusButton.set("disabled",!0)}):r.minusButton.set("disabled",!1),s==this.get("maxZoomLevel",32)?r.plusButton.set("disabled",!0):r.plusButton.set("disabled",!1)}}(this.isDirty("translateX")||this.isDirty("translateY"))&&(t.translate([this.get("translateX",this.width()/2),this.get("translateY",this.height()/2)]),this.markDirtyProjection()),t.rotate&&(this.isDirty("rotationX")||this.isDirty("rotationY")||this.isDirty("rotationZ"))&&(t.rotate([this.get("rotationX",0),this.get("rotationY",0),this.get("rotationZ",0)]),this.markDirtyProjection()),(this.isDirty("pinchZoom")||this.get("panX")||this.get("panY"))&&this._setUpTouch()}_fitMap(){const t=this.get("projection");let i=this.innerWidth(),e=this.innerHeight();if(i>0&&e>0){t.fitSize([i,e],this._geometryColection),this.setPrivateRaw("mapScale",t.scale());const o=t.translate();this.setRaw("translateX",o[0]),this.setRaw("translateY",o[1]),this._centerX=o[0],this._centerY=o[1];const r=this.getPrivate("geoPath");this._mapBounds=r.bounds(this._geometryColection),this._geoCentroid=Ve(this._geometryColection);const s=qt(this._geometryColection);if(this._geoBounds=s,this._geometryColection.geometries.length>0){s.left=Yt(this._geoBounds.left,3),s.right=Yt(this._geoBounds.right,3),s.top=Yt(this._geoBounds.top,3),s.bottom=Yt(this._geoBounds.bottom,3);const a=this._prevGeoBounds;a&&!vi(s,a)&&(this._dispatchBounds=!0,this._prevGeoBounds=s)}this._mapFitted=!0}}homeGeoPoint(){let t=this.get("homeGeoPoint");if(!t){const e=this.getPrivate("geoPath").bounds(this._geometryColection),o=e[0][0],r=e[0][1],s=e[1][0],a=e[1][1];t=this.invert({x:o+(s-o)/2,y:r+(a-r)/2})}return t}goHome(t){this.zoomToGeoPoint(this.homeGeoPoint(),this.get("homeZoomLevel",1),!0,t,this.get("homeRotationX"),this.get("homeRotationY"))}_updateChildren(){const t=this.get("projection");if(t.invert){let i=this.innerWidth(),e=this.innerHeight();i>0&&e>0&&(this._centerLocation=t.invert([this.innerWidth()/2,this.innerHeight()/2]))}super._updateChildren()}_afterChanged(){if(super._afterChanged(),this._dispatchBounds){this._dispatchBounds=!1;const t="geoboundschanged";this.events.isEnabled(t)&&this.events.dispatch(t,{type:t,target:this})}}_setUpTouch(){this.chartContainer._display.cancelTouch||(this.chartContainer._display.cancelTouch=!!(this.get("pinchZoom")||this.get("panX")||this.get("panY")))}markDirtyGeometries(){this._dirtyGeometries=!0,this.markDirty()}markDirtyProjection(){this.series.each(t=>{t.markDirtyProjection()})}_afterNew(){this._defaultThemes.push(Mo.new(this._root)),this._settings.themeTags=_i(this._settings.themeTags,["map"]),this.children.push(this.bulletsContainer),super._afterNew(),this._makeGeoPath(),this.chartContainer.children.push(this.seriesContainer),this.get("translateX")==null&&this.set("translateX",this.width()/2),this.get("translateY")==null&&this.set("translateY",this.height()/2),this.chartContainer.set("interactive",!0),this.chartContainer.set("interactiveChildren",!1),this.chartContainer.set("background",Pi.new(this._root,{themeTags:["map","background"],fill:wi.fromHex(0),fillOpacity:0})),this._disposers.push(this.chartContainer.events.on("pointerdown",i=>{this._handleChartDown(i)})),this._disposers.push(this.chartContainer.events.on("globalpointerup",i=>{this._handleChartUp(i)})),this._disposers.push(this.chartContainer.events.on("globalpointermove",i=>{this._handleChartMove(i)}));let t=!1;for(let i=0;i<en.licenses.length;i++)en.licenses[i].match(/^AM5M.{5,}/i)&&(t=!0);t?this._root._licenseApplied():this._root._showBranding(),this._setUpTouch()}_handleChartDown(t){this._downZoomLevel=this.get("zoomLevel",1);const i=this.chartContainer._downPoints;let e=Qe(i).length;if(e==1){let o=i[1];o||(o=i[0]),o&&o.x==t.point.x&&o.y==t.point.y&&(e=0)}if(e>0){this._downTranslateX=this.get("translateX"),this._downTranslateY=this.get("translateY"),this._downRotationX=this.get("rotationX"),this._downRotationY=this.get("rotationY"),this._downRotationZ=this.get("rotationZ");const o=this.chartContainer._getDownPointId();if(o){let r=this._movePoints[o];r&&(this.chartContainer._downPoints[o]=r)}}else if(e==0){let o=this.chartContainer.get("background");if(o&&o.events.enableType("click"),this.get("panX")||this.get("panY")){this._za&&this._za.stop(),this._txa&&this._txa.stop(),this._tya&&this._tya.stop(),this._rxa&&this._rxa.stop(),this._rya&&this._rya.stop();const r=this.chartContainer._display.toLocal(t.point);this._downTranslateX=this.get("translateX"),this._downTranslateY=this.get("translateY"),this._downRotationX=this.get("rotationX"),this._downRotationY=this.get("rotationY"),this._downRotationZ=this.get("rotationZ");let s=this.get("projection");if(s.invert){let a=s.invert([r.x,r.y]),u=s.invert([r.x+1,r.y+1]);a&&u&&(this._pLon=Math.abs(u[0]-a[0]),this._pLat=Math.abs(u[1]-a[1]))}}}}invert(t){let i=this.get("projection");if(i.invert){const e=i.invert([t.x,t.y]);if(e)return{longitude:e[0],latitude:e[1]}}return{longitude:0,latitude:0}}convert(t,i,e){let o=this.get("projection"),r;if(o.rotate||(i=void 0,e=void 0),i!=null||e!=null){i==null&&(i=0),e==null&&(e=0);let s=o.rotate();o.rotate([i,e,0]),r=o([t.longitude,t.latitude]),o.rotate(s)}else r=o([t.longitude,t.latitude]);return r?{x:r[0],y:r[1]}:{x:0,y:0}}_handleChartUp(t){this.chartContainer._downPoints={}}_handlePinch(){const t=this.chartContainer;let i=0,e=[],o=[];if(fi(t._downPoints,(r,s)=>{e[i]=s;let a=this._movePoints[r];a&&(o[i]=a),i++}),e.length>1&&o.length>1){const r=t._display;let s=e[0],a=e[1],u=o[0],h=o[1];if(s&&a&&u&&h){s=r.toLocal(s),a=r.toLocal(a),u=r.toLocal(u),h=r.toLocal(h);let l=Math.hypot(a.x-s.x,a.y-s.y),f=Math.hypot(h.x-u.x,h.y-u.y)/l*this._downZoomLevel;f=nn(f,this.get("minZoomLevel",1),this.get("maxZoomLevel",32));let g={x:u.x+(h.x-u.x)/2,y:u.y+(h.y-u.y)/2},p={x:s.x+(a.x-s.x)/2,y:s.y+(a.y-s.y)/2},d=this._downTranslateX||0,y=this._downTranslateY||0,v=this._downZoomLevel,P=g.x-(-d+p.x)/v*f,_=g.y-(-y+p.y)/v*f;this.set("zoomLevel",f),this.set("translateX",P),this.set("translateY",_)}}}_handleChartMove(t){const i=this.chartContainer;let e=i._getDownPoint();const o=i._getDownPointId(),s=t.originalEvent.pointerId;if(this.get("pinchZoom")&&s&&(this._movePoints[s]=t.point,Qe(i._downPoints).length>1)){this._handlePinch();return}if(!(o&&s&&s!=o)&&e){const a=this.get("panX"),u=this.get("panY");if(a!="none"||u!="none"){const h=i._display;let l=h.toLocal(t.point);e=h.toLocal(e);let c=this._downTranslateX,f=this._downTranslateY;if(Math.hypot(e.x-l.x,e.y-l.y)>5){let g=i.get("background");if(g&&g.events.disableType("click"),vt(c)&&vt(f)){let p=this.get("projection");const d=this.get("zoomLevel",1),y=this.get("maxPanOut",.4),v=this._mapBounds,P=this.width(),_=this.height(),w=v[1][0]-v[0][0],S=v[1][1]-v[0][1];if(a=="translateX"){c+=l.x-e.x;const D=P/2-(P/2-this._centerX)*d;c=Math.min(c,D+w*y*d),c=Math.max(c,D-w*y*d)}if(u=="translateY"){f+=l.y-e.y;const D=_/2-(_/2-this._centerY)*d;f=Math.min(f,D+S*y*d),f=Math.max(f,D-S*y*d)}if(this.set("translateX",c),this.set("translateY",f),p.invert){let D=p.invert([e.x,e.y]);location&&D&&(a=="rotateX"&&this.set("rotationX",this._downRotationX-(e.x-l.x)*this._pLon),u=="rotateY"&&this.set("rotationY",this._downRotationY+(e.y-l.y)*this._pLat))}}}}}}_handleWheelRotateY(t,i,e){this._rya=this.animate({key:"rotationY",to:this.get("rotationY",0)-t,duration:i,easing:e})}_handleWheelRotateX(t,i,e){this._rxa=this.animate({key:"rotationX",to:this.get("rotationX",0)-t,duration:i,easing:e})}_handleWheelZoom(t,i){let e=this.get("zoomStep",2),o=this.get("zoomLevel",1),r=o;t>0?r=o/e:t<0&&(r=o*e),r!=o&&this.zoomToPoint(i,r)}zoomToGeoBounds(t,i,e,o){t.right<t.left&&(t.right=180,t.left=-180);const s=this.getPrivate("geoPath").bounds(this._geometryColection);let a=this.convert({longitude:t.left,latitude:t.top},e,o),u=this.convert({longitude:t.right,latitude:t.bottom},e,o);a.y<s[0][1]&&(a.y=s[0][1]),u.y>s[1][1]&&(u.y=s[1][1]);let h=this.get("zoomLevel",1),l={left:a.x,right:u.x,top:a.y,bottom:u.y},c=this.seriesContainer,f=.9*Math.min(c.innerWidth()/(l.right-l.left)*h,c.innerHeight()/(l.bottom-l.top)*h),g=l.left+(l.right-l.left)/2,p=l.top+(l.bottom-l.top)/2,d=this.invert({x:g,y:p});return(e!=null||o!=null)&&this.rotate(e,o),this.zoomToGeoPoint(d,f,!0,i)}zoomToPoint(t,i,e,o){i&&(i=nn(i,this.get("minZoomLevel",1),this.get("maxZoomLevel",32))),vt(o)||(o=this.get("animationDuration",0));const r=this.get("animationEasing"),s=this.get("zoomLevel",1);this.get("centerMapOnZoomOut")&&i==this.get("homeZoomLevel",1)&&(t=this.convert(this.homeGeoPoint(),this.get("homeRotationX"),this.get("homeRotationY")),e=!0);let a=t.x,u=t.y,h=this.get("translateX",0),l=this.get("translateY",0),c=a,f=u;e&&(c=this.width()/2,f=this.height()/2);let g=c-(a-h)/s*i,p=f-(u-l)/s*i;return this._txa=this.animate({key:"translateX",to:g,duration:o,easing:r}),this._tya=this.animate({key:"translateY",to:p,duration:o,easing:r}),this._za=this.animate({key:"zoomLevel",to:i,duration:o,easing:r}),s!=i&&this._root.readerAlert(this._t("Zoom level changed to %1",this._root.locale,gi(i))),this._za}zoomToGeoPoint(t,i,e,o,r,s){let a=this.convert(t,r,s);if((r!=null||s!=null)&&this.rotate(r,s,o),a)return this.zoomToPoint(a,i,e,o)}rotate(t,i,e){if(this.get("projection").rotate){vt(e)||(e=this.get("animationDuration",0));const r=this.get("animationEasing");t!=null&&this.animate({key:"rotationX",to:t,duration:e,easing:r}),i!=null&&this.animate({key:"rotationY",to:i,duration:e,easing:r})}}zoomIn(){return this.zoomToPoint({x:this.width()/2,y:this.height()/2},this.get("zoomLevel",1)*this.get("zoomStep",2))}zoomOut(){return this.zoomToPoint({x:this.width()/2,y:this.height()/2},this.get("zoomLevel",1)/this.get("zoomStep",2))}_clearDirty(){super._clearDirty(),this._dirtyGeometries=!1,this._mapFitted=!1}getArea(t){const i=this.getPrivate("geoPath"),e=t.get("geometry");return e?i.area(e):0}}Object.defineProperty(ke,"className",{enumerable:!0,configurable:!0,writable:!0,value:"MapChart"});Object.defineProperty(ke,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:On.classNames.concat([ke.className])});class Ze extends _t{constructor(){super(...arguments),Object.defineProperty(this,"_types",{enumerable:!0,configurable:!0,writable:!0,value:["Point","MultiPoint"]}),Object.defineProperty(this,"_lineChangedDp",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_afterNew(){this.fields.push("polygonId","lineId","longitude","latitude","fixed"),super._afterNew()}markDirtyProjection(){this.markDirty()}markDirtyValues(t){super.markDirtyValues(),t&&this._positionBullets(t)}processDataItem(t){super.processDataItem(t);let i=t.get("geometry");if(!i)i={type:"Point",coordinates:[t.get("longitude",0),t.get("latitude",0)]},t.set("geometry",i);else if(i.type=="Point"){const e=i.coordinates;e&&(t.set("longitude",e[0]),t.set("latitude",e[1]))}else if(i.type=="MultiPoint"){const e=i.coordinates;e&&e[0]&&(t.set("longitude",e[0][0]),t.set("latitude",e[0][1]))}this._addGeometry(i,this)}_makeBullets(t){t.bullets=[],this.bullets.each(i=>{const e=t.get("geometry");if(e){if(e.type=="Point")this._setBulletParent(this._makeBullet(t,i));else if(e.type="MultiPoint"){let o=0;Z(e.coordinates,()=>{this._setBulletParent(this._makeBullet(t,i,o)),o++})}}})}_setBulletParent(t){if(t){const i=t.get("sprite"),e=this.chart;if(i&&e){const o=i.dataItem;o&&(o.get("fixed")?i.parent!=e.bulletsContainer&&e.bulletsContainer.children.moveValue(i):i.parent!=this.bulletsContainer&&this.bulletsContainer.children.moveValue(i))}}}_positionBullet(t){const i=t.get("sprite");if(i){const e=i.dataItem;if(e&&e.get("fixed"))return;const o=e.get("latitude"),r=e.get("longitude"),s=e.get("lineDataItem"),a=e.get("fixed"),u=this.chart;let h;if(s)h=s.get("mapLine");else{const d=e.get("lineId");d&&u&&u.series.each(y=>{if(y.isType("MapLineSeries")){let v=y.getDataItemById(d);v&&(e.set("lineDataItem",v),h=v.get("mapLine"))}})}this._lineChangedDp&&this._lineChangedDp.dispose(),h&&(this._lineChangedDp=h.events.on("linechanged",()=>{this._positionBullets(e)}));const l=e.get("polygonDataItem");let c;if(l)c=l.get("mapPolygon");else{const d=e.get("polygonId");d&&u&&u.series.each(y=>{if(y.isType("MapPolygonSeries")){let v=y.getDataItemById(d);v&&(e.set("polygonDataItem",v),c=v.get("mapPolygon"))}})}const f=e.get("positionOnLine");let g,p;if(c){let d=c.visualCentroid();g=[d.longitude,d.latitude],e.setRaw("longitude",d.longitude),e.setRaw("latitude",d.latitude)}else if(h&&vt(f)){let d=h.positionToGeoPoint(f);if(g=[d.longitude,d.latitude],e.get("autoRotate",t.get("autoRotate"))&&u){const y=h.positionToGeoPoint(f-.002),v=h.positionToGeoPoint(f+.002),P=u.convert(y),_=u.convert(v);p=bi(P,_)}e.setRaw("longitude",d.longitude),e.setRaw("latitude",d.latitude)}else if(vt(r)&&vt(o))g=[r,o];else{const d=e.get("geometry");if(d){if(d.type=="Point")this._positionBulletReal(t,d,d.coordinates,p);else if(d.type=="MultiPoint"){let y=t._index||0;g=d.coordinates[y]}}}!a&&g&&this._positionBulletReal(t,{type:"Point",coordinates:g},g,p)}}_positionBulletReal(t,i,e,o){const r=t.get("sprite"),s=this.chart;if(s){const a=s.get("projection"),u=s.getPrivate("geoPath"),h=r.dataItem,l=a(e);if(l){const f={x:l[0],y:l[1]};r.setAll(f),h.setRaw("point",f)}let c=!0;u(i)?this.get("clipFront")&&(c=!1):this.get("clipBack")&&(c=!1),r.setPrivate("visible",c),h.set("clipped",!c),h&&o!=null&&h.get("autoRotate",t.get("autoRotate"))&&r.set("rotation",o+h.get("autoRotateAngle",t.get("autoRotateAngle",0)))}}zoomToDataItem(t,i,e){const o=this.chart;if(o){const r=t.get("longitude",0),s=t.get("latitude",0);return e?o.zoomToGeoPoint({longitude:r,latitude:s},i,!0,void 0,-r,-s):o.zoomToGeoPoint({longitude:r,latitude:s},i,!0)}}zoomToDataItems(t,i){let e=null,o=null,r=null,s=null;if(Z(t,a=>{const u=a.get("longitude",0),h=a.get("latitude",0);(e==null||e>u)&&(e=u),(o==null||o<u)&&(o=u),(r==null||r<h)&&(r=h),(s==null||s>h)&&(s=h)}),e!=null&&o!=null&&r!=null&&s!=null){const a=this.chart;if(a)return i?a.zoomToGeoBounds({left:e,right:o,top:r,bottom:s},void 0,-(e+(o-e)/2),-(r+(r-s)/2)):a.zoomToGeoBounds({left:e,right:o,top:r,bottom:s})}}disposeDataItem(t){const i=this.chart;i&&i.series.each(e=>{e.isType("MapLineSeries")&&Z(e.dataItems,o=>{const r=o.get("pointsToConnect");r&&Z(r,s=>{s==t&&(Rn(r,s),e.markDirtyValues(o))})})}),super.disposeDataItem(t)}_excludeDataItem(t){super._excludeDataItem(t);const i=t.bullets;i&&Z(i,e=>{const o=e.get("sprite");o&&o.setPrivate("visible",!1)})}_unexcludeDataItem(t){super._unexcludeDataItem(t);const i=t.bullets;i&&Z(i,e=>{const o=e.get("sprite");o&&o.setPrivate("visible",!0)})}_notIncludeDataItem(t){super._notIncludeDataItem(t);const i=t.bullets;i&&Z(i,e=>{const o=e.get("sprite");o&&o.setPrivate("visible",!1)})}_unNotIncludeDataItem(t){super._unNotIncludeDataItem(t);const i=t.bullets;i&&Z(i,e=>{const o=e.get("sprite");o&&o.setPrivate("visible",!0)})}}Object.defineProperty(Ze,"className",{enumerable:!0,configurable:!0,writable:!0,value:"MapPointSeries"});Object.defineProperty(Ze,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:_t.classNames.concat([Ze.className])});var Wt={exports:{}};class Ro{constructor(t=[],i=Lo){if(this.data=t,this.length=this.data.length,this.compare=i,this.length>0)for(let e=(this.length>>1)-1;e>=0;e--)this._down(e)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:i,compare:e}=this,o=i[t];for(;t>0;){const r=t-1>>1,s=i[r];if(e(o,s)>=0)break;i[t]=s,t=r}i[t]=o}_down(t){const{data:i,compare:e}=this,o=this.length>>1,r=i[t];for(;t<o;){let s=(t<<1)+1,a=i[s];const u=s+1;if(u<this.length&&e(i[u],a)<0&&(s=u,a=i[u]),e(a,r)>=0)break;i[t]=a,t=s}i[t]=r}}function Lo(n,t){return n<t?-1:n>t?1:0}const Oo=Object.freeze(Object.defineProperty({__proto__:null,default:Ro},Symbol.toStringTag,{value:"Module"})),No=Di(Oo);var Mn;function zo(){if(Mn)return Wt.exports;Mn=1;var n=No;n.default&&(n=n.default),Wt.exports=t,Wt.exports.default=t;function t(a,u,h){u=u||1;for(var l,c,f,g,p=0;p<a[0].length;p++){var d=a[0][p];(!p||d[0]<l)&&(l=d[0]),(!p||d[1]<c)&&(c=d[1]),(!p||d[0]>f)&&(f=d[0]),(!p||d[1]>g)&&(g=d[1])}var y=f-l,v=g-c,P=Math.min(y,v),_=P/2;if(P===0){var w=[l,c];return w.distance=0,w}for(var S=new n(void 0,i),D=l;D<f;D+=P)for(var N=c;N<g;N+=P)S.push(new e(D+_,N+_,_,a));var x=r(a),R=new e(l+y/2,c+v/2,0,a);R.d>x.d&&(x=R);for(var z=S.length;S.length;){var b=S.pop();b.d>x.d&&(x=b,h&&console.log("found best %d after %d probes",Math.round(1e4*b.d)/1e4,z)),!(b.max-x.d<=u)&&(_=b.h/2,S.push(new e(b.x-_,b.y-_,_,a)),S.push(new e(b.x+_,b.y-_,_,a)),S.push(new e(b.x-_,b.y+_,_,a)),S.push(new e(b.x+_,b.y+_,_,a)),z+=4)}h&&(console.log("num probes: "+z),console.log("best distance: "+x.d));var k=[x.x,x.y];return k.distance=x.d,k}function i(a,u){return u.max-a.max}function e(a,u,h,l){this.x=a,this.y=u,this.h=h,this.d=o(a,u,l),this.max=this.d+this.h*Math.SQRT2}function o(a,u,h){for(var l=!1,c=1/0,f=0;f<h.length;f++)for(var g=h[f],p=0,d=g.length,y=d-1;p<d;y=p++){var v=g[p],P=g[y];v[1]>u!=P[1]>u&&a<(P[0]-v[0])*(u-v[1])/(P[1]-v[1])+v[0]&&(l=!l),c=Math.min(c,s(a,u,v,P))}return c===0?0:(l?1:-1)*Math.sqrt(c)}function r(a){for(var u=0,h=0,l=0,c=a[0],f=0,g=c.length,p=g-1;f<g;p=f++){var d=c[f],y=c[p],v=d[0]*y[1]-y[0]*d[1];h+=(d[0]+y[0])*v,l+=(d[1]+y[1])*v,u+=v*3}return u===0?new e(c[0][0],c[0][1],0,a):new e(h/u,l/u,0,a)}function s(a,u,h,l){var c=h[0],f=h[1],g=l[0]-c,p=l[1]-f;if(g!==0||p!==0){var d=((a-c)*g+(u-f)*p)/(g*g+p*p);d>1?(c=l[0],f=l[1]):d>0&&(c+=g*d,f+=p*d)}return g=a-c,p=u-f,g*g+p*p}return Wt.exports}var jo=zo();const To=xi(jo);class pe extends Nn{constructor(){super(...arguments),Object.defineProperty(this,"_projectionDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"series",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_afterNew(){super._afterNew(),this.setPrivate("trustBounds",!0)}_beforeChanged(){if(super._beforeChanged(),this._projectionDirty||this.isDirty("geometry")||this.isDirty("precision")){const t=this.get("geometry");if(t){const i=this.series;if(i){const e=i.projection();e&&e.precision(this.get("precision",.5));const o=i.geoPath();o&&(this._clear=!0,this.set("draw",r=>{o.context(this._display),o(t),o.context(null)}),this.isHover()&&this.showTooltip())}}}}markDirtyProjection(){this.markDirty(),this._projectionDirty=!0}_clearDirty(){super._clearDirty(),this._projectionDirty=!1}geoCentroid(){const t=this.get("geometry");return t?Ve(t):{latitude:0,longitude:0}}visualCentroid(){let t=0,i=[];const e=this.get("geometry");if(e){if(e.type=="Polygon")i=e.coordinates;else if(e.type=="MultiPolygon")for(let o=0;o<e.coordinates.length;o++){let r=e.coordinates[o],s=Bn({type:"Polygon",coordinates:r});s>t&&(i=r,t=s)}if(i){let o=To(i);return{longitude:o[0],latitude:o[1]}}}return{longitude:0,latitude:0}}_getTooltipPoint(){const t=this.series;if(t){const i=t.projection();if(i){const e=this.visualCentroid(),o=i([e.longitude,e.latitude]);if(o)return{x:o[0],y:o[1]}}}return{x:0,y:0}}}Object.defineProperty(pe,"className",{enumerable:!0,configurable:!0,writable:!0,value:"MapPolygon"});Object.defineProperty(pe,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Nn.classNames.concat([pe.className])});class Ae extends _t{constructor(){super(...arguments),Object.defineProperty(this,"mapPolygons",{enumerable:!0,configurable:!0,writable:!0,value:this.addDisposer(new Si(pi.new({}),()=>pe._new(this._root,{},[this.mapPolygons.template])))}),Object.defineProperty(this,"_types",{enumerable:!0,configurable:!0,writable:!0,value:["Polygon","MultiPolygon"]})}makeMapPolygon(t){const i=this.children.push(this.mapPolygons.make());return i._setDataItem(t),this.mapPolygons.push(i),i}markDirtyProjection(){Z(this.dataItems,t=>{let i=t.get("mapPolygon");i&&i.markDirtyProjection()})}_prepareChildren(){super._prepareChildren(),this.isDirty("fill")&&this.mapPolygons.template.set("fill",this.get("fill")),this.isDirty("stroke")&&this.mapPolygons.template.set("stroke",this.get("stroke"))}processDataItem(t){super.processDataItem(t);let i=t.get("mapPolygon");i||(i=this.makeMapPolygon(t)),t.set("mapPolygon",i);let e=t.get("geometry");if(e){if(this.get("reverseGeodata")&&e.coordinates)for(let r=0;r<e.coordinates.length;r++)if(e.type=="MultiPolygon")for(let s=0;s<e.coordinates[r].length;s++)e.coordinates[r][s].reverse();else e.coordinates[r].reverse();i.set("geometry",e)}i.series=this,this._addGeometry(t.get("geometry"),this)}disposeDataItem(t){super.disposeDataItem(t);const i=t.get("mapPolygon");i&&(this.mapPolygons.removeValue(i),i.dispose()),this._removeGeometry(t.get("geometry"))}_excludeDataItem(t){super._excludeDataItem(t);const i=t.get("mapPolygon");i&&i.setPrivate("visible",!1)}_unexcludeDataItem(t){super._unexcludeDataItem(t);const i=t.get("mapPolygon");i&&i.setPrivate("visible",!0)}_notIncludeDataItem(t){super._notIncludeDataItem(t);const i=t.get("mapPolygon");i&&i.setPrivate("visible",!1)}_unNotIncludeDataItem(t){super._unNotIncludeDataItem(t);const i=t.get("mapPolygon");i&&i.setPrivate("visible",!0)}markDirtyValues(t){if(super.markDirtyValues(),t){const i=t.get("mapPolygon");i&&i.set("geometry",t.get("geometry"))}}zoomToDataItem(t,i){const e=t.get("mapPolygon");if(e){const o=e.get("geometry"),r=this.chart;if(o&&r){if(i){const s=Ve(o);return r.rotate(-s.longitude,-s.latitude),r.zoomToGeoBounds(qt(o),void 0,-s.longitude,-s.latitude)}return r.zoomToGeoBounds(qt(o))}}}zoomToDataItems(t,i){let e,o,r,s;if(Z(t,a=>{const u=a.get("mapPolygon");if(u){const h=u.get("geometry");if(h){let l=qt(h);e==null&&(e=l.left),o==null&&(o=l.right),r==null&&(r=l.top),s==null&&(s=l.bottom),e=Math.min(l.left,e),o=Math.max(l.right,o),r=Math.max(l.top,r),s=Math.min(l.bottom,s)}}}),e!=null&&o!=null&&r!=null&&s!=null){const a=this.chart;if(a){if(i){const u=e+(o-e)/2,h=s+(r-s)/2;return a.rotate(-u,-h),a.zoomToGeoBounds({left:e,right:o,top:r,bottom:s},void 0,-u,-h)}return a.zoomToGeoBounds({left:e,right:o,top:r,bottom:s})}}}getPolygonByPoint(t){let i;const o=this._display._renderer.getObjectAtPoint(t);if(o)return this.mapPolygons.each(function(r){r._display==o&&(i=r)}),i}getPolygonByGeoPoint(t){return this.getPolygonByPoint(this.chart.convert(t))}}Object.defineProperty(Ae,"className",{enumerable:!0,configurable:!0,writable:!0,value:"MapPolygonSeries"});Object.defineProperty(Ae,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:_t.classNames.concat([Ae.className])});export{q as A,Mo as B,pe as C,Zo as D,Xo as E,Ao as F,Ve as G,qt as H,ko as I,ke as M,Ae as a,Ze as b,ht as c,pt as d,O as e,M as f,Co as g,I as h,j as i,$o as j,Y as k,Pt as l,Yo as m,A as n,_t as o,xo as p,L as q,C as r,dt as s,Ri as t,ai as u,po as v,mo as w,yo as x,Do as y,on as z};
