import{r as p,j as e,L as O,$ as g,S as E}from"./app-Dxyb4tjP.js";import{B as u}from"./button-B5hvMkID.js";import{B as b}from"./badge-CFIMvubG.js";import{C as H,a as U,b as Q,d as q}from"./card-gqeyKRBF.js";import{P as G}from"./pagination-D0o2G5in.js";import{A as J,C as K}from"./app-layout-CargaESm.js";import{u as M}from"./use-debounce-CXhgog7o.js";import{u as V}from"./translate-DRO0aTlv.js";import{H as W}from"./header-Co4vZbwI.js";import{S as X}from"./SearchFilters-CdoGrfwu.js";import{S as f,T as Y}from"./triangle-alert-WR4Fy3YO.js";import{T as j}from"./trending-up-CH0Gy_Yi.js";import{f as Z}from"./index-CaunA62S.js";import{F as ee}from"./file-text-BnK35OVo.js";import{P as te}from"./printer-DZoe9t9B.js";import{A as N}from"./arrow-up-down-Cykj19xB.js";import"./utils-D08MpAnR.js";import"./createLucideIcon-CizsRpcm.js";import"./index-C7TBSawa.js";import"./index-CB9xN6kO.js";import"./index-7JOkQmzC.js";import"./index-feeDSjWk.js";import"./x-CVKsxXZd.js";import"./index-D4hpdsSW.js";import"./avatar-BqGbTpCc.js";import"./users-DVBdamvi.js";import"./tag-Do7YviEf.js";import"./qr-code-Dfcoi-Zo.js";import"./chart-column-CZi6LORu.js";import"./map-pin-BtG_j5Tk.js";import"./building-DY95iLU8.js";import"./database-DXZEawtm.js";import"./permission-guard-CaUn-EsK.js";import"./arrow-left-L8xK0F6t.js";import"./plus-DIcRBO1D.js";import"./select-Di7pumQ8.js";import"./index-DzqPr8y_.js";import"./check-2pcRHOH3.js";import"./input-Djp4Y3g5.js";import"./search-B-waBT-f.js";import"./filter-x-Cm4FCPiS.js";const re=[{title:"Dashboard",href:"/dashboard"},{title:"Incident Reports",href:route("incident-reports.index")}];function qe({reports:o,filters:l={}}){const{t}=V(),[i,y]=p.useState(l.search||""),[_,v]=p.useState(!1),m=p.useRef(null),x=M(i,500),k=[{value:"all",label:t("incident_reports.filters.all_statuses")},{value:"pending",label:t("incident_reports.status.pending")},{value:"reviewed",label:t("incident_reports.status.reviewed")},{value:"approved",label:t("incident_reports.status.approved")},{value:"rejected",label:t("incident_reports.status.rejected")}],w=[{value:"all",label:t("incident_reports.filters.all_security_levels")},{value:"low",label:t("incident_reports.level.low")},{value:"medium",label:t("incident_reports.level.medium")},{value:"high",label:t("incident_reports.level.high")},{value:"critical",label:t("incident_reports.level.critical")}],C=[{value:"report_date:desc",label:t("incident_reports.sort.date_newest")},{value:"report_date:asc",label:t("incident_reports.sort.date_oldest")},{value:"report_number:asc",label:t("incident_reports.sort.number_asc")},{value:"report_number:desc",label:t("incident_reports.sort.number_desc")},{value:"incidents_count:desc",label:t("incident_reports.sort.incidents_most")},{value:"incidents_count:asc",label:t("incident_reports.sort.incidents_least")}],S=[{value:10,label:"10"},{value:25,label:"25"},{value:50,label:"50"},{value:100,label:"100"}],n=(r,a)=>{if(_)return;v(!0);const[h,I]=(a.sort||"report_date:desc").split(":"),L={search:r,status:a.category==="all"?"":a.category,security_level:a.type==="all"?"":a.type,sort_field:h,sort_direction:I,per_page:a.per_page||10},R=route("incident-reports.index"),z={preserveState:!0,replace:!0,onFinish:()=>v(!1)};E.get(R,L,z)},s={type:l.security_level||"all",category:l.status||"all",sort:`${l.sort_field||"report_date"}:${l.sort_direction||"desc"}`,direction:l.sort_direction||"desc",per_page:10},F=r=>{r.preventDefault(),n(i,s)},P=r=>{const a={...s,type:r};n(i,a)},T=r=>{const a={...s,category:r};n(i,a)},D=r=>{const a={...s,sort:r};n(i,a)},$=()=>{const r=s.direction==="asc"?"desc":"asc",a={...s,sort:`${s.sort.split(":")[0]}:${r}`};n(i,a)},B=r=>{const a={...s,per_page:parseInt(r)};n(i,a)},A=()=>{y(""),n("",{type:"all",category:"all",sort:"report_date:desc",per_page:10})};p.useEffect(()=>{m.current&&clearTimeout(m.current),x!==l.search&&(m.current=setTimeout(()=>{n(x,s)},100))},[x]);const d=r=>{const a=s.direction==="asc"?"desc":"asc",h={...s,sort:`${r}:${a}`};n(i,h)},c=r=>s.sort.split(":")[0]!==r?null:s.direction==="asc"?e.jsx(N,{className:"ml-1 h-4 w-4 inline"}):e.jsx(N,{className:"ml-1 h-4 w-4 inline rotate-180"});return e.jsxs(J,{breadcrumbs:re,children:[e.jsx(O,{title:t("incident_reports.page_title")}),e.jsxs("div",{className:"container px-0 py-6",children:[e.jsx(W,{title:t("incident_reports.page_title"),description:t("incident_reports.page_description"),icon:e.jsx(f,{className:"h-6 w-6 text-white"}),model:"incident_report",routeName:()=>route("incident-reports.create"),buttonText:t("incident_reports.new_report"),theme:"stone",buttonSize:"lg",showBackButton:!1,showButton:!0}),e.jsx(X,{searchQuery:i,onSearchChange:y,onSearchSubmit:F,searchPlaceholder:t("incident_reports.search_placeholder"),filters:s,onTypeChange:P,onCategoryChange:T,onDepartmentChange:()=>{},onSortChange:D,onDirectionChange:$,onPerPageChange:B,onResetFilters:A,types:w,categories:k,departments:[],sortOptions:C,perPageOptions:S,title:t("incident_reports.search_filters"),description:"Find and filter incident reports",className:"shadow-2xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-3xl"}),e.jsx("div",{className:"mt-8",children:e.jsxs(H,{className:"shadow-2xl overflow-hidden bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-3xl",children:[e.jsx(U,{className:"bg-gradient-to-l from-stone-500 to-stone-600 text-white py-6",children:e.jsxs(Q,{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-white/20 rounded-2xl backdrop-blur-sm shadow-lg",children:e.jsx(j,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:t("incident_reports.table.title")}),e.jsx("div",{className:"text-stone-100 text-sm font-medium",children:"Incident reports overview"})]})]})}),e.jsx(q,{className:"p-0",children:e.jsx("div",{className:"overflow-hidden rounded-b-3xl",children:e.jsxs("table",{className:"w-full caption-bottom text-sm",children:[e.jsx("thead",{className:"[&_tr]:border-b",children:e.jsxs("tr",{className:"bg-gray-100 dark:bg-gray-700 border-0",children:[e.jsxs("th",{className:"h-12 px-6 text-left align-middle font-bold text-gray-800 dark:text-gray-200 text-lg cursor-pointer",onClick:()=>d("report_number"),children:[t("incident_reports.table.report_number")," ",c("report_number")]}),e.jsxs("th",{className:"h-12 px-6 text-left align-middle font-bold text-gray-800 dark:text-gray-200 text-lg cursor-pointer",onClick:()=>d("report_date"),children:[t("incident_reports.table.date")," ",c("report_date")]}),e.jsxs("th",{className:"h-12 px-6 text-left align-middle font-bold text-gray-800 dark:text-gray-200 text-lg cursor-pointer",onClick:()=>d("incidents_count"),children:[t("incident_reports.table.incidents")," ",c("incidents_count")]}),e.jsxs("th",{className:"h-12 px-6 text-left align-middle font-bold text-gray-800 dark:text-gray-200 text-lg cursor-pointer",onClick:()=>d("security_level"),children:[t("incident_reports.table.security_level")," ",c("security_level")]}),e.jsx("th",{className:"h-12 px-6 text-left align-middle font-bold text-gray-800 dark:text-gray-200 text-lg",children:t("incident_reports.table.submitted_by")}),e.jsxs("th",{className:"h-12 px-6 text-left align-middle font-bold text-gray-800 dark:text-gray-200 text-lg cursor-pointer",onClick:()=>d("report_status"),children:[t("incident_reports.table.status")," ",c("report_status")]}),e.jsx("th",{className:"h-12 px-6 text-left align-middle font-bold text-gray-800 dark:text-gray-200 text-lg",children:t("common.actions")})]})}),e.jsx("tbody",{className:"[&_tr:last-child]:border-0",children:_?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"h-32 text-center align-middle",children:e.jsxs("div",{className:"flex flex-col items-center gap-4 text-gray-600 dark:text-gray-400",children:[e.jsx("div",{className:"p-4 bg-gray-100 dark:bg-gray-700 rounded-full",children:e.jsx(j,{className:"h-16 w-16 text-gray-400 animate-spin"})}),e.jsx("p",{className:"text-xl font-bold",children:t("incident_reports.loading_reports")}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:t("incident_reports.loading_description")})]})})}):o.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"h-32 text-center align-middle",children:e.jsxs("div",{className:"flex flex-col items-center gap-4 text-gray-600 dark:text-gray-400",children:[e.jsx("div",{className:"p-4 bg-gray-100 dark:bg-gray-700 rounded-full",children:e.jsx(Y,{className:"h-16 w-16 text-gray-400"})}),e.jsx("p",{className:"text-xl font-bold",children:t("incident_reports.no_reports")}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No incident reports found"})]})})}):o.data.map(r=>{var a;return e.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-700 transition-colors hover:bg-gray-50 dark:hover:bg-gray-700 data-[state=selected]:bg-muted",children:[e.jsx("td",{className:"p-6 align-middle",children:e.jsx(g,{href:route("incident-reports.show",r.id),className:"font-bold text-gray-900 dark:text-gray-100 text-lg hover:underline",children:r.report_number})}),e.jsx("td",{className:"p-6 align-middle text-gray-800 dark:text-gray-200 font-medium",children:Z(new Date(r.report_date),"PPP")}),e.jsx("td",{className:"p-6 align-middle",children:e.jsx(b,{variant:"outline",className:"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 border-gray-300 dark:border-gray-600 px-4 py-2 rounded-xl font-semibold",children:t("incident_reports.incidents_count",{count:String(r.incidents_count)})})}),e.jsx("td",{className:"p-6 align-middle",children:e.jsxs(b,{variant:"outline",className:"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 border-gray-300 dark:border-gray-600 px-4 py-2 rounded-xl font-semibold",children:[e.jsx(f,{className:"mr-1 h-3 w-3"}),r.security_level]})}),e.jsx("td",{className:"p-6 align-middle text-gray-800 dark:text-gray-200 font-medium",children:((a=r.submitter)==null?void 0:a.name)||t("incidents.unknown")}),e.jsx("td",{className:"p-6 align-middle",children:e.jsx(b,{variant:"outline",className:"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 border-gray-300 dark:border-gray-600 px-4 py-2 rounded-xl font-semibold",children:r.report_status})}),e.jsx("td",{className:"p-6 align-middle",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{variant:"ghost",size:"icon",asChild:!0,title:t("incident_reports.view"),className:"h-10 w-10 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-all duration-300 hover:scale-110",children:e.jsx(g,{href:route("incident-reports.show",r.id),children:e.jsx(ee,{className:"h-5 w-5"})})}),e.jsx(u,{variant:"ghost",size:"icon",asChild:!0,title:t("incidents.page_title"),className:"h-10 w-10 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-all duration-300 hover:scale-110",children:e.jsx(g,{href:route("incident-reports.incidents",r.id),children:e.jsx(K,{className:"h-5 w-5"})})}),e.jsx(u,{variant:"ghost",size:"icon",asChild:!0,title:t("incident_reports.print.title"),className:"h-10 w-10 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-all duration-300 hover:scale-110",children:e.jsx(g,{href:route("incident-reports.print",r.id),children:e.jsx(te,{className:"h-5 w-5"})})})]})})]},r.id)})})]})})})]})}),o.links&&o.links.length>0&&e.jsx("div",{className:"mt-8 flex justify-center",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-3xl shadow-2xl border border-gray-200 dark:border-gray-700",children:e.jsx(G,{links:o.links})})})]})]})}export{qe as default};
