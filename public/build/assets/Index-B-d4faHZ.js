import{r as m,S as $,j as e,L as B,$ as x}from"./app-wp6Guzzg.js";import{B as N}from"./button-DdhFDbBb.js";import{B as D}from"./badge-BvpqPqOJ.js";import{C as E,a as V,b as z,c as H,d as U}from"./card-DCX32ycO.js";import{P as R}from"./pagination-D9qjbJOa.js";import{P as X}from"./page-header-DdK3B3eG.js";import{A as q,b as G}from"./app-layout-BCp2TqpK.js";import{I as J}from"./input-DOaZA_KP.js";import{S as b,a as _,b as S,c as w,d as r}from"./select-tzjXi50L.js";import{L as C}from"./label-uuIrNZy3.js";import{u as K}from"./use-debounce-DUqayTYm.js";import{u as M}from"./translate-DHvh_RxM.js";import{P as O}from"./plus-CRTrU7xz.js";import{S as Q}from"./search-C_Xcr2_W.js";import{X as W}from"./x-DMYmK7hh.js";import{f as Y}from"./index-CaunA62S.js";import{F as Z}from"./file-text-a4VBICP-.js";import{A}from"./arrow-up-down-DsWIPeom.js";import"./utils-BoYQRibn.js";import"./chevron-left-D7HeHKuy.js";import"./createLucideIcon-WLF4tROH.js";import"./index-BW6aKdAO.js";import"./index-XAn5yQ2E.js";import"./index-DtlMaX7Z.js";import"./index-kSuzMWFK.js";import"./index-qZqd60Ez.js";import"./avatar-D0atiyuw.js";import"./app-logo-DEdMN1x1.js";import"./app-logo-icon-CU0HTb3k.js";import"./eye-Nva3oBMg.js";import"./users-Dj-7kQ7a.js";import"./tag-Dui773Zp.js";import"./triangle-alert-nApTjZp7.js";import"./qr-code-B0fjN3Lw.js";import"./globe-BjUcTPKI.js";import"./index-BJlsjxrB.js";import"./check-bJLwwkQ5.js";const ee=[{title:"Dashboard",href:"/dashboard"},{title:"Incidents",href:route("incidents.index")}];function Ve({incidents:u,filters:i={},categories:L}){const{t:s}=M(),[p,y]=m.useState(i.search||""),[d,P]=m.useState(i.status||""),[n,k]=m.useState(i.category_id||""),[a,j]=m.useState(i.sort_field||"incident_date"),[l,h]=m.useState(i.sort_direction||"desc"),f=K(p,500);m.useEffect(()=>{try{if(f!==i.search||d!==i.status||n!==i.category_id||a!==i.sort_field||l!==i.sort_direction){const t={search:f,status:d==="all"?"":d,category_id:n==="all"?"":n,sort_field:a,sort_direction:l},c=route("incidents.index"),o={preserveState:!0,replace:!0};setTimeout(()=>{$.get(c,t,o)},0)}}catch(t){console.error("Error applying filters:",t)}},[f,d,n,a,l,i]);const g=t=>{a===t?h(l==="asc"?"desc":"asc"):(j(t),h("asc"))},v=t=>a!==t?null:l==="asc"?e.jsx(A,{className:"ml-1 h-4 w-4 inline"}):e.jsx(A,{className:"ml-1 h-4 w-4 inline rotate-180"}),T=()=>{y(""),P("all"),k("all"),j("incident_date"),h("desc")};return e.jsxs(q,{breadcrumbs:ee,children:[e.jsx(B,{title:s("incidents.page_title")}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[e.jsx(X,{title:s("incidents.page_title"),description:s("incidents.page_description"),actions:e.jsx(N,{asChild:!0,children:e.jsxs(x,{href:route("incidents.create"),children:[e.jsx(O,{className:"mr-2 h-4 w-4"}),s("incidents.new_incident")]})})}),e.jsxs(E,{children:[e.jsx(V,{children:e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx(z,{children:s("incidents.all_incidents")}),e.jsx(H,{children:s("incidents.list_description")})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"relative w-full md:w-auto",children:[e.jsx(Q,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(J,{placeholder:s("incidents.search_placeholder"),className:"pl-8 pr-4",value:p,onChange:t=>y(t.target.value)})]}),(p||d||n||a!=="incident_date"||l!=="desc")&&e.jsxs(N,{variant:"ghost",size:"sm",onClick:T,children:[e.jsx(W,{className:"mr-2 h-4 w-4"}),s("common.clear")]})]})]})}),e.jsxs(U,{children:[e.jsxs("div",{className:"mb-4 grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx(C,{htmlFor:"status-filter",children:s("incidents.filters.status")}),e.jsxs(b,{value:d,onValueChange:P,children:[e.jsx(_,{id:"status-filter",children:e.jsx(S,{placeholder:s("incidents.filters.all_statuses")})}),e.jsxs(w,{children:[e.jsx(r,{value:"all",children:s("incidents.filters.all_statuses")}),e.jsx(r,{value:"reported",children:s("incidents.status.reported")}),e.jsx(r,{value:"investigating",children:s("incidents.status.investigating")}),e.jsx(r,{value:"resolved",children:s("incidents.status.resolved")}),e.jsx(r,{value:"closed",children:s("incidents.status.closed")})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"category-filter",children:s("incidents.filters.category")}),e.jsxs(b,{value:n,onValueChange:k,children:[e.jsx(_,{id:"category-filter",children:e.jsx(S,{placeholder:s("incidents.filters.all_categories")})}),e.jsxs(w,{children:[e.jsx(r,{value:"all",children:s("incidents.filters.all_categories")}),L.map(t=>e.jsx(r,{value:t.id.toString(),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-2 h-3 w-3 rounded-full",style:{backgroundColor:t.color}}),t.name]})},t.id))]})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"sort-by",children:s("incidents.filters.sort_by")}),e.jsxs(b,{value:`${a}:${l}`,onValueChange:t=>{const[c,o]=t.split(":");j(c),h(o)},children:[e.jsx(_,{id:"sort-by",children:e.jsx(S,{placeholder:s("incidents.filters.sort_by")})}),e.jsxs(w,{children:[e.jsx(r,{value:"incident_date:desc",children:s("incidents.sort.date_newest")}),e.jsx(r,{value:"incident_date:asc",children:s("incidents.sort.date_oldest")}),e.jsx(r,{value:"title:asc",children:s("incidents.sort.title_asc")}),e.jsx(r,{value:"title:desc",children:s("incidents.sort.title_desc")})]})]})]})]}),e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsxs("table",{className:"w-full caption-bottom text-sm",children:[e.jsx("thead",{className:"[&_tr]:border-b",children:e.jsxs("tr",{className:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",children:[e.jsxs("th",{className:"h-12 px-4 text-left align-middle font-medium cursor-pointer",onClick:()=>g("title"),children:[s("incidents.table.title")," ",v("title")]}),e.jsxs("th",{className:"h-12 px-4 text-left align-middle font-medium cursor-pointer",onClick:()=>g("incident_date"),children:[s("incidents.table.date")," ",v("incident_date")]}),e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium",children:s("incidents.table.location")}),e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium",children:s("incidents.table.category")}),e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium",children:s("incidents.table.report")}),e.jsxs("th",{className:"h-12 px-4 text-left align-middle font-medium cursor-pointer",onClick:()=>g("status"),children:[s("incidents.table.status")," ",v("status")]}),e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium",children:s("common.actions")})]})}),e.jsx("tbody",{className:"[&_tr:last-child]:border-0",children:u.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"h-12 px-4 text-center align-middle",children:s("incidents.no_incidents")})}):u.data.map(t=>{var c,o,F,I;return e.jsxs("tr",{className:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",children:[e.jsx("td",{className:"p-4 align-middle",children:e.jsx(x,{href:route("incidents.show",t.id),className:"font-medium text-primary hover:underline",children:t.title})}),e.jsx("td",{className:"p-4 align-middle",children:Y(new Date(t.incident_date),"PPP")}),e.jsxs("td",{className:"p-4 align-middle",children:[(c=t.district)==null?void 0:c.name,", ",(o=t.district_province)==null?void 0:o.name]}),e.jsx("td",{className:"p-4 align-middle",children:e.jsx(D,{style:{backgroundColor:((F=t.category)==null?void 0:F.color)||"#888888"},children:((I=t.category)==null?void 0:I.name)||s("incidents.unspecified")})}),e.jsx("td",{className:"p-4 align-middle",children:t.report?e.jsxs(x,{href:route("incident-reports.show",t.report.id),className:"flex items-center text-sm text-muted-foreground hover:underline",children:[e.jsx(Z,{className:"mr-1 h-4 w-4"}),t.report.report_number]}):e.jsx("span",{className:"text-muted-foreground text-sm",children:s("incidents.none")})}),e.jsx("td",{className:"p-4 align-middle",children:e.jsx(D,{variant:t.status==="resolved"||t.status==="investigating"?"default":t.status==="closed"?"outline":"default",children:s(`incidents.status.${t.status}`)})}),e.jsx("td",{className:"p-4 align-middle",children:e.jsx("div",{className:"flex space-x-2",children:e.jsx(N,{variant:"ghost",size:"sm",asChild:!0,children:e.jsxs(x,{href:route("incidents.show",t.id),children:[e.jsx(G,{className:"h-4 w-4 mr-1"}),s("incidents.details")]})})})})]},t.id)})})]})}),e.jsx("div",{className:"mt-6",children:e.jsx(R,{links:u.links})})]})]})]})]})}export{Ve as default};
