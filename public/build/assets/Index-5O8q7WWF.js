import{r as h,j as e,L as E,$ as u,S as x}from"./app-NWlhzIiI.js";import{B as a}from"./button-Box1-qgD.js";import{B as b}from"./badge-8-r2roqJ.js";import{C as H,d as Q}from"./card-DvyK6hRT.js";import{P as U}from"./pagination-C2Om-1JQ.js";import{A as X}from"./app-layout-By-MARzy.js";import{u as q}from"./use-debounce-CTUkWey5.js";import{u as G}from"./translate-CQfM3vbo.js";import{H as J}from"./header-C6-eMOlP.js";import{S as K}from"./SearchFilters-D0irrE-h.js";import{S as N}from"./shield-DUD3wVHp.js";import{T as M}from"./triangle-alert-WGDBdikk.js";import{f as V}from"./index-CaunA62S.js";import{F as W}from"./file-text-CyHLALFq.js";import{C as Y}from"./circle-alert-Bwq1RANh.js";import{P as Z}from"./printer-CzuLGY7J.js";import{P as ee}from"./pencil-zKMKJPiD.js";import{C as te}from"./circle-x-CJZl6NTo.js";import{C as re}from"./circle-check-big-BJj4jH7N.js";import{T as le}from"./trash-D3hOutvw.js";import{A as w}from"./arrow-up-down-BGwJiRM5.js";import"./utils-CjIpxwge.js";import"./chevron-left-CVBzoS_T.js";import"./createLucideIcon-aOMmq26Q.js";import"./index-LNM0viqu.js";import"./tslib.es6-CmEaCU22.js";import"./index--ZO2L52o.js";import"./index-DmWWB6Fq.js";import"./index-COnRykQT.js";import"./x-DPZesNn8.js";import"./index-DrYACo-5.js";import"./avatar-CQF4zAG1.js";import"./calendar-bCvzJPwI.js";import"./users-DJjY4K-g.js";import"./tag-BRdLRwg_.js";import"./qr-code-gl_KlejU.js";import"./map-pin-gWVy6gHw.js";import"./database-BLSwhGHk.js";import"./permission-guard-BE4HVUt5.js";import"./arrow-left-BW7btOfZ.js";import"./plus-Coi6u1xM.js";import"./select-CN__VSdP.js";import"./index-BxdvcV1_.js";import"./check-BL0RFP_t.js";import"./input-DwzvWPem.js";import"./search-DsoCqGUD.js";import"./filter-x-BlDIiyAZ.js";const se=[{title:"Dashboard",href:"/dashboard"},{title:"Incident Reports",href:route("incident-reports.index")}];function Ye({reports:d,filters:o={}}){const{t}=G(),[i,f]=h.useState(o.search||""),[v,j]=h.useState(!1),g=h.useRef(null),_=q(i,500),y=[{value:"all",label:t("incident_reports.filters.all_statuses")},{value:"pending",label:t("incident_reports.status.pending")},{value:"reviewed",label:t("incident_reports.status.reviewed")},{value:"approved",label:t("incident_reports.status.approved")},{value:"rejected",label:t("incident_reports.status.rejected")}],C=[{value:"all",label:t("incident_reports.filters.all_security_levels")},{value:"low",label:t("incident_reports.level.low")},{value:"medium",label:t("incident_reports.level.medium")},{value:"high",label:t("incident_reports.level.high")},{value:"critical",label:t("incident_reports.level.critical")}],S=[{value:"report_date:desc",label:t("incident_reports.sort.date_newest")},{value:"report_date:asc",label:t("incident_reports.sort.date_oldest")},{value:"report_number:asc",label:t("incident_reports.sort.number_asc")},{value:"report_number:desc",label:t("incident_reports.sort.number_desc")},{value:"incidents_count:desc",label:t("incident_reports.sort.incidents_most")},{value:"incidents_count:asc",label:t("incident_reports.sort.incidents_least")}],P=[{value:10,label:"10"},{value:25,label:"25"},{value:50,label:"50"},{value:100,label:"100"}],n=(r,l,m=1)=>{if(v)return;j(!0);const[L,R]=(l.sort||"report_date:desc").split(":"),k={search:r,status:l.category==="all"?"":l.category,security_level:l.type==="all"?"":l.type,sort_field:L,sort_direction:R,per_page:l.per_page||10};m>1&&(k.page=m);const I=route("incident-reports.index"),O={preserveState:!0,replace:!0,onFinish:()=>j(!1)};x.get(I,k,O)},s={type:o.security_level||"all",category:o.status||"all",sort:`${o.sort_field||"report_date"}:${o.sort_direction||"desc"}`,direction:o.sort_direction||"desc",per_page:10},F=r=>{r.preventDefault(),n(i,s)},T=r=>{const l={...s,type:r};n(i,l)},D=r=>{const l={...s,category:r};n(i,l)},$=r=>{const l={...s,sort:r};n(i,l)},B=()=>{const r=s.direction==="asc"?"desc":"asc",l={...s,sort:`${s.sort.split(":")[0]}:${r}`};n(i,l)},z=r=>{const l={...s,per_page:parseInt(r)};n(i,l)},A=()=>{f(""),n("",{type:"all",category:"all",sort:"report_date:desc",per_page:10})};h.useEffect(()=>{g.current&&clearTimeout(g.current),_!==(o.search||"")&&(g.current=setTimeout(()=>{n(_,s,1)},100))},[_]);const p=r=>{const l=s.direction==="asc"?"desc":"asc",m={...s,sort:`${r}:${l}`};n(i,m)},c=r=>s.sort.split(":")[0]!==r?null:s.direction==="asc"?e.jsx(w,{className:"ml-1 h-4 w-4 inline"}):e.jsx(w,{className:"ml-1 h-4 w-4 inline rotate-180"});return e.jsxs(X,{breadcrumbs:se,children:[e.jsx(E,{title:t("incident_reports.page_title")}),e.jsxs("div",{className:"container px-0 py-6",children:[e.jsx(J,{title:t("incident_reports.page_title"),description:t("incident_reports.page_description"),icon:e.jsx(N,{className:"h-6 w-6 text-white"}),model:"incident_report",routeName:()=>route("incident-reports.create"),buttonText:t("incident_reports.new_report"),theme:"purple",buttonSize:"lg",showBackButton:!1,showButton:!0}),e.jsx(K,{searchQuery:i,onSearchChange:f,onSearchSubmit:F,searchPlaceholder:t("incident_reports.search_placeholder"),filters:s,onTypeChange:T,onCategoryChange:D,onDepartmentChange:()=>{},onSortChange:$,onDirectionChange:B,onPerPageChange:z,onResetFilters:A,types:C,categories:y,departments:[],sortOptions:S,perPageOptions:P,title:t("incident_reports.search_filters"),description:t("incident_reports.search_filters_description"),className:"shadow-2xl bg-gradient-to-bl from-white dark:from-gray-800 to-purple-50/30 dark:to-purple-900/20 border-0 overflow-hidden"}),e.jsx("div",{className:"mt-8",children:e.jsx(H,{className:"shadow-2xl overflow-hidden bg-gradient-to-bl from-white dark:from-gray-800 to-purple-50/30 dark:to-purple-900/20 border-0 rounded-3xl mt-6",children:e.jsx(Q,{className:"p-0",children:e.jsx("div",{className:"overflow-hidden rounded-b-3xl",children:e.jsxs("table",{className:"w-full caption-bottom text-sm",children:[e.jsx("thead",{className:"[&_tr]:border-b",children:e.jsxs("tr",{className:"bg-gradient-to-l from-purple-100 dark:from-purple-900 to-purple-200 dark:to-purple-800 border-0",children:[e.jsxs("th",{className:"h-12 px-6 text-left align-middle font-bold text-purple-800 dark:text-purple-200 text-lg cursor-pointer py-6",onClick:()=>p("report_number"),children:[t("incident_reports.table.report_number")," ",c("report_number")]}),e.jsxs("th",{className:"h-12 px-6 text-left align-middle font-bold text-purple-800 dark:text-purple-200 text-lg cursor-pointer py-6",onClick:()=>p("report_date"),children:[t("incident_reports.table.date")," ",c("report_date")]}),e.jsxs("th",{className:"h-12 px-6 text-left align-middle font-bold text-purple-800 dark:text-purple-200 text-lg cursor-pointer py-6",onClick:()=>p("incidents_count"),children:[t("incident_reports.table.incidents")," ",c("incidents_count")]}),e.jsxs("th",{className:"h-12 px-6 text-left align-middle font-bold text-purple-800 dark:text-purple-200 text-lg cursor-pointer py-6",onClick:()=>p("security_level"),children:[t("incident_reports.table.security_level")," ",c("security_level")]}),e.jsx("th",{className:"h-12 px-6 text-left align-middle font-bold text-purple-800 dark:text-purple-200 text-lg py-6",children:t("incident_reports.table.submitted_by")}),e.jsxs("th",{className:"h-12 px-6 text-left align-middle font-bold text-purple-800 dark:text-purple-200 text-lg cursor-pointer py-6",onClick:()=>p("report_status"),children:[t("incident_reports.table.status")," ",c("report_status")]}),e.jsx("th",{className:"h-12 px-6 text-left align-middle font-bold text-purple-800 dark:text-purple-200 text-lg py-6",children:t("common.actions")})]})}),e.jsx("tbody",{className:"[&_tr:last-child]:border-0",children:v?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"h-32 text-center align-middle",children:e.jsxs("div",{className:"flex flex-col items-center gap-4 text-purple-600 dark:text-purple-400",children:[e.jsx("p",{className:"text-xl font-bold",children:t("incident_reports.loading_reports")}),e.jsx("p",{className:"text-purple-500 dark:text-purple-400",children:t("incident_reports.loading_description")})]})})}):d.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"h-32 text-center align-middle",children:e.jsxs("div",{className:"flex flex-col items-center gap-4 text-purple-600 dark:text-purple-400",children:[e.jsx("div",{className:"p-4 bg-purple-100 dark:bg-purple-800 rounded-full",children:e.jsx(M,{className:"h-16 w-16 text-purple-400 dark:text-purple-300"})}),e.jsx("p",{className:"text-xl font-bold",children:t("incident_reports.no_reports")}),e.jsx("p",{className:"text-purple-500 dark:text-purple-400",children:t("incident_reports.no_reports_found")})]})})}):d.data.map(r=>{var l;return e.jsxs("tr",{className:"border-b border-purple-100 dark:border-purple-800 transition-colors hover:bg-purple-50/50 dark:hover:bg-purple-900/20 data-[state=selected]:bg-muted",children:[e.jsx("td",{className:"p-6 align-middle",children:e.jsx(u,{href:route("incident-reports.show",r.id),className:"font-bold text-purple-900 dark:text-purple-100 text-lg hover:underline",children:r.report_number})}),e.jsx("td",{className:"p-6 align-middle text-purple-800 dark:text-purple-200 font-medium",children:V(new Date(r.report_date),"PPP")}),e.jsx("td",{className:"p-6 align-middle",children:e.jsx(b,{variant:"outline",className:"bg-gradient-to-l from-purple-100 dark:from-purple-800 to-purple-200 dark:to-purple-700 text-purple-800 dark:text-purple-200 border-purple-300 dark:border-purple-600 px-4 py-2 rounded-xl font-semibold",children:t("incident_reports.incidents_count",{count:String(r.incidents_count)})})}),e.jsx("td",{className:"p-6 align-middle",children:e.jsxs(b,{variant:"outline",className:"bg-gradient-to-l from-purple-100 dark:from-purple-800 to-purple-200 dark:to-purple-700 text-purple-800 dark:text-purple-200 border-purple-300 dark:border-purple-600 px-4 py-2 rounded-xl font-semibold",children:[e.jsx(N,{className:"mr-1 h-3 w-3"}),r.security_level]})}),e.jsx("td",{className:"p-6 align-middle text-purple-800 dark:text-purple-200 font-medium",children:((l=r.submitter)==null?void 0:l.name)||t("incidents.unknown")}),e.jsx("td",{className:"p-6 align-middle",children:e.jsx(b,{variant:"outline",className:"bg-gradient-to-l from-purple-100 dark:from-purple-800 to-purple-200 dark:to-purple-700 text-purple-800 dark:text-purple-200 border-purple-300 dark:border-purple-600 px-4 py-2 rounded-xl font-semibold",children:r.report_status})}),e.jsx("td",{className:"p-6 align-middle",children:e.jsxs("div",{className:"flex items-center gap-2",children:[r.can_view&&e.jsxs(e.Fragment,{children:[e.jsx(a,{variant:"ghost",size:"icon",asChild:!0,title:t("incident_reports.view"),className:"h-10 w-10 rounded-xl hover:bg-purple-100 dark:hover:bg-purple-800 text-purple-600 dark:text-purple-400 hover:text-purple-700 dark:hover:text-purple-300 transition-all duration-300 hover:scale-110",children:e.jsx(u,{href:route("incident-reports.show",r.id),children:e.jsx(W,{className:"h-5 w-5"})})}),e.jsx(a,{variant:"ghost",size:"icon",asChild:!0,title:t("incidents.page_title"),className:"h-10 w-10 rounded-xl hover:bg-purple-100 dark:hover:bg-purple-800 text-purple-600 dark:text-purple-400 hover:text-purple-700 dark:hover:text-purple-300 transition-all duration-300 hover:scale-110",children:e.jsx(u,{href:route("incident-reports.incidents",r.id),children:e.jsx(Y,{className:"h-5 w-5"})})})]}),r.can_print&&e.jsx(a,{variant:"ghost",size:"icon",asChild:!0,title:t("incident_reports.print.title"),className:"h-10 w-10 rounded-xl hover:bg-purple-100 dark:hover:bg-purple-800 text-purple-600 dark:text-purple-400 hover:text-purple-700 dark:hover:text-purple-300 transition-all duration-300 hover:scale-110",children:e.jsx(u,{href:route("incident-reports.print",r.id),children:e.jsx(Z,{className:"h-5 w-5"})})}),r.can_update&&e.jsx(a,{variant:"ghost",size:"icon",asChild:!0,title:t("common.edit"),className:"h-10 w-10 rounded-xl hover:bg-purple-100 dark:hover:bg-purple-800 text-purple-600 dark:text-purple-400 hover:text-purple-700 dark:hover:text-purple-300 transition-all duration-300 hover:scale-110",children:e.jsx(u,{href:route("incident-reports.edit",r.id),children:e.jsx(ee,{className:"h-5 w-5"})})}),r.can_confirm&&e.jsx(a,{variant:"ghost",size:"icon",onClick:()=>{r.is_confirmed?confirm(t("incident_reports.confirm_unconfirm",{number:r.report_number}))&&x.post(route("incident-reports.unconfirm",r.id)):x.post(route("incident-reports.confirm",r.id))},title:r.is_confirmed?t("incident_reports.unconfirm"):t("incident_reports.confirm"),className:`h-10 w-10 rounded-xl transition-all duration-300 hover:scale-110 ${r.is_confirmed?"hover:bg-orange-100 dark:hover:bg-orange-800 text-orange-600 dark:text-orange-400 hover:text-orange-700 dark:hover:text-orange-300":"hover:bg-green-100 dark:hover:bg-green-800 text-green-600 dark:text-green-400 hover:text-green-700 dark:hover:text-green-300"}`,children:r.is_confirmed?e.jsx(te,{className:"h-5 w-5"}):e.jsx(re,{className:"h-5 w-5"})}),r.can_delete&&e.jsx(a,{variant:"ghost",size:"icon",onClick:()=>{confirm(t("incident_reports.confirm_delete",{number:r.report_number}))&&x.delete(route("incident-reports.destroy",r.id))},title:t("common.delete"),className:"h-10 w-10 rounded-xl hover:bg-red-100 dark:hover:bg-red-800 text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 transition-all duration-300 hover:scale-110",children:e.jsx(le,{className:"h-5 w-5"})})]})})]},r.id)})})]})})})})}),d.links&&d.links.length>0&&e.jsx("div",{className:"mt-8 flex justify-center",children:e.jsx("div",{className:"bg-gradient-to-l from-purple-50 dark:from-purple-900/20 to-white dark:to-gray-800 p-4 rounded-3xl shadow-2xl border border-purple-200 dark:border-purple-700",children:e.jsx(U,{links:d.links})})})]})]})}export{Ye as default};
