import{r as g,m as P,j as e,L as Q}from"./app-ClkBox42.js";import{C as v,a as w,b as y,c as C,d as S}from"./card-CAe-xxiW.js";import{I as h}from"./input-CJ5-gOpr.js";import{L as d}from"./label-FP9VqPXL.js";import{T as f}from"./textarea-v4IGxCcT.js";import{S as T,a as U,b as F,c as B,d as m}from"./select-BnHLK8ZW.js";import{B as W}from"./badge-BQRvAoLL.js";import{B as X}from"./button-D4jyYQ1Q.js";import{A as Y}from"./app-layout-CW0bKekL.js";import{u as Z}from"./translate-BkG5lsBL.js";import{H as I}from"./header-36GTO9cq.js";import{F as ee}from"./FooterButtons-DXs87GEO.js";import{S as L}from"./shield-DmXAlHnm.js";import{F as k}from"./file-text-DzDNqiSK.js";import{T as n}from"./triangle-alert-Db_kNgQZ.js";import{C as R}from"./calendar-CbTlw5nf.js";import{C as re}from"./clock-Db4It71-.js";import{U as p}from"./users-BvldaJhh.js";import{G as te}from"./gavel-CNG5P54f.js";import{F as ie}from"./file-check-DXP1V7xk.js";import{S as A}from"./search-CQJsVZWG.js";import{U as D}from"./user-BAmHVCFf.js";import{A as se}from"./arrow-right-DSlSBRmU.js";import{T as de}from"./trash-oUhiJtPb.js";import"./utils-TGRqflit.js";import"./index-DHwxsUht.js";import"./index-l6ogYteW.js";import"./index-BArnEXsB.js";import"./index-F8D-J14_.js";import"./createLucideIcon-BTLmC541.js";import"./tslib.es6-CmEaCU22.js";import"./index-BXfllusH.js";import"./check-BIk4Cd1m.js";import"./x-DmLGt7Xb.js";import"./index-PkKjS6kf.js";import"./avatar-Bbg9wF6n.js";import"./tag-k7aO0S0T.js";import"./qr-code-Bg9gKvMq.js";import"./map-pin-B_TOKvLv.js";import"./database-DPqzEiYp.js";import"./permission-guard-LybUEl--.js";import"./arrow-left-CAwGfP5w.js";import"./plus-CsuFJYSH.js";import"./save-D0AisIxL.js";function er({report:i,users:u}){var _,N;const{t}=Z(),[c,z]=g.useState(((_=i.accesses)==null?void 0:_.map(r=>r.user_id))||[]),[x,E]=g.useState(""),[oe,H]=g.useState(!1),[ae,V]=g.useState(null),[ne,le]=g.useState([]),{data:l,setData:o,put:$,processing:q,errors:s}=P({report_number:i.report_number,report_date:i.report_date,security_level:i.security_level,details:i.details,action_taken:i.action_taken||"",recommendation:i.recommendation||"",report_status:i.report_status,source:i.source||"",access_users:((N=i.accesses)==null?void 0:N.map(r=>r.user_id))||[],deleted_users:[]}),G=[{title:t("incident_reports.page_title"),href:route("incident-reports.index")},{title:i.report_number,href:route("incident-reports.show",i.id)},{title:t("incident_reports.edit.breadcrumb"),href:route("incident-reports.edit",i.id)}];function O(){window.location.href=route("incident-reports.show",i.id)}function J(){$(route("incident-reports.update",i.id))}const K=r=>{if(!c.includes(r)){const a=[...c,r];z(a),o("access_users",a)}},M=r=>{const a=u.find(b=>b.id===r);a&&(V({id:r,name:a.name}),H(!0))},j=u.filter(r=>r.name.toLowerCase().includes(x.toLowerCase())||r.email.toLowerCase().includes(x.toLowerCase()));return e.jsxs(Y,{breadcrumbs:G,children:[e.jsx(Q,{title:t("incident_reports.edit.page_title",{number:i.report_number})}),e.jsxs("div",{className:"container px-0 py-6",children:[e.jsx(I,{title:t("incident_reports.edit.page_title",{number:i.report_number}),description:t("incident_reports.edit.page_description"),icon:e.jsx(L,{className:"h-5 w-5"}),model:"incident_reports",routeName:()=>route("incident-reports.show",i.id),buttonText:t("common.back"),theme:"indigo",showBackButton:!0,backRouteName:()=>route("incident-reports.show",i.id),backButtonText:t("common.back"),showButton:!1}),e.jsx("form",{children:e.jsxs("div",{className:"grid gap-8",children:[e.jsxs(v,{className:"border-none shadow-xl overflow-hidden bg-gradient-to-bl from-white dark:from-gray-800 to-indigo-50/30 dark:to-indigo-900/20",children:[e.jsxs(w,{className:"bg-gradient-to-l from-indigo-500 dark:from-indigo-600 to-indigo-600 dark:to-indigo-700 text-white border-b pb-4",children:[e.jsxs(y,{className:"flex items-center gap-3 text-lg",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(k,{className:"h-5 w-5"})}),t("incident_reports.form.info_title")]}),e.jsx(C,{className:"text-indigo-100",children:t("incident_reports.form.info_description")})]}),e.jsxs(S,{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid gap-6 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(d,{htmlFor:"report_number",className:"text-base font-medium flex items-center gap-2 text-indigo-700 dark:text-indigo-400 text-right",dir:"rtl",children:[t("incident_reports.form.report_number"),e.jsx(k,{className:"h-4 w-4"})]}),e.jsx(h,{id:"report_number",value:l.report_number,onChange:r=>o("report_number",r.target.value),disabled:!0,className:"h-12 border-indigo-200 dark:border-indigo-700 focus:border-indigo-500 dark:focus:border-indigo-400 focus:ring-indigo-500/20 dark:focus:ring-indigo-400/20 bg-gradient-to-l from-indigo-50 dark:from-indigo-900/30 to-white dark:to-gray-800 text-right"}),s.report_number&&e.jsxs("p",{className:"text-sm text-red-500 dark:text-red-400 font-medium bg-red-50 dark:bg-red-900/20 p-2 rounded-lg border border-red-200 dark:border-red-800 flex items-center gap-2 text-right",children:[e.jsx(n,{className:"h-4 w-4"}),s.report_number]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(d,{htmlFor:"report_date",className:"text-base font-medium flex items-center gap-2 text-indigo-700 dark:text-indigo-400 text-right",dir:"rtl",children:[e.jsx("span",{className:"text-red-500",children:"*"}),t("incident_reports.form.report_date"),e.jsx(R,{className:"h-4 w-4"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(h,{id:"report_date",type:"date",value:l.report_date,onChange:r=>o("report_date",r.target.value),required:!0,className:"h-12 border-indigo-200 dark:border-indigo-700 focus:border-indigo-500 dark:focus:border-indigo-400 focus:ring-indigo-500/20 dark:focus:ring-indigo-400/20 bg-gradient-to-l from-indigo-50 dark:from-indigo-900/30 to-white dark:to-gray-800 text-right"}),e.jsx(R,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-indigo-400 pointer-events-none"})]}),s.report_date&&e.jsxs("p",{className:"text-sm text-red-500 dark:text-red-400 font-medium bg-red-50 dark:bg-red-900/20 p-2 rounded-lg border border-red-200 dark:border-red-800 flex items-center gap-2 text-right",children:[e.jsx(n,{className:"h-4 w-4"}),s.report_date]})]})]}),e.jsxs("div",{className:"grid gap-6 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(d,{htmlFor:"security_level",className:"text-base font-medium flex items-center gap-2 text-indigo-700 dark:text-indigo-400 text-right",dir:"rtl",children:[t("incident_reports.form.security_level"),e.jsx(L,{className:"h-4 w-4"})]}),e.jsxs(T,{value:l.security_level,onValueChange:r=>o("security_level",r),children:[e.jsx(U,{id:"security_level",className:"h-12 border-indigo-200 dark:border-indigo-700 focus:border-indigo-500 dark:focus:border-indigo-400 focus:ring-indigo-500/20 dark:focus:ring-indigo-400/20 bg-gradient-to-l from-indigo-50 dark:from-indigo-900/30 to-white dark:to-gray-800 text-right",children:e.jsx(F,{placeholder:t("incident_reports.form.security_level_placeholder")})}),e.jsxs(B,{children:[e.jsx(m,{value:"normal",children:t("incident_reports.level.normal")}),e.jsx(m,{value:"restricted",children:t("incident_reports.level.restricted")}),e.jsx(m,{value:"classified",children:t("incident_reports.level.classified")})]})]}),s.security_level&&e.jsxs("p",{className:"text-sm text-red-500 dark:text-red-400 font-medium bg-red-50 dark:bg-red-900/20 p-2 rounded-lg border border-red-200 dark:border-red-800 flex items-center gap-2 text-right",children:[e.jsx(n,{className:"h-4 w-4"}),s.security_level]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(d,{htmlFor:"report_status",className:"text-base font-medium flex items-center gap-2 text-indigo-700 dark:text-indigo-400 text-right",dir:"rtl",children:[t("incident_reports.form.status"),e.jsx(re,{className:"h-4 w-4"})]}),e.jsxs(T,{value:l.report_status,onValueChange:r=>o("report_status",r),children:[e.jsx(U,{id:"report_status",className:"h-12 border-indigo-200 dark:border-indigo-700 focus:border-indigo-500 dark:focus:border-indigo-400 focus:ring-indigo-500/20 dark:focus:ring-indigo-400/20 bg-gradient-to-l from-indigo-50 dark:from-indigo-900/30 to-white dark:to-gray-800 text-right",children:e.jsx(F,{placeholder:t("incident_reports.form.status_placeholder")})}),e.jsxs(B,{children:[e.jsx(m,{value:"submitted",children:t("incident_reports.status.submitted")}),e.jsx(m,{value:"reviewed",children:t("incident_reports.status.reviewed")}),e.jsx(m,{value:"approved",children:t("incident_reports.status.approved")})]})]}),s.report_status&&e.jsxs("p",{className:"text-sm text-red-500 dark:text-red-400 font-medium bg-red-50 dark:bg-red-900/20 p-2 rounded-lg border border-red-200 dark:border-red-800 flex items-center gap-2 text-right",children:[e.jsx(n,{className:"h-4 w-4"}),s.report_status]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(d,{htmlFor:"source",className:"text-base font-medium flex items-center gap-2 text-indigo-700 dark:text-indigo-400 text-right",dir:"rtl",children:[t("incident_reports.form.source_label"),e.jsx(p,{className:"h-4 w-4"})]}),e.jsx(h,{id:"source",value:l.source,onChange:r=>o("source",r.target.value),placeholder:t("incident_reports.form.source_placeholder"),className:"h-12 border-indigo-200 dark:border-indigo-700 focus:border-indigo-500 dark:focus:border-indigo-400 focus:ring-indigo-500/20 dark:focus:ring-indigo-400/20 bg-gradient-to-l from-indigo-50 dark:from-indigo-900/30 to-white dark:to-gray-800 text-right"}),s.source&&e.jsxs("p",{className:"text-sm text-red-500 dark:text-red-400 font-medium bg-red-50 dark:bg-red-900/20 p-2 rounded-lg border border-red-200 dark:border-red-800 flex items-center gap-2 text-right",children:[e.jsx(n,{className:"h-4 w-4"}),s.source]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(d,{htmlFor:"details",className:"text-base font-medium flex items-center gap-2 text-indigo-700 dark:text-indigo-400 text-right",dir:"rtl",children:[e.jsx("span",{className:"text-red-500",children:"*"}),t("incident_reports.details.details_label"),e.jsx(k,{className:"h-4 w-4"})]}),e.jsx(f,{id:"details",rows:5,value:l.details,onChange:r=>o("details",r.target.value),placeholder:t("incident_reports.details.details_placeholder"),required:!0,className:"min-h-[120px] resize-none border-indigo-200 dark:border-indigo-700 focus:border-indigo-500 dark:focus:border-indigo-400 focus:ring-indigo-500/20 dark:focus:ring-indigo-400/20 bg-gradient-to-l from-indigo-50 dark:from-indigo-900/30 to-white dark:to-gray-800 text-right"}),s.details&&e.jsxs("p",{className:"text-sm text-red-500 dark:text-red-400 font-medium bg-red-50 dark:bg-red-900/20 p-2 rounded-lg border border-red-200 dark:border-red-800 flex items-center gap-2 text-right",children:[e.jsx(n,{className:"h-4 w-4"}),s.details]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(d,{htmlFor:"action_taken",className:"text-base font-medium flex items-center gap-2 text-indigo-700 dark:text-indigo-400 text-right",dir:"rtl",children:[t("incident_reports.details.action_taken_label"),e.jsx(te,{className:"h-4 w-4"})]}),e.jsx(f,{id:"action_taken",rows:3,value:l.action_taken,onChange:r=>o("action_taken",r.target.value),placeholder:t("incident_reports.details.action_taken_placeholder"),className:"min-h-[80px] resize-none border-indigo-200 dark:border-indigo-700 focus:border-indigo-500 dark:focus:border-indigo-400 focus:ring-indigo-500/20 dark:focus:ring-indigo-400/20 bg-gradient-to-l from-indigo-50 dark:from-indigo-900/30 to-white dark:to-gray-800 text-right"}),s.action_taken&&e.jsxs("p",{className:"text-sm text-red-500 dark:text-red-400 font-medium bg-red-50 dark:bg-red-900/20 p-2 rounded-lg border border-red-200 dark:border-red-800 flex items-center gap-2 text-right",children:[e.jsx(n,{className:"h-4 w-4"}),s.action_taken]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(d,{htmlFor:"recommendation",className:"text-base font-medium flex items-center gap-2 text-indigo-700 dark:text-indigo-400 text-right",dir:"rtl",children:[t("incident_reports.details.recommendation_label"),e.jsx(ie,{className:"h-4 w-4"})]}),e.jsx(f,{id:"recommendation",rows:3,value:l.recommendation,onChange:r=>o("recommendation",r.target.value),placeholder:t("incident_reports.details.recommendation_placeholder"),className:"min-h-[80px] resize-none border-indigo-200 dark:border-indigo-700 focus:border-indigo-500 dark:focus:border-indigo-400 focus:ring-indigo-500/20 dark:focus:ring-indigo-400/20 bg-gradient-to-l from-indigo-50 dark:from-indigo-900/30 to-white dark:to-gray-800 text-right"}),s.recommendation&&e.jsxs("p",{className:"text-sm text-red-500 dark:text-red-400 font-medium bg-red-50 dark:bg-red-900/20 p-2 rounded-lg border border-red-200 dark:border-red-800 flex items-center gap-2 text-right",children:[e.jsx(n,{className:"h-4 w-4"}),s.recommendation]})]})]})]}),e.jsxs(v,{className:"border-none shadow-xl overflow-hidden bg-gradient-to-bl from-white dark:from-gray-800 to-indigo-50/30 dark:to-indigo-900/20",children:[e.jsxs(w,{className:"bg-gradient-to-l from-indigo-500 dark:from-indigo-600 to-indigo-600 dark:to-indigo-700 text-white border-b pb-4",children:[e.jsxs(y,{className:"flex items-center gap-3 text-lg",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(p,{className:"h-5 w-5"})}),t("incident_reports.form.access_title")]}),e.jsx(C,{className:"text-indigo-100",children:t("incident_reports.form.access_description")})]}),e.jsxs(S,{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(d,{className:"text-base font-medium flex items-center gap-2 text-indigo-700 dark:text-indigo-400 text-right",dir:"rtl",children:[e.jsx(A,{className:"h-4 w-4"}),t("incident_reports.form.search_users")]}),e.jsxs("div",{className:"relative",children:[e.jsx(h,{value:x,onChange:r=>E(r.target.value),placeholder:t("incident_reports.form.search_users_placeholder"),className:"h-12 border-indigo-200 dark:border-indigo-700 focus:border-indigo-500 dark:focus:border-indigo-400 focus:ring-indigo-500/20 dark:focus:ring-indigo-400/20 bg-gradient-to-l from-indigo-50 dark:from-indigo-900/30 to-white dark:to-gray-800 text-right"}),e.jsx(A,{className:"absolute left-3 top-1/2 h-5 w-5 -translate-y-1/2 text-indigo-400 pointer-events-none"})]})]}),x&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(d,{className:"text-base font-medium flex items-center gap-2 text-indigo-700 dark:text-indigo-400 text-right",dir:"rtl",children:t("incident_reports.form.select_users")}),e.jsxs("div",{className:"max-h-48 overflow-y-auto space-y-2 border border-indigo-200 dark:border-indigo-700 rounded-xl p-4 bg-white dark:bg-gray-800",children:[j.filter(r=>!c.includes(r.id)).map(r=>e.jsxs("div",{onClick:()=>K(r.id),className:"flex items-center justify-between p-3 bg-white dark:bg-gray-800 rounded-lg border border-indigo-200 dark:border-indigo-700 hover:bg-indigo-50 dark:hover:bg-indigo-900/30 cursor-pointer transition-all duration-200 hover:scale-105 hover:shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-indigo-100 to-indigo-200 dark:from-indigo-800 dark:to-indigo-900 rounded-lg",children:e.jsx(D,{className:"h-4 w-4 text-indigo-600 dark:text-indigo-300"})}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-medium text-indigo-900 dark:text-indigo-100",children:r.name}),e.jsx("p",{className:"text-sm text-indigo-600 dark:text-indigo-400",children:r.email})]})]}),e.jsx(se,{className:"h-4 w-4 text-indigo-500"})]},r.id)),j.filter(r=>!c.includes(r.id)).length===0&&e.jsx("p",{className:"text-center text-indigo-600 dark:text-indigo-400 py-4",children:t("incident_reports.form.no_users_found")})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(d,{className:"text-base font-medium flex items-center gap-2 text-indigo-700 dark:text-indigo-400 text-right",dir:"rtl",children:[e.jsx(p,{className:"h-4 w-4"}),t("incident_reports.form.selected_users")]}),c.length>0?e.jsx("div",{className:"space-y-2",children:c.map(r=>{const a=u.find(b=>b.id===r);return a?e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border transition-all duration-200 ${r===i.submitted_by?"bg-gradient-to-r from-green-100 to-green-200 dark:from-green-800 dark:to-green-900 border-green-200 dark:border-green-700":"bg-gradient-to-r from-indigo-50 to-indigo-100 dark:from-indigo-900/30 dark:to-indigo-800/30 border-indigo-200 dark:border-indigo-700"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${r===i.submitted_by?"bg-gradient-to-br from-green-200 to-green-300 dark:from-green-700 dark:to-green-800":"bg-gradient-to-br from-indigo-200 to-indigo-300 dark:from-indigo-700 dark:to-indigo-800"}`,children:e.jsx(D,{className:`h-4 w-4 ${r===i.submitted_by?"text-green-700 dark:text-green-200":"text-indigo-700 dark:text-indigo-200"}`})}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-medium text-indigo-900 dark:text-indigo-100",children:a.name}),r===i.submitted_by&&e.jsx(W,{variant:"outline",className:"bg-green-100 text-green-800 border-green-300 px-2 py-0.5 text-xs font-medium",children:t("incident_reports.form.submitter")})]}),e.jsx("p",{className:"text-sm text-indigo-600 dark:text-indigo-400",children:a.email})]})]}),r!==i.submitted_by&&e.jsx(X,{type:"button",variant:"outline",size:"sm",onClick:()=>M(r),className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:text-red-400 dark:hover:text-red-300 dark:hover:bg-red-900/20 border-red-200 dark:border-red-700",children:e.jsx(de,{className:"h-3 w-3"})})]},r):null})}):e.jsxs("div",{className:"text-center py-8 text-indigo-600 dark:text-indigo-400",children:[e.jsx(p,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:t("incident_reports.form.no_users_selected")})]})]}),e.jsx("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-700",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(n,{className:"h-4 w-4 text-blue-600 dark:text-blue-400 mt-0.5"}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200 font-medium mb-1",children:t("incident_reports.form.submitter_note")}),e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-300",children:t("incident_reports.form.permissions_note")})]})]})})]})]}),e.jsx(ee,{onCancel:O,onSubmit:J,processing:q,cancelText:t("common.cancel"),submitText:t("incident_reports.actions.save_changes"),savingText:t("incident_reports.actions.saving")})]})})]})]})}export{er as default};
