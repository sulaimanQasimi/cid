import{r as n,m as q,j as e,L as V,$ as X,S as C}from"./app-BopL26TM.js";import{A as G}from"./app-layout--I2Kt_pY.js";import{B as g}from"./button-matrxBKI.js";import{H as J}from"./header-B_-qfdfl.js";import{F as K}from"./FooterButtons-5N2QDj4R.js";import{C as M,a as Q,b as W,d as Y}from"./card-CYuLHR9t.js";import{I as b}from"./input-D80qvZjX.js";import{L as p}from"./label-B_iD3e1a.js";import{T as Z}from"./textarea-C7sNhjZe.js";import{u as I}from"./translate-BZE6jYxu.js";import{u as ee}from"./use-permissions-DCrkrcfm.js";import{a as se}from"./permission-guard-m-vHy1Fm.js";import{B as te}from"./badge-BxHNs6jt.js";import{T as ae,a as re,b as S,c as U}from"./tabs-DXT7brve.js";import{D as ie,a as oe,b as de,c as le,d as ne,e as ce}from"./dialog-hT07wBoh.js";import{A as me}from"./arrow-left-wQq4tNNY.js";import{P as xe}from"./pencil-Bs9wiX1H.js";import{S as ge}from"./save-C0PUGPSV.js";import{F as h}from"./file-text-ZJvyblBh.js";import{U as y}from"./users-BU_sYuHA.js";import{X as j}from"./x-CJYd5HcU.js";import{S as D}from"./search-BjBzGmbG.js";import{U as T}from"./user-Dny8f-ZL.js";import{A as pe}from"./arrow-right-C-G4-x70.js";import{T as he}from"./trash-A4ZaTNmk.js";import{T as ue}from"./triangle-alert-BK7iKOoT.js";import"./utils-wsVXBLEL.js";import"./index-BjApXoFi.js";import"./createLucideIcon-BlzI5Ksv.js";import"./tslib.es6-CmEaCU22.js";import"./index-8i3i7oQs.js";import"./index-DXY21xBX.js";import"./index-DY6IMHr_.js";import"./index-CFyRJ2kw.js";import"./avatar-D72QyUTV.js";import"./tag-38Fx9er5.js";import"./qr-code-y9ZrO6wC.js";import"./chart-column-DYX_kSNK.js";import"./map-pin-C3L9--3p.js";import"./database-BUAdBVzA.js";import"./shield-pjmPvG1u.js";import"./plus-BY42YQnq.js";function os({infoType:a,users:u}){var k,w;const{t}=I();ee();const[i,N]=n.useState(((k=a.accesses)==null?void 0:k.map(s=>s.user_id))||[]),[c,L]=n.useState(""),[B,m]=n.useState(!1),[d,v]=n.useState(null),[F,A]=n.useState([]),{data:x,setData:f,post:fe,processing:R,errors:l}=q({_method:"PUT",name:a.name,code:a.code||"",description:a.description||"",access_users:((w=a.accesses)==null?void 0:w.map(s=>s.user_id))||[],deleted_users:[]}),$=[{title:t("info.page_title"),href:route("info-types.index")},{title:t("info_types.page_title"),href:route("info-types.index")},{title:t("info_types.edit.page_title",{name:a.name}),href:"#"}],z=s=>{i.includes(s)||N(r=>[...r,s])},H=s=>{const r=u.find(o=>o.id===s);r&&(v({id:s,name:r.name}),m(!0))},P=()=>{if(d){const s=i.filter(r=>r!==d.id);N(s),A(r=>[...r,d.id]),m(!1),v(null)}},_=u.filter(s=>s.name.toLowerCase().includes(c.toLowerCase())||s.email.toLowerCase().includes(c.toLowerCase())),E=s=>{s.preventDefault();const r={...x,access_users:i.map(o=>parseInt(o.toString())),deleted_users:F.map(o=>parseInt(o.toString()))};C.post(route("info-types.update",a.id),r,{onSuccess:()=>{}})},O=()=>{C.visit(route("info-types.index"))};return e.jsxs(G,{breadcrumbs:$,children:[e.jsx(V,{title:t("info_types.edit.page_title",{name:a.name})}),e.jsxs("div",{className:"container px-0 py-6",children:[e.jsx(J,{title:t("info_types.edit.page_title",{name:a.name}),description:t("info_types.edit.page_description"),icon:e.jsx(xe,{className:"h-6 w-6 text-white"}),model:"info_type",routeName:()=>route("info-types.index"),buttonText:t("info_types.edit.back_button"),theme:"purple",buttonSize:"lg",showBackButton:!0,backRouteName:()=>route("info-types.index"),backButtonText:t("info_types.edit.back_button"),showButton:!1,actionButtons:e.jsx(e.Fragment,{children:e.jsx(g,{asChild:!0,variant:"outline",size:"lg",className:"bg-white/20 backdrop-blur-md border-white/30 text-white hover:bg-white/30 shadow-2xl rounded-2xl px-6 py-3 text-lg font-semibold transition-all duration-300 hover:scale-105",children:e.jsxs(X,{href:route("info-types.index"),className:"flex items-center gap-3",children:[t("info_types.edit.back_button"),e.jsx(me,{className:"h-5 w-5"})]})})})}),e.jsx(se,{model:"info_type",children:e.jsxs(M,{className:"shadow-2xl bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700  overflow-hidden",children:[e.jsx(Q,{className:"bg-gradient-to-l from-purple-500 to-purple-600 text-white py-6",children:e.jsxs(W,{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-white/20 rounded-2xl backdrop-blur-sm shadow-lg",children:e.jsx(ge,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:t("info_types.edit.form_title")}),e.jsx("div",{className:"text-purple-100 text-sm font-medium",children:t("info_types.edit.form_description")})]})]})}),e.jsxs("form",{onSubmit:E,children:[e.jsx(Y,{className:"p-8",children:e.jsxs(ae,{defaultValue:"basic",className:"w-full",dir:"rtl",children:[e.jsxs(re,{className:"grid w-full grid-cols-2 mb-8 bg-gray-100 dark:bg-gray-700 rounded-xl p-1",dir:"rtl",children:[e.jsxs(S,{value:"basic",className:"flex flex-row-reverse items-center gap-2 data-[state=active]:bg-white dark:data-[state=active]:bg-gray-800 data-[state=active]:text-purple-600 dark:data-[state=active]:text-gray-400 data-[state=active]:shadow-lg rounded-lg font-medium transition-all duration-300",children:[e.jsx(h,{className:"h-4 w-4"}),t("info_types.create.basic_info")]}),e.jsxs(S,{value:"access",className:"flex flex-row-reverse items-center gap-2 data-[state=active]:bg-white dark:data-[state=active]:bg-gray-800 data-[state=active]:text-purple-600 dark:data-[state=active]:text-gray-400 data-[state=active]:shadow-lg rounded-lg font-medium transition-all duration-300",children:[e.jsx(y,{className:"h-4 w-4"}),t("info_type.access.tab")]})]}),e.jsxs(U,{value:"basic",className:"space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs(p,{htmlFor:"code",className:"text-lg font-semibold text-gray-800 dark:text-gray-200 flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4"}),t("info_types.edit.code_label")]}),e.jsxs("div",{className:"relative",children:[e.jsx(b,{id:"code",value:x.code,onChange:s=>f("code",s.target.value),className:"h-12 text-lg border-gray-200 dark:border-gray-700 focus:border-purple-500 focus:ring-purple-500/20 bg-white dark:bg-gray-800 rounded-xl shadow-lg",placeholder:t("info_types.edit.code_placeholder")}),l.code&&e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-red-600",children:[e.jsx(j,{className:"h-4 w-4"}),e.jsx("p",{className:"text-sm font-medium",children:l.code})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(p,{htmlFor:"name",className:"text-lg font-semibold text-gray-800 dark:text-gray-200 flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4"}),t("info_types.edit.name_label")," *"]}),e.jsxs("div",{className:"relative",children:[e.jsx(b,{id:"name",value:x.name,onChange:s=>f("name",s.target.value),required:!0,className:"h-12 text-lg border-gray-200 dark:border-gray-700 focus:border-purple-500 focus:ring-purple-500/20 bg-white dark:bg-gray-800 rounded-xl shadow-lg",placeholder:t("info_types.edit.name_placeholder")}),l.name&&e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-red-600",children:[e.jsx(j,{className:"h-4 w-4"}),e.jsx("p",{className:"text-sm font-medium",children:l.name})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(p,{htmlFor:"description",className:"text-lg font-semibold text-gray-800 dark:text-gray-200 flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4"}),t("info_types.edit.description_label")]}),e.jsxs("div",{className:"relative",children:[e.jsx(Z,{id:"description",value:x.description,onChange:s=>f("description",s.target.value),rows:4,className:"text-lg border-gray-200 dark:border-gray-700 focus:border-purple-500 focus:ring-purple-500/20 bg-white dark:bg-gray-800 rounded-xl shadow-lg resize-none",placeholder:t("info_types.edit.description_placeholder")}),l.description&&e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-red-600",children:[e.jsx(j,{className:"h-4 w-4"}),e.jsx("p",{className:"text-sm font-medium",children:l.description})]})]})]})]}),e.jsxs(U,{value:"access",className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200 mb-2",children:t("info_type.access.title")}),e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:t("info_type.access.description")})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(p,{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4"}),t("info_type.access.search_users")]}),e.jsxs("div",{className:"relative",children:[e.jsx(b,{value:c,onChange:s=>L(s.target.value),placeholder:t("info_type.access.search_users"),className:"h-12 text-lg border-gray-200 dark:border-gray-700 focus:border-purple-500 focus:ring-purple-500/20 bg-white dark:bg-gray-800 rounded-xl shadow-lg"}),e.jsx(D,{className:"absolute right-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"})]})]}),c&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-800 dark:text-gray-200",children:t("info_type.access.select_users")}),e.jsxs("div",{className:"max-h-48 overflow-y-auto space-y-2 border border-gray-200 dark:border-gray-700 rounded-xl p-4 bg-white dark:bg-gray-800",children:[_.filter(s=>!i.includes(s.id)).map(s=>e.jsxs("div",{onClick:()=>z(s.id),className:"flex items-center justify-between p-3 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer transition-all duration-200 hover:scale-105 hover:shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 rounded-lg",children:e.jsx(T,{className:"h-4 w-4 text-gray-600 dark:text-gray-300"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.email})]})]}),e.jsx(pe,{className:"h-4 w-4 text-gray-500"})]},s.id)),_.filter(s=>!i.includes(s.id)).length===0&&e.jsx("p",{className:"text-center text-gray-600 dark:text-gray-400 py-4",children:t("info_type.access.no_users_found")})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-md font-semibold text-gray-800 dark:text-gray-200 flex items-center gap-2",children:[e.jsx(y,{className:"h-4 w-4"}),t("info_type.access.selected_users")]}),i.length>0?e.jsx("div",{className:"space-y-2",children:i.map(s=>{const r=u.find(o=>o.id===s);return r?e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border transition-all duration-200 ${s===a.created_by?"bg-gradient-to-r from-green-100 to-green-200 dark:from-green-800 dark:to-green-900 border-green-200 dark:border-green-700":"bg-gradient-to-r from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 border-purple-200 dark:border-purple-700"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${s===a.created_by?"bg-gradient-to-br from-green-200 to-green-300 dark:from-green-700 dark:to-green-800":"bg-gradient-to-br from-gray-200 to-gray-300 dark:from-gray-600 dark:to-gray-700"}`,children:e.jsx(T,{className:`h-4 w-4 ${s===a.created_by?"text-green-700 dark:text-green-200":"text-gray-700 dark:text-gray-200"}`})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:r.name}),s===a.created_by&&e.jsx(te,{variant:"outline",className:"bg-green-100 text-green-800 border-green-300 px-2 py-0.5 text-xs font-medium",children:t("info_type.access.creator")})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:r.email})]})]}),s!==a.created_by&&e.jsx(g,{type:"button",variant:"outline",size:"sm",onClick:()=>H(s),className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:text-red-400 dark:hover:text-red-300 dark:hover:bg-red-900/20 border-red-200 dark:border-red-700",children:e.jsx(he,{className:"h-3 w-3"})})]},s):null})}):e.jsxs("div",{className:"text-center py-8 text-gray-600 dark:text-gray-400",children:[e.jsx(y,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:t("info_type.access.no_users_selected")})]})]}),e.jsx("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-700",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ue,{className:"h-4 w-4 text-blue-600 dark:text-blue-400 mt-0.5"}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200 font-medium mb-1",children:t("info_type.access.creator_note")}),e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-300",children:t("info_type.access.permissions_note")})]})]})})]})]})}),e.jsx("div",{className:"px-8 py-6 bg-gray-50 dark:bg-gray-800",children:e.jsx(K,{onCancel:O,onSubmit:()=>{},processing:R,cancelText:t("info_types.edit.cancel_button"),submitText:t("info_types.edit.save_button"),savingText:t("info_types.edit.saving_button")})})]})]})})]}),e.jsx(ie,{open:B,onOpenChange:m,children:e.jsxs(oe,{className:"max-w-md",children:[e.jsxs(de,{children:[e.jsx(le,{className:"text-xl",children:t("info_type.access.remove_user_confirm_title")}),e.jsx(ne,{className:"mt-2",children:t("info_type.access.remove_user_confirm_message",{name:(d==null?void 0:d.name)||""})})]}),e.jsxs(ce,{className:"mt-6",children:[e.jsx(g,{variant:"outline",onClick:()=>m(!1),className:"shadow-sm",children:t("common.cancel")}),e.jsx(g,{onClick:P,className:"bg-red-600 hover:bg-red-700 text-white shadow-sm",children:t("info_type.access.remove_user_confirm_button")})]})]})})]})}export{os as default};
