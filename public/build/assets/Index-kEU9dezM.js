import{r as n,S as L,j as e,L as B,$ as h}from"./app-D9EKp-j0.js";import{B as v}from"./button-C_lbOJaF.js";import{B as k}from"./badge-B-jdtJ8-.js";import{C as E,a as R,b as V,c as $,d as U}from"./card-CJ646PJT.js";import{P as z}from"./pagination-Da64L6-o.js";import{P as H}from"./page-header-i4y0N3hM.js";import{A as Z,b as M}from"./app-layout-DLN7lXRp.js";import{I as O}from"./input-CDqmtBAl.js";import{S as N,a as b,b as S,c as C,d as r}from"./select-Cs4X5igs.js";import{L as w}from"./label-DFSxdoGP.js";import{u as X}from"./use-debounce-BkxwL1gI.js";import{P as q}from"./plus-D1a3V2tS.js";import{S as G}from"./search-DNu1PUwu.js";import{X as J}from"./x-CUky7n0R.js";import{f as K}from"./index-CaunA62S.js";import{F as Q}from"./file-text-J_QMBZXb.js";import{A as P}from"./arrow-up-down-CzKbdf60.js";import"./pagination-BwZDIDi3.js";import"./chevron-left-Dfb8VvDg.js";import"./createLucideIcon-2sT-PLZR.js";import"./index-CEWyTXIf.js";import"./index--GEwVf8d.js";import"./index-BYrHusN6.js";import"./index-BdHtEbnZ.js";import"./index-DQJiO2ZR.js";import"./avatar-DJGRXLRL.js";import"./app-logo-zrypSq5u.js";import"./app-logo-icon-BTqQbP9x.js";import"./tag-B3sBBI3s.js";import"./qr-code-Bvz4OGpj.js";import"./index-BrNC6hno.js";import"./check-C5q72oI5.js";const W=[{title:"Dashboard",href:"/dashboard"},{title:"Incidents",href:route("incidents.index")}];function Pe({incidents:x,filters:t={},categories:F}){const[u,y]=n.useState(t.search||""),[i,_]=n.useState(t.status||""),[d,A]=n.useState(t.category_id||""),[l,p]=n.useState(t.sort_field||"incident_date"),[a,m]=n.useState(t.sort_direction||"desc"),j=X(u,500);n.useEffect(()=>{try{if(j!==t.search||i!==t.status||d!==t.category_id||l!==t.sort_field||a!==t.sort_direction){const s={search:j,status:i==="all"?"":i,category_id:d==="all"?"":d,sort_field:l,sort_direction:a},o=route("incidents.index"),c={preserveState:!0,replace:!0};setTimeout(()=>{L.get(o,s,c)},0)}}catch(s){console.error("Error applying filters:",s)}},[j,i,d,l,a,t]);const f=s=>{l===s?m(a==="asc"?"desc":"asc"):(p(s),m("asc"))},g=s=>l!==s?null:a==="asc"?e.jsx(P,{className:"ml-1 h-4 w-4 inline"}):e.jsx(P,{className:"ml-1 h-4 w-4 inline rotate-180"}),T=()=>{y(""),_("all"),A("all"),p("incident_date"),m("desc")};return e.jsxs(Z,{breadcrumbs:W,children:[e.jsx(B,{title:"Incidents"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 rounded-xl p-4",children:[e.jsx(H,{title:"Incidents",description:"Manage and track all security incidents",actions:e.jsx(v,{asChild:!0,children:e.jsxs(h,{href:route("incidents.create"),children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"New Incident"]})})}),e.jsxs(E,{children:[e.jsx(R,{children:e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx(V,{children:"All Incidents"}),e.jsx($,{children:"A list of all incidents in the system."})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"relative w-full md:w-auto",children:[e.jsx(G,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(O,{placeholder:"Search incidents...",className:"pl-8 pr-4",value:u,onChange:s=>y(s.target.value)})]}),(u||i||d||l!=="incident_date"||a!=="desc")&&e.jsxs(v,{variant:"ghost",size:"sm",onClick:T,children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Clear"]})]})]})}),e.jsxs(U,{children:[e.jsxs("div",{className:"mb-4 grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx(w,{htmlFor:"status-filter",children:"Status"}),e.jsxs(N,{value:i,onValueChange:_,children:[e.jsx(b,{id:"status-filter",children:e.jsx(S,{placeholder:"All Statuses"})}),e.jsxs(C,{children:[e.jsx(r,{value:"all",children:"All Statuses"}),e.jsx(r,{value:"reported",children:"Reported"}),e.jsx(r,{value:"investigating",children:"Investigating"}),e.jsx(r,{value:"resolved",children:"Resolved"}),e.jsx(r,{value:"closed",children:"Closed"})]})]})]}),e.jsxs("div",{children:[e.jsx(w,{htmlFor:"category-filter",children:"Category"}),e.jsxs(N,{value:d,onValueChange:A,children:[e.jsx(b,{id:"category-filter",children:e.jsx(S,{placeholder:"All Categories"})}),e.jsxs(C,{children:[e.jsx(r,{value:"all",children:"All Categories"}),F.map(s=>e.jsx(r,{value:s.id.toString(),children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-2 h-3 w-3 rounded-full",style:{backgroundColor:s.color}}),s.name]})},s.id))]})]})]}),e.jsxs("div",{children:[e.jsx(w,{htmlFor:"sort-by",children:"Sort By"}),e.jsxs(N,{value:`${l}:${a}`,onValueChange:s=>{const[o,c]=s.split(":");p(o),m(c)},children:[e.jsx(b,{id:"sort-by",children:e.jsx(S,{placeholder:"Sort by"})}),e.jsxs(C,{children:[e.jsx(r,{value:"incident_date:desc",children:"Date (Newest first)"}),e.jsx(r,{value:"incident_date:asc",children:"Date (Oldest first)"}),e.jsx(r,{value:"title:asc",children:"Title (A-Z)"}),e.jsx(r,{value:"title:desc",children:"Title (Z-A)"})]})]})]})]}),e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsxs("table",{className:"w-full caption-bottom text-sm",children:[e.jsx("thead",{className:"[&_tr]:border-b",children:e.jsxs("tr",{className:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",children:[e.jsxs("th",{className:"h-12 px-4 text-left align-middle font-medium cursor-pointer",onClick:()=>f("title"),children:["Title ",g("title")]}),e.jsxs("th",{className:"h-12 px-4 text-left align-middle font-medium cursor-pointer",onClick:()=>f("incident_date"),children:["Date ",g("incident_date")]}),e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium",children:"Location"}),e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium",children:"Category"}),e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium",children:"Report"}),e.jsxs("th",{className:"h-12 px-4 text-left align-middle font-medium cursor-pointer",onClick:()=>f("status"),children:["Status ",g("status")]}),e.jsx("th",{className:"h-12 px-4 text-left align-middle font-medium",children:"Actions"})]})}),e.jsx("tbody",{className:"[&_tr:last-child]:border-0",children:x.data.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"h-12 px-4 text-center align-middle",children:"No incidents found"})}):x.data.map(s=>{var o,c,I,D;return e.jsxs("tr",{className:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",children:[e.jsx("td",{className:"p-4 align-middle",children:e.jsx(h,{href:route("incidents.show",s.id),className:"font-medium text-primary hover:underline",children:s.title})}),e.jsx("td",{className:"p-4 align-middle",children:K(new Date(s.incident_date),"PPP")}),e.jsxs("td",{className:"p-4 align-middle",children:[(o=s.district)==null?void 0:o.name,", ",(c=s.district_province)==null?void 0:c.name]}),e.jsx("td",{className:"p-4 align-middle",children:e.jsx(k,{style:{backgroundColor:((I=s.category)==null?void 0:I.color)||"#888888"},children:((D=s.category)==null?void 0:D.name)||"Unspecified"})}),e.jsx("td",{className:"p-4 align-middle",children:s.report?e.jsxs(h,{href:route("incident-reports.show",s.report.id),className:"flex items-center text-sm text-muted-foreground hover:underline",children:[e.jsx(Q,{className:"mr-1 h-4 w-4"}),s.report.report_number]}):e.jsx("span",{className:"text-muted-foreground text-sm",children:"None"})}),e.jsx("td",{className:"p-4 align-middle",children:e.jsx(k,{variant:s.status==="resolved"||s.status==="investigating"?"default":s.status==="closed"?"outline":"default",children:s.status})}),e.jsx("td",{className:"p-4 align-middle",children:e.jsx("div",{className:"flex space-x-2",children:e.jsx(v,{variant:"ghost",size:"sm",asChild:!0,children:e.jsxs(h,{href:route("incidents.show",s.id),children:[e.jsx(M,{className:"h-4 w-4 mr-1"}),"Details"]})})})})]},s.id)})})]})}),e.jsx("div",{className:"mt-6",children:e.jsx(z,{links:x.links})})]})]})]})]})}export{Pe as default};
