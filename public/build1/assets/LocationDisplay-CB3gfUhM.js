import{r as o,j as l}from"./app-D9EKp-j0.js";import N from"./afghanistanLow-mnRKi4Rp.js";import{A as j}from"./AnimatedTheme-j3JkNzt2.js";import{R as k,C as w,B as R}from"./Circle-CcJrEfx2.js";import{M as T,g as S,a as y,b}from"./MapPolygonSeries-DBlGFkpE.js";import{R as E,c}from"./SerialChart-Dl3d9NGp.js";import"./Theme-CRx2HxaY.js";import"./index-CEWyTXIf.js";import"./createLucideIcon-2sT-PLZR.js";import"./index--GEwVf8d.js";import"./index-BYrHusN6.js";import"./index-BdHtEbnZ.js";import"./button-C_lbOJaF.js";const v={Badakhshan:{lat:36.7347,lng:70.8119},Badghis:{lat:35.1671,lng:63.7695},Baghlan:{lat:35.9462,lng:68.71},Balkh:{lat:36.7581,lng:67.1015},Bamyan:{lat:34.81,lng:67.8218},Daykundi:{lat:33.737,lng:66.0461},Farah:{lat:32.3747,lng:62.1413},Faryab:{lat:36.0799,lng:64.9036},Ghazni:{lat:33.5453,lng:68.4215},Ghor:{lat:34.0998,lng:65.2478},Helmand:{lat:31.5797,lng:64.37},Herat:{lat:34.353,lng:62.209},Jowzjan:{lat:36.8969,lng:65.9042},Kabul:{lat:34.5553,lng:69.2075},Kandahar:{lat:31.6133,lng:65.71},Kapisa:{lat:34.9809,lng:69.621},Khost:{lat:33.3395,lng:69.9348},Kunar:{lat:34.8461,lng:71.0973},Kunduz:{lat:36.729,lng:68.8685},Laghman:{lat:34.6898,lng:70.1456},Logar:{lat:34.0144,lng:69.1933},Nangarhar:{lat:34.1718,lng:70.6217},Nimruz:{lat:31.0255,lng:62.4553},Nuristan:{lat:35.3252,lng:70.9072},Paktia:{lat:33.7062,lng:69.3851},Paktika:{lat:32.2648,lng:68.5249},Panjshir:{lat:35.3125,lng:69.9372},Parwan:{lat:35.0095,lng:69.1424},Samangan:{lat:36.312,lng:67.9649},"Sar-e Pol":{lat:36.2151,lng:65.9328},Takhar:{lat:36.6701,lng:69.4787},Uruzgan:{lat:32.9275,lng:66.0345},Wardak:{lat:34.38,lng:68.2512},Zabul:{lat:32.273,lng:67.259}};function H({location:e}){const r=o.useRef(null),u=o.useRef(null),[g,P]=o.useState(!1),[m,f]=o.useState(e.province||null);return o.useEffect(()=>{if(e&&!e.province){for(const[s,t]of Object.entries(v))if(Math.abs(t.lat-e.lat)<.01&&Math.abs(t.lng-e.lng)<.01){f(s);return}f(null)}},[e]),o.useEffect(()=>{if(r.current||!u.current)return;const s=setTimeout(()=>{try{const t=k.new(u.current);t.setThemes([j.new(t)]);const a=t.container.children.push(T.new(t,{panX:"rotateX",panY:"rotateY",projection:S(),paddingBottom:20,paddingTop:20,paddingLeft:20,paddingRight:20,maxZoomLevel:64}));a.set("background",E.new(t,{fill:c(16706539),fillOpacity:1}));const n=a.series.push(y.new(t,{geoJSON:N}));n.mapPolygons.template.setAll({tooltipText:"{name}",interactive:!0,fill:c(15037299),stroke:c(16777215),strokeWidth:1}),n.mapPolygons.template.states.create("selected",{fill:c(13840175)});const d=a.series.push(b.new(t,{}));if(e&&(d.data.push({geometry:{type:"Point",coordinates:[e.lng,e.lat]}}),e)){for(const[i,h]of Object.entries(v))if(Math.abs(h.lat-e.lat)<.01&&Math.abs(h.lng-e.lng)<.01){n.mapPolygons.each(function(x){const p=x.dataItem;p&&p.dataContext&&p.dataContext.name===i&&x.states.applyAnimate("selected")});break}}d.bullets.push(function(){const i=w.new(t,{radius:7,tooltipText:"Location",fill:c(12000284),stroke:c(16777215),strokeWidth:2});return R.new(t,{sprite:i})}),e?a.zoomToGeoPoint({longitude:e.lng,latitude:e.lat},4):a.zoomToGeoPoint({longitude:67.709953,latitude:33.93911},3),r.current=t,P(!0),t.container.children.each(i=>{i.states&&(i.states.create("default",{}),i.states.apply("default"))}),setTimeout(()=>{t.resize()},200)}catch(t){console.error("Error initializing map:",t)}},100);return()=>{clearTimeout(s),r.current&&(r.current.dispose(),r.current=null)}},[]),o.useEffect(()=>{if(r.current&&g&&e){const s=r.current.container.children.getIndex(0),t=s.series.values.find(a=>a instanceof b);if(t){t.data.setAll([{geometry:{type:"Point",coordinates:[e.lng,e.lat]}}]),s.zoomToGeoPoint({longitude:e.lng,latitude:e.lat},4);const a=s.series.values.find(n=>n instanceof y);a&&(a.mapPolygons.each(function(n){n.states.applyAnimate("default")}),m&&a.mapPolygons.each(function(n){const d=n.dataItem;d&&d.dataContext&&d.dataContext.name===m&&n.states.applyAnimate("selected")}))}}},[e,g,m]),l.jsxs("div",{className:"w-full",children:[l.jsxs("div",{className:"rounded-md overflow-hidden border border-gray-300 h-[400px]",style:{background:"#FEEBEB"},children:[!g&&l.jsx("div",{className:"flex items-center justify-center h-full w-full",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-red-600 mb-2"}),l.jsx("p",{className:"text-gray-700",children:"Loading map of Afghanistan..."})]})}),l.jsx("div",{ref:u,className:"h-full w-full",style:{height:"100%",width:"100%",display:"block"}})]}),l.jsx("div",{className:"mt-2 text-sm font-mono text-center",children:e?l.jsxs("span",{children:[m?`${m} Province: `:"","Latitude: ",e.lat.toFixed(6),", Longitude: ",e.lng.toFixed(6)]}):"No location data"})]})}export{H as default};
